(window.webpackJsonp=window.webpackJsonp||[]).push([[22],{u8xq:function(t,e,i){"use strict";i.r(e);var n=i("D57K"),o=i("5/c3"),s=i("LR82"),r=i("z5yO"),a=i("KLQV"),c=i("o9tz"),l=i("Y2qJ"),p=i("1C3z"),d=i("OeRG"),u=i("Qc/f"),h=i("r4gC"),f=function(){function t(){}return t.prototype.agInit=function(t){this.icon=t.value?"star":"star_border"},t.prototype.refresh=function(t){return!0},t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=p.Kb({type:t,selectors:[["app-content-type-fields-title"]],decls:4,vars:1,consts:[[1,"actions-component"],["matRipple","","matTooltip","Use as title field",1,"like-button","highlight"]],template:function(t,e){1&t&&(p.Wb(0,"div",0),p.Wb(1,"div",1),p.Wb(2,"mat-icon"),p.Pc(3),p.Vb(),p.Vb(),p.Vb()),2&t&&(p.Bb(3),p.Qc(e.icon))},directives:[d.q,u.a,h.a],styles:[""]}),t}(),b=function(){function t(){}return t.prototype.agInit=function(t){this.value=t.value},t.prototype.refresh=function(t){return!0},t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=p.Kb({type:t,selectors:[["app-content-type-fields-input-type"]],decls:6,vars:1,consts:[["matRipple","",1,"input-component","highlight"],[1,"text"],[1,"like-button"]],template:function(t,e){1&t&&(p.Wb(0,"div",0),p.Wb(1,"div",1),p.Pc(2),p.Vb(),p.Wb(3,"div",2),p.Wb(4,"mat-icon"),p.Pc(5,"arrow_drop_down"),p.Vb(),p.Vb(),p.Vb()),2&t&&(p.Bb(2),p.Qc(e.value))},directives:[d.q,h.a],styles:[""]}),t}(),m=i("nsG0"),g=i("DGvA"),y=i("8AiQ");function v(t,e){if(1&t){var i=p.Xb();p.Wb(0,"div",5),p.ec("click",(function(){return p.Dc(i),p.ic().delete()})),p.Wb(1,"mat-icon"),p.Pc(2,"delete"),p.Vb(),p.Vb()}}function T(t,e){1&t&&(p.Wb(0,"div",6),p.Wb(1,"mat-icon"),p.Pc(2,"delete"),p.Vb(),p.Vb())}function w(t,e){if(1&t){var i=p.Xb();p.Wb(0,"div",7),p.ec("click",(function(){return p.Dc(i),p.ic().openPermissions()})),p.Wb(1,"mat-icon"),p.Pc(2,"person"),p.Vb(),p.Vb()}}var C=function(){function t(){}return t.prototype.agInit=function(t){this.params=t,this.field=t.data,this.showPermissions=this.field.InputType===m.a.StringWysiwyg||this.field.Type===g.a.Hyperlink},t.prototype.refresh=function(t){return!0},t.prototype.rename=function(){this.params.onRename(this.field)},t.prototype.delete=function(){this.params.onDelete(this.field)},t.prototype.openPermissions=function(){this.params.onOpenPermissions(this.field)},t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=p.Kb({type:t,selectors:[["app-content-type-fields-actions"]],decls:7,vars:3,consts:[[1,"actions-component"],["matRipple","","matTooltip","Rename",1,"like-button","highlight",3,"click"],["class","like-button highlight","matRipple","","matTooltip","Delete",3,"click",4,"ngIf"],["class","like-button disabled",4,"ngIf"],["class","like-button highlight","matRipple","","matTooltip","Permissions",3,"click",4,"ngIf"],["matRipple","","matTooltip","Delete",1,"like-button","highlight",3,"click"],[1,"like-button","disabled"],["matRipple","","matTooltip","Permissions",1,"like-button","highlight",3,"click"]],template:function(t,e){1&t&&(p.Wb(0,"div",0),p.Wb(1,"div",1),p.ec("click",(function(){return e.rename()})),p.Wb(2,"mat-icon"),p.Pc(3,"settings"),p.Vb(),p.Vb(),p.Nc(4,v,3,0,"div",2),p.Nc(5,T,3,0,"div",3),p.Nc(6,w,3,0,"div",4),p.Vb()),2&t&&(p.Bb(4),p.oc("ngIf",!e.field.IsTitle),p.Bb(1),p.oc("ngIf",e.field.IsTitle),p.Bb(1),p.oc("ngIf",e.showPermissions))},directives:[d.q,u.a,h.a,y.t],styles:[""]}),t}(),D=i("DOM6"),R=function(){function t(){}return t.prototype.agInit=function(t){this.value=t.value,this.icon=Object(D.a)(this.value)},t.prototype.refresh=function(t){return!0},t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=p.Kb({type:t,selectors:[["app-content-type-fields-type"]],decls:3,vars:2,consts:[[1,"icon-container",3,"matTooltip"]],template:function(t,e){1&t&&(p.Wb(0,"div",0),p.Wb(1,"mat-icon"),p.Pc(2),p.Vb(),p.Vb()),2&t&&(p.oc("matTooltip",e.value),p.Bb(2),p.Qc(e.icon))},directives:[u.a,h.a],styles:[""]}),t}(),S=i("QjRa"),k=i("BLjT"),I=i("S36y"),F=i("/Foi"),W=i("2pW/"),N=i("9HSk"),V=i("G6Ml");i.d(e,"ContentTypeFieldsComponent",(function(){return O}));var O=function(){function t(t,e,i,o,r,c,l){this.dialogRef=t,this.route=e,this.router=i,this.contentTypesService=o,this.contentTypesFieldsService=r,this.snackBar=c,this.changeDetectorRef=l,this.modules=a.a,this.gridOptions=Object(n.a)(Object(n.a)({},S.a),{getRowClass:function(t){return t.data.InputType===m.a.EmptyDefault?"group-row":""},frameworkComponents:{contentTypeFieldsTitleComponent:f,contentTypeFieldsTypeComponent:R,contentTypeFieldsInputTypeComponent:b,contentTypeFieldsActionsComponent:C},columnDefs:[{rowDrag:!0,width:18,cellClass:"no-select no-padding no-outline"},{headerName:"Title",field:"IsTitle",width:42,cellClass:"secondary-action no-padding no-outline",cellRenderer:"contentTypeFieldsTitleComponent",onCellClicked:this.setTitle.bind(this)},{headerName:"Name",field:"StaticName",flex:2,minWidth:250,cellClass:"primary-action highlight",sortable:!0,filter:"agTextColumnFilter",onCellClicked:this.editFieldMetadata.bind(this)},{headerName:"Type",field:"Type",width:70,headerClass:"dense",cellClass:"no-outline",sortable:!0,filter:"agTextColumnFilter",cellRenderer:"contentTypeFieldsTypeComponent"},{headerName:"Input",field:"InputType",width:160,cellClass:"secondary-action no-padding",sortable:!0,filter:"agTextColumnFilter",cellRenderer:"contentTypeFieldsInputTypeComponent",onCellClicked:this.changeInputType.bind(this),valueGetter:this.inputTypeValueGetter},{width:120,cellClass:"secondary-action no-padding",cellRenderer:"contentTypeFieldsActionsComponent",cellRendererParams:{onRename:this.rename.bind(this),onDelete:this.delete.bind(this),onOpenPermissions:this.openPermissions.bind(this)}},{headerName:"Label",field:"Metadata.All.Name",flex:2,minWidth:250,cellClass:"no-outline",sortable:!0,filter:"agTextColumnFilter"},{headerName:"Notes",field:"Metadata.All.Notes",flex:2,minWidth:250,cellClass:"no-outline",sortable:!0,filter:"agTextColumnFilter"}]}),this.sortApplied=!1,this.filterApplied=!1,this.rowDragSuppressed=!1,this.subscription=new s.a,this.hasChild=!!this.route.snapshot.firstChild,this.contentTypeStaticName=this.route.snapshot.paramMap.get("contentTypeStaticName")}return t.prototype.ngOnInit=function(){return Object(n.b)(this,void 0,void 0,(function(){var t;return Object(n.e)(this,(function(e){switch(e.label){case 0:return t=this,[4,this.contentTypesService.retrieveContentType(this.contentTypeStaticName).toPromise()];case 1:return t.contentType=e.sent(),[4,this.fetchFields()];case 2:return e.sent(),this.refreshOnChildClosed(),[2]}}))}))},t.prototype.ngOnDestroy=function(){this.subscription.unsubscribe(),this.subscription=null},t.prototype.onGridReady=function(t){this.gridApi=t.api},t.prototype.onRowDragEnter=function(t){this.gridApi.setEnableCellTextSelection(!1)},t.prototype.onRowDragEnd=function(t){var e=this;this.gridApi.setSuppressRowDrag(!0);var i=this.fields.map((function(t){return t.Id}));this.contentTypesFieldsService.reOrder(i,this.contentType).subscribe((function(t){return Object(n.b)(e,void 0,void 0,(function(){return Object(n.e)(this,(function(t){switch(t.label){case 0:return[4,this.fetchFields()];case 1:return t.sent(),this.changeDetectorRef.detectChanges(),this.gridApi.setEnableCellTextSelection(!0),this.gridApi.setSuppressRowDrag(!1),[2]}}))}))}))},t.prototype.onRowDragMove=function(t){var e=t.node,i=t.overNode;if(i&&e!==i){var n=i.data,o=this.fields.indexOf(e.data),s=this.fields.indexOf(n);this.moveInArray(this.fields,o,s),this.gridApi.setRowData(this.fields),this.gridApi.clearFocusedCell()}},t.prototype.moveInArray=function(t,e,i){var n=t[e];t.splice(e,1),t.splice(i,0,n)},t.prototype.onSortChanged=function(t){var e=this.gridApi.getSortModel();this.sortApplied=e.length>0,this.suppressRowDrag()},t.prototype.onFilterChanged=function(t){var e=this.gridApi.getFilterModel(),i=Object.keys(e);this.filterApplied=i.length>0,this.suppressRowDrag()},t.prototype.suppressRowDrag=function(){var t=this.sortApplied||this.filterApplied;t&&!this.rowDragSuppressed?(this.rowDragSuppressed=!0,this.gridApi.setSuppressRowDrag(!0)):!t&&this.rowDragSuppressed&&(this.rowDragSuppressed=!1,this.gridApi.setSuppressRowDrag(!1))},t.prototype.closeDialog=function(){this.dialogRef.close()},t.prototype.add=function(){this.router.navigate(["add/"+this.contentTypeStaticName],{relativeTo:this.route})},t.prototype.inputTypeValueGetter=function(t){var e=t.data;return e.InputType.substring(e.InputType.indexOf("-")+1)},t.prototype.fetchFields=function(){return Object(n.b)(this,void 0,void 0,(function(){var t;return Object(n.e)(this,(function(e){switch(e.label){case 0:return t=this,[4,this.contentTypesFieldsService.getFields(this.contentType).toPromise()];case 1:return t.fields=e.sent(),[2]}}))}))},t.prototype.editFieldMetadata=function(t){var e=t.data,i={items:[this.createItemDefinition(e,"All"),this.createItemDefinition(e,e.Type),this.createItemDefinition(e,e.InputType)]};this.router.navigate(["edit/"+JSON.stringify(i)],{relativeTo:this.route})},t.prototype.createItemDefinition=function(t,e){return void 0!==t.Metadata[e]?{EntityId:t.Metadata[e].Id}:{ContentTypeName:"@"+e,For:{Target:c.a.metadata.attribute.target,Number:t.Id},Prefill:{Name:t.StaticName}}},t.prototype.setTitle=function(t){var e=this,i=t.data;this.snackBar.open("Setting title..."),this.contentTypesFieldsService.setTitle(i,this.contentType).subscribe((function(){e.snackBar.open("Title set",null,{duration:2e3}),e.fetchFields()}))},t.prototype.changeInputType=function(t){this.router.navigate(["update/"+this.contentTypeStaticName+"/"+t.data.Id],{relativeTo:this.route})},t.prototype.rename=function(t){var e=this,i=prompt("What new name would you like for '"+t.StaticName+"' ("+t.Id+")?",t.StaticName);if(null!==i&&(i=i.trim().replace(/\s\s+/g," "))!==t.StaticName){for(;!i.match(l.b);){if(null===(i=prompt("What new name would you like for '"+t.StaticName+"' ("+t.Id+")?\n"+l.a,i)))return;if((i=i.trim().replace(/\s\s+/g," "))===t.StaticName)return}this.snackBar.open("Saving..."),this.contentTypesFieldsService.rename(t,this.contentType,i).subscribe((function(){e.snackBar.open("Saved",null,{duration:2e3}),e.fetchFields()}))}},t.prototype.delete=function(t){var e=this;confirm("Are you sure you want to delete '"+t.StaticName+"' ("+t.Id+")?")&&(this.snackBar.open("Deleting..."),this.contentTypesFieldsService.delete(t,this.contentType).subscribe((function(t){e.snackBar.open("Deleted",null,{duration:2e3}),e.fetchFields()})))},t.prototype.openPermissions=function(t){this.router.navigate(["permissions/"+c.a.metadata.attribute.type+"/"+c.a.keyTypes.number+"/"+t.Id],{relativeTo:this.route})},t.prototype.refreshOnChildClosed=function(){var t=this;this.subscription.add(this.router.events.pipe(Object(r.a)((function(t){return t instanceof o.b}))).subscribe((function(e){var i=t.hasChild;t.hasChild=!!t.route.snapshot.firstChild,!t.hasChild&&i&&t.fetchFields()})))},t.\u0275fac=function(e){return new(e||t)(p.Qb(k.h),p.Qb(o.a),p.Qb(o.c),p.Qb(I.a),p.Qb(F.a),p.Qb(W.b),p.Qb(p.h))},t.\u0275cmp=p.Kb({type:t,selectors:[["app-content-type-fields"]],decls:14,vars:4,consts:[[1,"nav-component-wrapper"],["mat-dialog-title",""],[1,"dialog-title-box"],["mat-icon-button","","matTooltip","Close dialog",3,"click"],[1,"grid-wrapper"],[1,"ag-theme-material",3,"rowData","modules","gridOptions","rowDragEnter","rowDragEnd","rowDragMove","gridReady","sortChanged","filterChanged"],["mat-fab","","mat-elevation-z24","","matTooltip","Add fields",1,"grid-fab",3,"click"]],template:function(t,e){1&t&&(p.Wb(0,"div",0),p.Wb(1,"div",1),p.Wb(2,"div",2),p.Wb(3,"div"),p.Pc(4),p.Vb(),p.Wb(5,"button",3),p.ec("click",(function(){return e.closeDialog()})),p.Wb(6,"mat-icon"),p.Pc(7,"close"),p.Vb(),p.Vb(),p.Vb(),p.Vb(),p.Rb(8,"router-outlet"),p.Wb(9,"div",4),p.Wb(10,"ag-grid-angular",5),p.ec("rowDragEnter",(function(t){return e.onRowDragEnter(t)}))("rowDragEnd",(function(t){return e.onRowDragEnd(t)}))("rowDragMove",(function(t){return e.onRowDragMove(t)}))("gridReady",(function(t){return e.onGridReady(t)}))("sortChanged",(function(t){return e.onSortChanged(t)}))("filterChanged",(function(t){return e.onFilterChanged(t)})),p.Vb(),p.Wb(11,"button",6),p.ec("click",(function(){return e.add()})),p.Wb(12,"mat-icon"),p.Pc(13,"add"),p.Vb(),p.Vb(),p.Vb(),p.Vb()),2&t&&(p.Bb(4),p.Rc("",null==e.contentType?null:e.contentType.Name," Fields"),p.Bb(6),p.oc("rowData",e.fields)("modules",e.modules)("gridOptions",e.gridOptions))},directives:[k.i,N.b,u.a,h.a,o.h,V.a],styles:[""]}),t}()}}]);
//# sourceMappingURL=https://sources.2sxc.org/11.03.00/ng-edit/content-type-fields-component.2d59c284b07744848866.js.map