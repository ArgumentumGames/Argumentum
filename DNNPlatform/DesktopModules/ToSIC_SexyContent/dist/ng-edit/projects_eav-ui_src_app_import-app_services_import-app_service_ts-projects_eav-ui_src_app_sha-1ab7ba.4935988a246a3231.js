"use strict";(self.webpackChunkeav_ui=self.webpackChunkeav_ui||[]).push([["projects_eav-ui_src_app_import-app_services_import-app_service_ts-projects_eav-ui_src_app_sha-1ab7ba"],{9322:(T,m,o)=>{o.d(m,{H:()=>i,a:()=>n});var l=o(2673),u=o(745),c=o(3889),f=o(5368),h=o(3184),e=o(8784),D=o(2425);const i="admin/app/";let n=(()=>{class a{constructor(r,g,C){this.http=r,this.context=g,this.dnnContext=C}importApp(r,g,C=!1){const E=new FormData;return E.append("File",r),E.append("Name",null!=g?g:""),this.http.post(this.dnnContext.$2sxc.http.apiUrl(i+"Import"),E,{params:{zoneId:this.context.zoneId.toString()}}).pipe((0,l.w)(x=>{var O;if(C&&(null===(O=x.Messages[0])||void 0===O?void 0:O.MessageType)===c.D.Warning){const M=prompt(x.Messages[0].Text+" Would you like to install it using another folder name?");if(M)return this.importApp(r,M,!0)}return(0,u.of)(x)}))}}return a.\u0275fac=function(r){return new(r||a)(h.LFG(e.eN),h.LFG(f._),h.LFG(D._y))},a.\u0275prov=h.Yz7({token:a,factory:a.\u0275fac}),a})()},6167:(T,m,o)=>{o.d(m,{r:()=>e});var l=o(4480),u=o(5368),c=o(3184),f=o(5758),h=o(2977);let e=(()=>{class D{constructor(n,a,d,r,g,C){var E;this.dialog=n,this.viewContainerRef=a,this.router=d,this.route=r,this.context=g,this.changeDetectorRef=C;const x=this.router.getCurrentNavigation();this.dialogData=(null===(E=null==x?void 0:x.extras)||void 0===E?void 0:E.state)||{}}ngOnInit(){const n=this.route.snapshot.data.dialog;if(null==n)throw new Error("Could not find config for dialog. Did you forget to add DialogConfig to route data?");(0,l.P)("Open dialog:",n.name,"Context id:",this.context.id,"Context:",this.context),n.getComponent().then(a=>{this.dialog._dialogAnimatingOpen&&this.dialog._lastDialogRef?this.dialog._lastDialogRef.afterOpened().subscribe(()=>{this.openDialogComponent(n,a)}):this.openDialogComponent(n,a)})}ngOnDestroy(){this.dialogRef.close()}openDialogComponent(n,a){n.initContext&&this.context.init(this.route),this.dialogRef=this.dialog.open(a,{autoFocus:!1,backdropClass:"dialog-backdrop",closeOnNavigation:!1,data:this.dialogData,panelClass:["dialog-panel",`dialog-panel-${n.panelSize}`,n.showScrollbar?"show-scrollbar":"no-scrollbar",...n.panelClass?n.panelClass:[]],position:{top:"0"},viewContainerRef:this.viewContainerRef}),this.dialogRef.afterClosed().subscribe(d=>{(0,l.P)("Dialog was closed:",n.name,"Data:",d);const r=d;if(null==(null==r?void 0:r.navigateUrl))if(this.route.pathFromRoot.length<=3)try{window.parent.$2sxc.totalPopup.close()}catch(g){}else this.router.navigate(["./"],this.route.snapshot.url.length>0?{relativeTo:this.route.parent,state:d}:{relativeTo:this.route.parent.parent,state:d});else this.router.navigate([r.navigateUrl])}),this.changeDetectorRef.markForCheck()}}return D.\u0275fac=function(n){return new(n||D)(c.Y36(f.uw),c.Y36(c.s_b),c.Y36(h.F0),c.Y36(h.gz),c.Y36(u._),c.Y36(c.sBO))},D.\u0275cmp=c.Xpm({type:D,selectors:[["app-dialog-entry"]],decls:0,vars:0,template:function(n,a){},styles:[""]}),D})()},9262:(T,m,o)=>{o.d(m,{U:()=>R});var l=o(5758),u=o(6317),c=o(9295),f=o(5904),h=o(2305),e=o(3184),D=o(2528),i=o(6362),n=o(5982),a=o(4742),d=o(7317),r=o(6190),g=o(1555);function C(s,p){1&s&&e._UZ(0,"mat-spinner",13)}function E(s,p){1&s&&(e.TgZ(0,"div"),e._uU(1,"Select or drop file"),e.qZA())}function x(s,p){if(1&s&&(e.TgZ(0,"div"),e._uU(1),e.qZA()),2&s){const t=p.$implicit;e.xp6(1),e.Oqu(t.name)}}function O(s,p){1&s&&(e.TgZ(0,"div",18),e._uU(1," Upload succeeded. See the messages below for more information. "),e.qZA())}function M(s,p){1&s&&(e.TgZ(0,"div",19),e._uU(1," Upload failed. See the messages below for more information. "),e.qZA())}const U=function(s,p,t){return{"sxc-message-warning":s,"sxc-message-success":p,"sxc-message-error":t}};function P(s,p){if(1&s&&(e.TgZ(0,"div",20),e._uU(1),e.qZA()),2&s){const t=p.$implicit,_=e.oxw(3);e.Q6J("ngClass",e.kEZ(2,U,t.MessageType===_.FileUploadMessageTypes.Warning,t.MessageType===_.FileUploadMessageTypes.Success,t.MessageType===_.FileUploadMessageTypes.Error)),e.xp6(1),e.hij(" ",t.Text," ")}}function A(s,p){if(1&s&&(e.TgZ(0,"div",14),e.YNc(1,O,2,0,"div",15),e.YNc(2,M,2,0,"div",16),e.YNc(3,P,2,6,"div",17),e.qZA()),2&s){const t=e.oxw().ngIf;e.xp6(1),e.Q6J("ngIf",t.result.Success),e.xp6(1),e.Q6J("ngIf",!t.result.Success),e.xp6(1),e.Q6J("ngForOf",t.result.Messages)}}function y(s,p){if(1&s){const t=e.EpF();e.ynx(0),e.TgZ(1,"button",21),e.NdJ("click",function(){return e.CHM(t),e.oxw(2).closeDialog()}),e._uU(2,"Cancel"),e.qZA(),e.TgZ(3,"button",22),e.NdJ("click",function(){return e.CHM(t),e.oxw(2).upload()}),e._uU(4," Upload "),e.qZA(),e.BQk()}if(2&s){const t=e.oxw().ngIf;e.xp6(3),e.Q6J("disabled",!t.files.length||t.uploading||!!t.result)}}function I(s,p){if(1&s){const t=e.EpF();e.ynx(0),e.TgZ(1,"button",23),e.NdJ("click",function(){return e.CHM(t),e.oxw(2).closeDialog(!0)}),e._uU(2,"Close"),e.qZA(),e.BQk()}}function F(s,p){if(1&s){const t=e.EpF();e.TgZ(0,"div",1),e.NdJ("filesDropped",function(v){return e.CHM(t),e.oxw().filesDropped(v)}),e.TgZ(1,"div",2),e._UZ(2,"div",3),e.ALo(3,"safeHtml"),e.qZA(),e.YNc(4,C,1,0,"mat-spinner",4),e._UZ(5,"p",5),e.ALo(6,"safeHtml"),e.TgZ(7,"div")(8,"button",6),e.NdJ("click",function(){return e.CHM(t),e.MAs(12).click()}),e.YNc(9,E,2,0,"div",7),e.YNc(10,x,2,1,"div",8),e.qZA(),e.TgZ(11,"input",9,10),e.NdJ("change",function(v){return e.CHM(t),e.oxw().filesChanged(v)}),e.qZA()(),e.YNc(13,A,4,3,"div",11),e.TgZ(14,"div",12),e.YNc(15,y,5,1,"ng-container",7),e.YNc(16,I,3,0,"ng-container",7),e.qZA()()}if(2&s){const t=p.ngIf,_=e.oxw();e.Q6J("allowedFileTypes",_.dialogData.allowedFileTypes),e.xp6(2),e.Q6J("innerHtml",e.lcZ(3,10,_.dialogData.title),e.oJD),e.xp6(2),e.Q6J("ngIf",t.uploading),e.xp6(1),e.Q6J("innerHtml",e.lcZ(6,12,_.dialogData.description),e.oJD),e.xp6(3),e.Q6J("disabled",t.uploading),e.xp6(1),e.Q6J("ngIf",!t.files.length),e.xp6(1),e.Q6J("ngForOf",t.files),e.xp6(3),e.Q6J("ngIf",t.result),e.xp6(2),e.Q6J("ngIf",!(null!=t.result&&t.result.Success)),e.xp6(1),e.Q6J("ngIf",null==t.result?null:t.result.Success)}}const L=function(s,p,t){return{uploading:s,files:p,result:t}};let R=(()=>{class s extends f.f{constructor(t,_,v){super(),this.dialogData=t,this.dialogRef=_,this.snackBar=v,this.hostClass="dialog-component",this.uploading$=new u.X(!1),this.files$=new u.X([]),this.result$=new u.X(void 0),this.FileUploadMessageTypes=h.D}ngOnInit(){this.subscription.add(this.files$.subscribe(()=>{void 0!==this.result$.value&&this.result$.next(void 0)})),null!=this.dialogData.files&&this.filesDropped(this.dialogData.files)}ngOnDestroy(){this.uploading$.complete(),this.files$.complete(),this.result$.complete(),super.ngOnDestroy()}closeDialog(t){this.dialogRef.close(t)}filesDropped(t){this.setFiles(t),this.upload()}filesChanged(t){const v=Array.from(t.target.files);this.setFiles(v)}upload(){this.uploading$.next(!0),this.subscription.add(this.dialogData.upload$(this.files$.value).pipe((0,c.q)(1)).subscribe({next:t=>{this.uploading$.next(!1),this.result$.next(t)},error:()=>{this.uploading$.next(!1),this.result$.next(void 0),this.snackBar.open("Upload failed. Please check console for more information",void 0,{duration:3e3})}}))}setFiles(t){this.dialogData.multiple||(t=t.slice(0,1)),this.files$.next(t)}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(l.WI),e.Y36(l.so),e.Y36(D.ux))},s.\u0275cmp=e.Xpm({type:s,selectors:[["app-file-upload-dialog"]],hostVars:1,hostBindings:function(t,_){2&t&&e.Ikx("className",_.hostClass)},features:[e.qOj],decls:4,vars:11,consts:[["appDragAndDrop","",3,"allowedFileTypes","filesDropped",4,"ngIf"],["appDragAndDrop","",3,"allowedFileTypes","filesDropped"],["mat-dialog-title",""],[1,"dialog-title-box",3,"innerHtml"],["mode","indeterminate","diameter","20","color","accent",4,"ngIf"],[1,"dialog-description",3,"innerHtml"],["mat-raised-button","","tippy","Open file browser",3,"disabled","click"],[4,"ngIf"],[4,"ngFor","ngForOf"],["type","file","multiple","",1,"hide",3,"change"],["fileInput",""],["class","dialog-component-content fancy-scrollbar-light result-container",4,"ngIf"],[1,"dialog-component-actions"],["mode","indeterminate","diameter","20","color","accent"],[1,"dialog-component-content","fancy-scrollbar-light","result-container"],["class","sxc-message sxc-message-info",4,"ngIf"],["class","sxc-message sxc-message-error",4,"ngIf"],["class","sxc-message",3,"ngClass",4,"ngFor","ngForOf"],[1,"sxc-message","sxc-message-info"],[1,"sxc-message","sxc-message-error"],[1,"sxc-message",3,"ngClass"],["mat-raised-button","",3,"click"],["mat-raised-button","","color","accent",3,"disabled","click"],["mat-raised-button","","color","accent",3,"click"]],template:function(t,_){1&t&&(e.YNc(0,F,17,14,"div",0),e.ALo(1,"async"),e.ALo(2,"async"),e.ALo(3,"async")),2&t&&e.Q6J("ngIf",e.kEZ(7,L,e.lcZ(1,1,_.uploading$),e.lcZ(2,3,_.files$),e.lcZ(3,5,_.result$)))},directives:[i.O5,n.z,l.uh,a.Ou,d.lW,r.$,i.sg,i.mk],pipes:[i.Ov,g.z],styles:[".result-container[_ngcontent-%COMP%]{margin-top:16px}"]}),s})()},2305:(T,m,o)=>{o.d(m,{D:()=>l});const l={Warning:0,Success:1,Error:2}},3889:(T,m,o)=>{o.d(m,{D:()=>u.D,U:()=>l.U});var l=o(9262),u=o(2305)},5982:(T,m,o)=>{o.d(m,{z:()=>h});var l=o(3184),u=o(3280),c=o(5904),f=o(2528);let h=(()=>{class e extends c.f{constructor(i,n,a){super(),this.zone=n,this.snackBar=a,this.markStyle="outline",this.allowedFileTypes="",this.filesDropped=new l.vpe,this.dropAreaClass="eav-droparea",this.dragClass="eav-dragover",this.timeouts=[],this.element=i.nativeElement}ngOnInit(){this.markStyleClass=`eav-droparea-${this.markStyle}`,this.element.classList.add(this.dropAreaClass,this.markStyleClass),this.zone.runOutsideAngular(()=>{this.subscription.add((0,u.R)(this.element,"dragover").subscribe(i=>{i.preventDefault(),i.stopPropagation(),this.clearTimeouts(),this.element.classList.add(this.dragClass)})),this.subscription.add((0,u.R)(this.element,"dragleave").subscribe(i=>{i.preventDefault(),i.stopPropagation(),this.timeouts.push(window.setTimeout(()=>{this.element.classList.remove(this.dragClass)},50))}))})}ngOnDestroy(){this.clearTimeouts(),this.element.classList.remove(this.dropAreaClass,this.markStyleClass,this.dragClass),super.ngOnDestroy()}onDrop(i){i.preventDefault(),i.stopPropagation(),this.clearTimeouts(),this.element.classList.remove(this.dragClass);let a=Array.from(i.dataTransfer.files);a=this.filterTypes(a,this.allowedFileTypes),a.length>0&&this.filesDropped.emit(a)}clearTimeouts(){for(const i of this.timeouts)clearTimeout(i);this.timeouts=[]}filterTypes(i,n){if(""===n)return i;const a=n.split(",").map(r=>r.toLocaleLowerCase()),d=i.filter(r=>{const g=r.name.lastIndexOf(".");if(g<=0)return!1;const C=r.name.substring(g+1).toLocaleLowerCase();return a.includes(C)});if(i.length!==d.length){const r=this.allowedFileTypes.replace(/\,/g,", ");this.snackBar.open(d.length?"Some files were filtered out. This drop location only accepts file types: "+r:"This drop location only accepts file types: "+r,null,{duration:5e3})}return d}}return e.\u0275fac=function(i){return new(i||e)(l.Y36(l.SBq),l.Y36(l.R0b),l.Y36(f.ux))},e.\u0275dir=l.lG2({type:e,selectors:[["","appDragAndDrop",""]],hostBindings:function(i,n){1&i&&l.NdJ("drop",function(d){return n.onDrop(d)})},inputs:{markStyle:"markStyle",allowedFileTypes:"allowedFileTypes"},outputs:{filesDropped:"filesDropped"},features:[l.qOj]}),e})()},1555:(T,m,o)=>{o.d(m,{z:()=>c});var l=o(3184),u=o(318);let c=(()=>{class f{constructor(e){this.sanitizer=e}transform(e){return this.sanitizer.bypassSecurityTrustHtml(e)}}return f.\u0275fac=function(e){return new(e||f)(l.Y36(u.H7,16))},f.\u0275pipe=l.Yjl({name:"safeHtml",type:f,pure:!0}),f})()}}]);
//# sourceMappingURL=https://sources.2sxc.org/15.02.00/ng-edit/projects_eav-ui_src_app_import-app_services_import-app_service_ts-projects_eav-ui_src_app_sha-1ab7ba.4935988a246a3231.js.map