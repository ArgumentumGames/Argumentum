(window.webpackJsonp=window.webpackJsonp||[]).push([[50],{ji8j:function(e,t,n){"use strict";n.r(t),n.d(t,"MultiItemEditFormComponent",(function(){return it}));var i=n("D57K"),a=n("xeA8"),o=(n("qzOT"),n("C05f")),r=n("g6G6"),s=n("KTx3"),c=n("8K1b"),l=n("AqVP"),u=n("9fIP"),h=n("MMYH"),d=n("ckkg"),f=n("FU6l"),g=n("5uGe"),b=n("sWLk"),p=n("uCWR");function m(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var i=t[t.length-1];return"function"==typeof i&&t.pop(),Object(d.a)(t,void 0).lift(new v(i))}var v=function(){function e(t){Object(u.a)(this,e),this.resultSelector=t}return Object(h.a)(e,[{key:"call",value:function(e,t){return t.subscribe(new y(e,this.resultSelector))}}]),e}(),y=function(e){Object(c.a)(n,e);var t=Object(l.a)(n);function n(e,i){var a;return arguments.length>2&&void 0!==arguments[2]||Object.create(null),Object(u.a)(this,n),(a=t.call(this,e)).resultSelector=i,a.iterators=[],a.active=0,a.resultSelector="function"==typeof i?i:void 0,a}return Object(h.a)(n,[{key:"_next",value:function(e){var t=this.iterators;Object(f.a)(e)?t.push(new x(e)):t.push("function"==typeof e[b.a]?new S(e[b.a]()):new C(this.destination,this,e))}},{key:"_complete",value:function(){var e=this.iterators,t=e.length;if(this.unsubscribe(),0!==t){this.active=t;for(var n=0;n<t;n++){var i=e[n];i.stillUnsubscribed?this.destination.add(i.subscribe()):this.active--}}else this.destination.complete()}},{key:"notifyInactive",value:function(){this.active--,0===this.active&&this.destination.complete()}},{key:"checkIterators",value:function(){for(var e=this.iterators,t=e.length,n=this.destination,i=0;i<t;i++){var a=e[i];if("function"==typeof a.hasValue&&!a.hasValue())return}for(var o=!1,r=[],s=0;s<t;s++){var c=e[s],l=c.next();if(c.hasCompleted()&&(o=!0),l.done)return void n.complete();r.push(l.value)}this.resultSelector?this._tryresultSelector(r):n.next(r),o&&n.complete()}},{key:"_tryresultSelector",value:function(e){var t;try{t=this.resultSelector.apply(this,e)}catch(n){return void this.destination.error(n)}this.destination.next(t)}}]),n}(g.a),S=function(){function e(t){Object(u.a)(this,e),this.iterator=t,this.nextResult=t.next()}return Object(h.a)(e,[{key:"hasValue",value:function(){return!0}},{key:"next",value:function(){var e=this.nextResult;return this.nextResult=this.iterator.next(),e}},{key:"hasCompleted",value:function(){var e=this.nextResult;return Boolean(e&&e.done)}}]),e}(),x=function(){function e(t){Object(u.a)(this,e),this.array=t,this.index=0,this.length=0,this.length=t.length}return Object(h.a)(e,[{key:b.a,value:function(){return this}},{key:"next",value:function(e){var t=this.index++;return t<this.length?{value:this.array[t],done:!1}:{value:null,done:!0}}},{key:"hasValue",value:function(){return this.array.length>this.index}},{key:"hasCompleted",value:function(){return this.array.length===this.index}}]),e}(),C=function(e){Object(c.a)(n,e);var t=Object(l.a)(n);function n(e,i,a){var o;return Object(u.a)(this,n),(o=t.call(this,e)).parent=i,o.observable=a,o.stillUnsubscribed=!0,o.buffer=[],o.isComplete=!1,o}return Object(h.a)(n,[{key:b.a,value:function(){return this}},{key:"next",value:function(){var e=this.buffer;return 0===e.length&&this.isComplete?{value:null,done:!0}:{value:e.shift(),done:!1}}},{key:"hasValue",value:function(){return this.buffer.length>0}},{key:"hasCompleted",value:function(){return 0===this.buffer.length&&this.isComplete}},{key:"notifyComplete",value:function(){this.buffer.length>0?(this.isComplete=!0,this.parent.notifyInactive()):this.destination.complete()}},{key:"notifyNext",value:function(e){this.buffer.push(e),this.parent.checkIterators()}},{key:"subscribe",value:function(){return Object(p.c)(this.observable,new p.a(this))}}]),n}(p.b),O=n("ROBh"),M=n("8j5Y"),w=n("BwBJ"),k=n("J+dc"),I=n("0Woy"),_=n("YtkY"),A=n("xVbo"),P=n("TLy2"),D=n("4e/d"),R=n("50eG"),L=n("uuTa"),E=n("W1gw"),B=n("EM62"),$=n("2kYt"),T=n("s2Ay");function j(e,t){if(1&e&&(B.Sb(0,"div"),B.Sb(1,"span"),B.Oc(2),B.Sb(3,"span"),B.Oc(4),B.fc(5,"translate"),B.Rb(),B.Rb(),B.Rb()),2&e){var n=t.$implicit;B.Ab(2),B.Pc(n.field),B.Ab(2),B.Qc(": ",B.gc(5,2,n.message),"")}}var F=function(){function e(e){this.snackBarData=e,this.fieldErrors=[]}return e.prototype.ngOnInit=function(){this.fieldErrors=this.snackBarData.fieldErrors},e.\u0275fac=function(t){return new(t||e)(B.Mb(E.a))},e.\u0275cmp=B.Gb({type:e,selectors:[["app-snack-bar-save-errors"]],decls:6,vars:4,consts:[[1,"save-errors-container"],[4,"ngFor","ngForOf"]],template:function(e,t){1&e&&(B.Sb(0,"div",0),B.Sb(1,"div"),B.Oc(2),B.fc(3,"translate"),B.Rb(),B.Nb(4,"br"),B.Mc(5,j,6,4,"div",1),B.Rb()),2&e&&(B.Ab(2),B.Pc(B.gc(3,2,"Errors.SaveErrors")),B.Ab(3),B.kc("ngForOf",t.fieldErrors))},directives:[$.s],pipes:[T.d],styles:[".save-errors-container[_ngcontent-%COMP%]{font-size:14px}"],changeDetection:0}),e}(),V=n("qFEQ"),H=n("PBFl"),G=function(){function e(e,t){this.snackRef=e,this.snackBarData=t}return e.prototype.ngOnInit=function(){},e.prototype.saveChanges=function(e){this.snackBarData.save=e,this.snackRef.dismissWithAction()},e.\u0275fac=function(t){return new(t||e)(B.Mb(E.d),B.Mb(E.a))},e.\u0275cmp=B.Gb({type:e,selectors:[["app-snack-bar-unsaved-changes"]],decls:10,vars:9,consts:[[1,"error-message"],["fxLayoutAlign","end end"],["mat-button","","color","accent",3,"click"]],template:function(e,t){1&e&&(B.Sb(0,"span",0),B.Oc(1),B.fc(2,"translate"),B.Rb(),B.Sb(3,"div",1),B.Sb(4,"button",2),B.ac("click",(function(){return t.saveChanges(!1)})),B.Oc(5),B.fc(6,"translate"),B.Rb(),B.Sb(7,"button",2),B.ac("click",(function(){return t.saveChanges(!0)})),B.Oc(8),B.fc(9,"translate"),B.Rb(),B.Rb()),2&e&&(B.Ab(1),B.Pc(B.gc(2,3,"Errors.UnsavedChanges")),B.Ab(4),B.Qc(" ",B.gc(6,5,"General.Buttons.NotSave").toUpperCase()," "),B.Ab(3),B.Qc(" ",B.gc(9,7,"General.Buttons.Save").toUpperCase()," "))},directives:[V.b,H.b],pipes:[T.d],styles:[".error-message[_ngcontent-%COMP%]{font-size:14px}"],changeDetection:0}),e}(),X=function(){function e(){}return e.create=function(e){var t={};return Object(R.a)("eavValues.values.forEach: ",e.values),e.values.forEach((function(e){var n=e.dimensions.map((function(e){return e.value})).join();t[n]=e.value})),t},e}(),N=function(){function e(){}return e.create=function(t){var n=new e;return Object.keys(t).forEach((function(e){var i=t[e].type;n[i]||(n[i]={}),n[i][e]=X.create(t[e])})),n},e}(),Z=function(){return function(e){this.Target=e.Target,this.Singleton=e.Singleton,e.Number&&(this.Number=e.Number),e.String&&(this.String=e.String),e.Guid&&(this.Guid=e.Guid)}}(),z=function(){return function(e,t){this.Id=e,this.Name=t}}(),U=function(){function e(e,t,n,i,a,o,r,s){this.Id=e,this.Version=t,this.Guid=n,this.Type=i,this.Attributes=a,this.Owner=o,this.Metadata=r,s&&(this.For=s)}return e.create=function(t){var n=N.create(t.attributes),i=this.createArray(t.metadata),a=t.For?new Z(t.For):null;return new e(t.id,t.version,t.guid,new z(t.type.id,t.type.name),n,t.owner,i,a)},e.createArray=function(t){if(!t)return null;var n=new Array;return t.forEach((function(t){n.push(e.create(t))})),n},e}(),Y=function(){function e(e,t){this.Header=e,this.Entity=t}return e.create=function(t){return new e(t.header,U.create(t.entity))},e}(),Q=n("gZep"),q=n("bwdy"),W=n("+HK3"),K=n("nwk6"),J=n("qRWW"),ee=n("ywpU"),te=n("DHBU"),ne=n("sNyq"),ie=n("JXuk"),ae=n("V06R");function oe(e,t){if(1&e){var n=B.Tb();B.Sb(0,"div"),B.Sb(1,"app-eav-form",1),B.ac("formSubmit",(function(){return B.Ac(n),B.ec().submit()}))("formValueChange",(function(e){return B.Ac(n),B.ec().formValueChange(e)})),B.fc(2,"async"),B.Rb(),B.Rb()}if(2&e){var i=B.ec();B.Ab(1),B.kc("config",B.gc(2,3,i.itemFields$))("formId",i.formId)("entityGuid",i.item.entity.guid)}}var re=function(){function e(e,t,n,i,a,o){this.languageInstanceService=e,this.itemService=t,this.contentTypeService=n,this.eavService=i,this.actions$=a,this.buildFieldsService=o,this.itemFormValueChange=new B.n,this.subscription=new q.a}return e.prototype.ngOnInit=function(){var e=this;this.subscription.add(this.languageInstanceService.getDefaultLanguage(this.formId).subscribe((function(t){e.defaultLanguage=t}))),this.subscription.add(this.languageInstanceService.getCurrentLanguage(this.formId).subscribe((function(t){e.currentLanguage=t,e.setFormValues()})));var t=K.a.getContentTypeId(this.item);this.contentType$=this.contentTypeService.getContentTypeById(t),this.itemFields$=this.buildFieldsService.buildFields(this.contentType$,this.item,this.formId,this.currentLanguage,this.defaultLanguage,this.enableHistory)},e.prototype.ngOnDestroy=function(){this.subscription.unsubscribe()},e.prototype.ngOnChanges=function(e){null!=e.item&&this.setFormValues()},e.prototype.formSaveObservable=function(){var e=this;return this.actions$.pipe(Object(a.e)(Q.a),Object(A.a)((function(t){return 0===e.item.entity.id?e.item.entity.guid===t.item.entity.guid:e.item.entity.id===t.item.entity.id})))},e.prototype.formValueChange=function(e){this.itemService.updateItemAttributesValues(this.item.entity.guid,e.formValues,this.currentLanguage,this.defaultLanguage),e.formulaInstance.runSettingsFormulas(),e.formulaInstance.runValueFormulas(),this.itemFormValueChange.emit()},e.prototype.submit=function(){(this.form.form.valid||this.checkAreAllControlsDisabled()||this.item.header.Group&&this.item.header.Group.SlotCanBeEmpty)&&this.eavService.saveItem(this.item)},e.prototype.checkAreAllControlsDisabled=function(){var e,t,n=!0,a=Object.keys(this.form.form.controls);try{for(var o=Object(i.h)(a),r=o.next();!r.done;r=o.next())if(!this.form.form.controls[r.value].disabled){n=!1;break}}catch(s){e={error:s}}finally{try{r&&!r.done&&(t=o.return)&&t.call(o)}finally{if(e)throw e.error}}return n},e.prototype.setFormValues=function(){var e=this;if(this.form){var t={};Object.keys(this.item.entity.attributes).forEach((function(n){t[n]=J.a.translate(e.currentLanguage,e.defaultLanguage,e.item.entity.attributes[n],null)})),this.form.valueIsChanged(t)&&this.form.patchValue(t,!1),this.eavService.formValueChange$.next({formId:this.formId,entityGuid:this.item.entity.guid,entityValues:t})}},e.\u0275fac=function(t){return new(t||e)(B.Mb(ee.a),B.Mb(te.a),B.Mb(ne.a),B.Mb(ie.a),B.Mb(a.a),B.Mb(ae.a))},e.\u0275cmp=B.Gb({type:e,selectors:[["app-item-edit-form"]],viewQuery:function(e,t){var n;1&e&&B.Tc(W.a,!0),2&e&&B.xc(n=B.bc())&&(t.form=n.first)},inputs:{item:"item",formId:"formId",enableHistory:"enableHistory"},outputs:{itemFormValueChange:"itemFormValueChange"},features:[B.yb],decls:2,vars:3,consts:[[4,"ngIf"],[3,"config","formId","entityGuid","formSubmit","formValueChange"]],template:function(e,t){1&e&&(B.Mc(0,oe,3,5,"div",0),B.fc(1,"async")),2&e&&B.kc("ngIf",B.gc(1,1,t.contentType$))},directives:[$.t,W.a],pipes:[$.b],styles:[""],changeDetection:0}),e}(),se=function(){function e(){}return e.Show="show",e.Hide="hide",e.Branch="branch",e}();function ce(e,t){return e.key<t.key?-1:e.key>t.key?1:0}var le=n("OZ4H"),ue=n("eOOH"),he=n("2FQU"),de=n("U0Os"),fe=n("9LM3"),ge=n("+Isi"),be=n("ubup"),pe=n("39Ct"),me=n("sEIs"),ve=n("0adC"),ye=n("00Q8"),Se=n("GuwJ"),xe=n("GAih"),Ce=n("Meci"),Oe=n("nKqi"),Me=n("bFHC"),we=n("mFH5"),ke=function(e){return{"mat-list-item-focus":e}},Ie=function(){function e(e,t){this.dialogRef=e,this.data=t,this.Modes=se}return e.prototype.ngOnInit=function(){this.publishMode=this.data},e.prototype.setMode=function(e){this.dialogRef.close(e)},e.\u0275fac=function(t){return new(t||e)(B.Mb(le.g),B.Mb(le.a))},e.\u0275cmp=B.Gb({type:e,selectors:[["app-save-status-dialog"]],decls:35,vars:33,consts:[[1,"mat-card__header"],[1,"mat-card__title"],[1,"mat-card__description"],["toggle",""],[3,"ngClass","click"],["matListIcon","","color","accent"],["matLine","",1,"mat-list-item__title"],["matLine","",1,"mat-list-item__body"],["matListIcon","","color","accent","svgIcon","draft-branch"]],template:function(e,t){1&e&&(B.Sb(0,"mat-card"),B.Sb(1,"div",0),B.Sb(2,"div",1),B.Oc(3),B.fc(4,"translate"),B.Rb(),B.Sb(5,"div",2),B.Oc(6),B.fc(7,"translate"),B.Rb(),B.Rb(),B.Sb(8,"mat-nav-list",3),B.Sb(9,"mat-list-item",4),B.ac("click",(function(){return t.setMode(t.Modes.Show)})),B.Sb(10,"mat-icon",5),B.Oc(11,"visibility"),B.Rb(),B.Sb(12,"div",6),B.Oc(13),B.fc(14,"translate"),B.Rb(),B.Sb(15,"div",7),B.Oc(16),B.fc(17,"translate"),B.Rb(),B.Rb(),B.Sb(18,"mat-list-item",4),B.ac("click",(function(){return t.setMode(t.Modes.Hide)})),B.Sb(19,"mat-icon",5),B.Oc(20,"visibility_off"),B.Rb(),B.Sb(21,"div",6),B.Oc(22),B.fc(23,"translate"),B.Rb(),B.Sb(24,"div",7),B.Oc(25),B.fc(26,"translate"),B.Rb(),B.Rb(),B.Sb(27,"mat-list-item",4),B.ac("click",(function(){return t.setMode(t.Modes.Branch)})),B.Nb(28,"mat-icon",8),B.Sb(29,"div",6),B.Oc(30),B.fc(31,"translate"),B.Rb(),B.Sb(32,"div",7),B.Oc(33),B.fc(34,"translate"),B.Rb(),B.Rb(),B.Rb(),B.Rb()),2&e&&(B.Ab(3),B.Pc(B.gc(4,11,"SaveMode.Dialog.Title")),B.Ab(3),B.Pc(B.gc(7,13,"SaveMode.Dialog.Intro")),B.Ab(3),B.kc("ngClass",B.oc(27,ke,t.publishMode===t.Modes.Show)),B.Ab(4),B.Pc(B.gc(14,15,"SaveMode.Dialog.Show.Title")),B.Ab(3),B.Pc(B.gc(17,17,"SaveMode.Dialog.Show.Body")),B.Ab(2),B.kc("ngClass",B.oc(29,ke,t.publishMode===t.Modes.Hide)),B.Ab(4),B.Pc(B.gc(23,19,"SaveMode.Dialog.Hide.Title")),B.Ab(3),B.Pc(B.gc(26,21,"SaveMode.Dialog.Hide.Body")),B.Ab(2),B.kc("ngClass",B.oc(31,ke,t.publishMode===t.Modes.Branch)),B.Ab(3),B.Pc(B.gc(31,23,"SaveMode.Dialog.Branch.Title")),B.Ab(3),B.Pc(B.gc(34,25,"SaveMode.Dialog.Branch.Body")))},directives:[Ce.a,Oe.e,Oe.c,$.q,xe.a,Me.a,Oe.b,we.j],pipes:[T.d],styles:[".mat-list-item-focus[_ngcontent-%COMP%]{background:rgba(0,0,0,.04)}"],changeDetection:0}),e}(),_e=n("Y2X+"),Ae=function(){function e(e,t){var n=this;this.ngZone=e,this.header=t,this.moveThreshold=2,this.stopClick=!1,this.eventListeners=[],this.ngZone.runOutsideAngular((function(){var e=n.checkIfMouseMoved.bind(n);document.addEventListener("mouseup",e,{passive:!0}),n.eventListeners.push({element:document,type:"mouseup",listener:e})}))}return e.prototype.lngButtonDown=function(e){var t=this;this.ngZone.runOutsideAngular((function(){t.saveInitialPosition(e)}))},e.prototype.lngButtonClick=function(e){var t=this;this.ngZone.runOutsideAngular((function(){t.doMove(e)}))},e.prototype.stopClickIfMouseMoved=function(){return this.stopClick},e.prototype.destroy=function(){var e=this;this.ngZone.runOutsideAngular((function(){e.eventListeners.forEach((function(e){e.element.removeEventListener(e.type,e.listener),e=null})),e.eventListeners=null}))},e.prototype.saveInitialPosition=function(e){this.stopClick=!1,this.positionX=e.pageX,this.positionY=e.pageY},e.prototype.checkIfMouseMoved=function(e){this.positionX&&this.positionY?(this.stopClick=Math.abs(this.positionX+this.positionY-(e.pageX+e.pageY))>this.moveThreshold,this.positionX=null,this.positionY=null):this.stopClick=!1},e.prototype.doMove=function(e){if(!this.stopClick){var t=e.target,n=t.getBoundingClientRect().left,i=t.getBoundingClientRect().width,a=this.header.getBoundingClientRect().left,o=this.header.getBoundingClientRect().width;this.header.scrollLeft+=n+i/2-(a+o/2)}},e}();function Pe(e){return e.substring(0,e.indexOf("(")>0?e.indexOf("(")-1:100).toLocaleUpperCase()}var De=function(){function e(e,t,n){var i=this;this.ngZone=e,this.header=t,this.areButtonsDisabled=n,this.eventListeners=[],this.ngZone.runOutsideAngular((function(){var e=i.registerScroll.bind(i);i.header.addEventListener("pointerdown",e,{passive:!0}),i.headerDownListener={element:i.header,type:"pointerdown",listener:e}}))}return e.prototype.destroy=function(){var e=this;this.ngZone.runOutsideAngular((function(){e.headerDownListener.element.removeEventListener(e.headerDownListener.type,e.headerDownListener.listener),e.headerDownListener=null,e.eventListeners.forEach((function(e){e.element.removeEventListener(e.type,e.listener),e=null})),e.eventListeners=null})),this.ngZone=null,this.header=null,this.areButtonsDisabled=null},e.prototype.registerScroll=function(e){if(!this.areButtonsDisabled()&&0===e.button){window.getSelection().removeAllRanges(),this.oldScrollBehavior=getComputedStyle(this.header).getPropertyValue("scroll-behavior"),this.header.style.scrollBehavior="auto",this.positionX=e.pageX;var t=this.doScroll.bind(this),n=this.removeScroll.bind(this);document.addEventListener("pointermove",t,{passive:!0}),document.addEventListener("pointerup",n,{passive:!0}),document.addEventListener("pointerleave",n,{passive:!0}),this.eventListeners.push({element:document,type:"pointermove",listener:t},{element:document,type:"pointerup",listener:n},{element:document,type:"pointerleave",listener:n})}},e.prototype.removeScroll=function(){this.header.style.scrollBehavior=this.oldScrollBehavior,this.eventListeners.forEach((function(e){e.element.removeEventListener(e.type,e.listener),e=null})),this.eventListeners.splice(0,this.eventListeners.length)},e.prototype.doScroll=function(e){var t=e.pageX;t<this.positionX?this.header.scrollLeft+=this.positionX-t:t>this.positionX&&(this.header.scrollLeft+=-(t-this.positionX)),this.positionX=t},e}(),Re=function(){function e(e,t,n,i){var a=this;this.ngZone=e,this.header=t,this.leftShadow=n,this.rightShadow=i,this.hidden="hidden",this.eventListeners=[],this.ngZone.runOutsideAngular((function(){a.calculateShadows();var e=a.calculateShadows.bind(a);a.header.addEventListener("scroll",e,{passive:!0}),window.addEventListener("resize",e,{passive:!0}),a.eventListeners.push({element:a.header,type:"scroll",listener:e},{element:window,type:"resize",listener:e})}))}return e.prototype.destroy=function(){var e=this;this.ngZone.runOutsideAngular((function(){e.eventListeners.forEach((function(e){e.element.removeEventListener(e.type,e.listener),e=null})),e.eventListeners=null})),this.ngZone=null,this.header=null,this.leftShadow=null,this.rightShadow=null},e.prototype.calculateShadows=function(){this.maxScrollLeft=this.header.scrollWidth-this.header.clientWidth,0===this.maxScrollLeft?this.hideBoth():0===this.header.scrollLeft?this.hideLeft():this.header.scrollLeft===this.maxScrollLeft?this.hideRight():this.showBoth()},e.prototype.hideBoth=function(){this.leftShadow.classList.add(this.hidden),this.rightShadow.classList.add(this.hidden)},e.prototype.hideLeft=function(){this.leftShadow.classList.add(this.hidden),this.rightShadow.classList.remove(this.hidden)},e.prototype.hideRight=function(){this.leftShadow.classList.remove(this.hidden),this.rightShadow.classList.add(this.hidden)},e.prototype.showBoth=function(){this.leftShadow.classList.remove(this.hidden),this.rightShadow.classList.remove(this.hidden)},e}(),Le=["scrollable"],Ee=["leftShadow"],Be=["rightShadow"];function $e(e,t){if(1&e){var n=B.Tb();B.Sb(0,"button",9),B.ac("mousedown",(function(e){return B.Ac(n),B.ec(2).lngButtonMouseDown(e)}))("click",(function(e){B.Ac(n);var i=t.$implicit;return B.ec(2).lngButtonClick(e,i)})),B.Oc(1),B.Rb()}if(2&e){var i=t.$implicit,a=B.ec().ngIf,o=B.ec();B.kc("disabled",o.disabled&&a.currentLanguage!==i.key)("color",a.currentLanguage===i.key?"accent":"white")("matTooltip",i.name)("matTooltipDisabled",o.disabled),B.Ab(1),B.Qc(" ",i.buttonText," ")}}function Te(e,t){if(1&e&&(B.Sb(0,"div",1),B.Nb(1,"div",2,3),B.Nb(3,"div",4,5),B.Sb(5,"div",6,7),B.fc(7,"translate"),B.Mc(8,$e,2,5,"button",8),B.fc(9,"async"),B.Rb(),B.Rb()),2&e){var n=B.ec();B.Ab(5),B.kc("matTooltip",B.gc(7,3,"Message.CantSwitchLanguage"))("matTooltipDisabled",!n.disabled),B.Ab(3),B.kc("ngForOf",B.gc(9,5,n.languageButtons$))}}var je=function(e){return{currentLanguage:e}},Fe=function(){function e(e,t,n){this.languageService=e,this.languageInstanceService=t,this.ngZone=n}return e.prototype.ngOnInit=function(){this.languageButtons$=this.languageService.entities$.pipe(Object(_.a)((function(e){return n=[],i={},(t=e).forEach((function(e){var t=Pe(e.name);i[t]?i[t]++:i[t]=1})),t.forEach((function(e){var t=Pe(e.name);n.push({name:e.name,key:e.key,buttonText:i[t]>1?t+" ("+e.key+")":t})})),n;var t,n,i}))),this.currentLanguage$=this.languageInstanceService.getCurrentLanguage(this.formId)},e.prototype.ngAfterViewInit=function(){this.showShadowsService=new Re(this.ngZone,this.headerRef.nativeElement,this.leftShadowRef.nativeElement,this.rightShadowRef.nativeElement),this.mouseScrollHelper=new De(this.ngZone,this.headerRef.nativeElement,this.areButtonsDisabled.bind(this)),this.centerSelectedService=new Ae(this.ngZone,this.headerRef.nativeElement)},e.prototype.ngOnDestroy=function(){this.centerSelectedService.destroy(),this.mouseScrollHelper.destroy(),this.showShadowsService.destroy()},e.prototype.lngButtonMouseDown=function(e){this.centerSelectedService.lngButtonDown(e)},e.prototype.lngButtonClick=function(e,t){this.disabled||(this.centerSelectedService.lngButtonClick(e),this.centerSelectedService.stopClickIfMouseMoved()||this.languageInstanceService.updateCurrentLanguage(this.formId,t.key))},e.prototype.areButtonsDisabled=function(){return this.disabled},e.\u0275fac=function(t){return new(t||e)(B.Mb(ge.a),B.Mb(ee.a),B.Mb(B.A))},e.\u0275cmp=B.Gb({type:e,selectors:[["app-eav-language-switcher"]],viewQuery:function(e,t){var n;1&e&&(B.Tc(Le,!0),B.Tc(Ee,!0),B.Tc(Be,!0)),2&e&&(B.xc(n=B.bc())&&(t.headerRef=n.first),B.xc(n=B.bc())&&(t.leftShadowRef=n.first),B.xc(n=B.bc())&&(t.rightShadowRef=n.first))},inputs:{formId:"formId",disabled:"disabled"},decls:2,vars:5,consts:[["class","scrollable__overlay",4,"ngIf"],[1,"scrollable__overlay"],[1,"scrollable__overlay--left-shadow"],["leftShadow",""],[1,"scrollable__overlay--right-shadow"],["rightShadow",""],[1,"scrollable","lang-switch",3,"matTooltip","matTooltipDisabled"],["scrollable",""],["mat-flat-button","","class","lang-switch__button",3,"disabled","color","matTooltip","matTooltipDisabled","mousedown","click",4,"ngFor","ngForOf"],["mat-flat-button","",1,"lang-switch__button",3,"disabled","color","matTooltip","matTooltipDisabled","mousedown","click"]],template:function(e,t){1&e&&(B.Mc(0,Te,10,7,"div",0),B.fc(1,"async")),2&e&&B.kc("ngIf",B.oc(3,je,B.gc(1,1,t.currentLanguage$)))},directives:[$.t,_e.a,$.s,H.b],pipes:[$.b,T.d],styles:['.scrollable__overlay[_ngcontent-%COMP%]{position:relative;height:100%}.scrollable__overlay--left-shadow[_ngcontent-%COMP%], .scrollable__overlay--right-shadow[_ngcontent-%COMP%]{content:"";position:absolute;top:0;display:block;z-index:1;pointer-events:none;height:100%;width:80px;background-image:linear-gradient(90deg,#fff 8px,hsla(0,0%,100%,0))}@media (max-width:600px){.scrollable__overlay--left-shadow[_ngcontent-%COMP%], .scrollable__overlay--right-shadow[_ngcontent-%COMP%]{width:24px}}.scrollable__overlay--right-shadow[_ngcontent-%COMP%]{right:0;background-image:linear-gradient(270deg,#fff 8px,hsla(0,0%,100%,0))}.scrollable[_ngcontent-%COMP%]{overflow:hidden;scroll-behavior:smooth;height:100%}.lang-switch[_ngcontent-%COMP%]{display:flex}.lang-switch__button[_ngcontent-%COMP%]{height:100%;flex-shrink:0;border-radius:0;margin-left:0!important;color:rgba(0,0,0,.4);border-bottom:none;font-size:12px;line-height:54px;padding:0 6px;background-color:#fff!important}.lang-switch__button.mat-accent[_ngcontent-%COMP%]{color:#2680eb;border-bottom:2px solid #2680eb;background-color:inherit}.hidden[_ngcontent-%COMP%]{visibility:hidden}'],changeDetection:0}),e}();function Ve(e,t){1&e&&(B.Sb(0,"div",7),B.Oc(1),B.fc(2,"translate"),B.Rb()),2&e&&(B.Ab(1),B.Pc(B.gc(2,1,"ItemCard.CopyHint")))}function He(e,t){if(1&e&&B.Nb(0,"app-eav-language-switcher",8),2&e){var n=B.ec();B.kc("formId",n.formId)("disabled",!n.formsAreValid&&!n.allControlsAreDisabled)}}var Ge=function(){function e(e,t){this.dialog=e,this.languageService=t,this.closeDialog=new B.n,this.setPublishMode=new B.n,this.hasLanguages$=this.languageService.entities$.pipe(Object(_.a)((function(e){return e.length>0})))}return e.prototype.ngOnInit=function(){},e.prototype.close=function(){this.closeDialog.emit()},e.prototype.openSaveStatusDialog=function(){var e=this,t=this.dialog.open(Ie,{panelClass:"c-save-status-dialog",autoFocus:!1,width:"350px",data:this.publishMode});t.keydownEvents().subscribe((function(e){83===e.keyCode&&(navigator.platform.match("Mac")?e.metaKey:e.ctrlKey)&&e.preventDefault()})),t.afterClosed().subscribe((function(t){null!=t&&e.setPublishMode.emit(t)}))},e.\u0275fac=function(t){return new(t||e)(B.Mb(le.b),B.Mb(ge.a))},e.\u0275cmp=B.Gb({type:e,selectors:[["app-multi-item-edit-form-header"]],inputs:{formId:"formId",isCopy:"isCopy",formsAreValid:"formsAreValid",allControlsAreDisabled:"allControlsAreDisabled",isParentDialog:"isParentDialog",publishMode:"publishMode"},outputs:{closeDialog:"closeDialog",setPublishMode:"setPublishMode"},decls:17,vars:18,consts:[[1,"header"],["mat-icon-button","",1,"header__exit-button",3,"matTooltip","click"],["class","header__copy",4,"ngIf"],[1,"header__langs"],[3,"formId","disabled",4,"ngIf"],["mat-button","",1,"header__publish-button",3,"matTooltip","click"],[1,"header__publish-mode"],[1,"header__copy"],[3,"formId","disabled"]],template:function(e,t){1&e&&(B.Sb(0,"mat-card",0),B.Sb(1,"button",1),B.ac("click",(function(){return t.close()})),B.fc(2,"translate"),B.Sb(3,"mat-icon"),B.Oc(4),B.Rb(),B.Rb(),B.Mc(5,Ve,3,3,"div",2),B.Sb(6,"div",3),B.Mc(7,He,1,2,"app-eav-language-switcher",4),B.fc(8,"async"),B.Rb(),B.Sb(9,"button",5),B.ac("click",(function(){return t.openSaveStatusDialog()})),B.fc(10,"translate"),B.Sb(11,"span",6),B.Oc(12),B.fc(13,"translate"),B.Sb(14,"b"),B.Oc(15),B.fc(16,"translate"),B.Rb(),B.Rb(),B.Rb(),B.Rb()),2&e&&(B.Ab(1),B.kc("matTooltip",B.gc(2,7,t.isParentDialog?"Form.Buttons.Exit.Tip":"Form.Buttons.Return.Tip")),B.Ab(3),B.Pc(t.isParentDialog?"clear":"arrow_back"),B.Ab(1),B.kc("ngIf",t.isCopy),B.Ab(2),B.kc("ngIf",B.gc(8,9,t.hasLanguages$)),B.Ab(2),B.kc("matTooltip",B.gc(10,11,"SaveMode."+t.publishMode+".Tip")),B.Ab(3),B.Qc(" ",B.gc(13,13,"SaveMode.Label")," "),B.Ab(3),B.Pc(B.hc(16,15,"SaveMode."+t.publishMode,"").toUpperCase()))},directives:[Ce.a,H.b,_e.a,Me.a,$.t,Fe],pipes:[T.d,$.b],styles:[".header[_ngcontent-%COMP%]{display:flex;align-items:center;padding:0 16px;border-bottom-left-radius:0;border-bottom-right-radius:0;height:52px;z-index:1;box-shadow:0 2px 5px rgba(0,0,0,.26)}@media (max-width:600px){.header[_ngcontent-%COMP%]{border-radius:0}}.header__exit-button[_ngcontent-%COMP%]{width:30px;height:30px;flex-shrink:0;line-height:30px}.header__exit-button[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{font-size:16px;width:16px;height:16px;line-height:16px!important}.header__copy[_ngcontent-%COMP%]{cursor:default}.header__langs[_ngcontent-%COMP%]{margin-left:12px;flex-grow:1;overflow:hidden;height:100%}.header__publish-button[_ngcontent-%COMP%]{margin-right:-6px;padding:0 10px;height:30px;line-height:32px;flex-shrink:0}.header__publish-mode[_ngcontent-%COMP%]{font-weight:400}"],changeDetection:0}),e}(),Xe=n("HM3f");function Ne(e,t){if(1&e&&(B.Sb(0,"div",6),B.Sb(1,"textarea",7),B.Oc(2),B.fc(3,"json"),B.Rb(),B.Rb()),2&e){var n=B.ec().ngIf;B.Ab(2),B.Pc(B.gc(3,1,n.items))}}var Ze=function(e){return{"debug-enabled":e}};function ze(e,t){if(1&e){var n=B.Tb();B.Sb(0,"mat-card",1),B.Sb(1,"div",2),B.Sb(2,"button",3),B.ac("click",(function(){return B.Ac(n),B.ec().toggleDebugInfo()})),B.fc(3,"translate"),B.Sb(4,"mat-icon"),B.Oc(5,"offline_bolt"),B.Rb(),B.Rb(),B.Sb(6,"div"),B.Oc(7),B.Rb(),B.Sb(8,"button",4),B.Sb(9,"mat-icon"),B.Oc(10,"offline_bolt"),B.Rb(),B.Rb(),B.Rb(),B.Mc(11,Ne,4,3,"div",5),B.Rb()}if(2&e){var i=B.ec();B.kc("ngClass",B.oc(6,Ze,i.showDebugInfo)),B.Ab(2),B.kc("matTooltip",B.gc(3,4,"General.Buttons.Debug")),B.Ab(5),B.Qc("2sxc ",i.sxcVer,""),B.Ab(4),B.kc("ngIf",i.showDebugInfo)}}var Ue=function(){function e(e){this.itemService=e,this.debugInfoOpened=new B.n,this.sxcVer=sxcVersion.substring(0,sxcVersion.lastIndexOf(".")),this.showDebugInfo=!1,this.items$=this.itemService.selectAllItems(),this.templateVars$=Object(Xe.a)([this.items$]).pipe(Object(_.a)((function(e){return{items:Object(i.f)(e,1)[0]}})))}return e.prototype.ngOnInit=function(){},e.prototype.toggleDebugInfo=function(){this.showDebugInfo=!this.showDebugInfo,this.debugInfoOpened.emit(this.showDebugInfo)},e.\u0275fac=function(t){return new(t||e)(B.Mb(te.a))},e.\u0275cmp=B.Gb({type:e,selectors:[["app-multi-item-edit-form-debug"]],outputs:{debugInfoOpened:"debugInfoOpened"},decls:2,vars:3,consts:[["fxLayout","column","fxLayoutAlign","center start",3,"ngClass",4,"ngIf"],["fxLayout","column","fxLayoutAlign","center start",3,"ngClass"],["fxLayout","row","fxLayoutAlign","space-between center",1,"debug-buttons-container"],["mat-icon-button","",3,"matTooltip","click"],["mat-icon-button","",1,"hidden"],["class","debug-info-container",4,"ngIf"],[1,"debug-info-container"],["readonly","",1,"debug-dump"]],template:function(e,t){1&e&&(B.Mc(0,ze,12,8,"mat-card",0),B.fc(1,"async")),2&e&&B.kc("ngIf",B.gc(1,1,t.templateVars$))},directives:[$.t,Ce.a,V.c,V.b,$.q,xe.a,H.b,_e.a,Me.a],pipes:[$.b,T.d,$.k],styles:[".mat-card[_ngcontent-%COMP%]{padding:0;margin:0;border-top-left-radius:0;border-top-right-radius:0;height:52px;z-index:1;width:100%}@media (max-width:600px){.mat-card[_ngcontent-%COMP%]{border-radius:0}}.mat-card.debug-enabled[_ngcontent-%COMP%]{height:auto}.debug-buttons-container[_ngcontent-%COMP%]{padding:17px 16px 15px;height:52px;width:100%}.debug-info-container[_ngcontent-%COMP%]{margin:0 16px 16px!important;width:calc(100% - 2 * 16px);height:300px;position:relative}.debug-dump[_ngcontent-%COMP%]{width:calc(100% - 10px);margin:0;padding:10px 0 10px 10px;border:0;height:calc(100% - 20px);resize:none;background-color:rgba(29,39,61,.04)}.mat-icon-button[_ngcontent-%COMP%]{margin-right:12px;width:30px;height:30px;line-height:30px}.mat-icon[_ngcontent-%COMP%]{font-size:20px;width:20px;height:20px;line-height:20px!important}.hidden[_ngcontent-%COMP%]{visibility:hidden}"],changeDetection:0}),e}(),Ye=["slideable"];function Qe(e,t){if(1&e){var n=B.Tb();B.Sb(0,"div"),B.Sb(1,"app-item-edit-form",16),B.ac("itemFormValueChange",(function(){return B.Ac(n),B.ec(3).formValueChange()})),B.Rb(),B.Rb()}if(2&e){var i=t.$implicit,a=B.ec(2).ngIf,o=B.ec();B.Ab(1),B.kc("item",i)("formId",o.formId)("enableHistory",a.enableHistory)}}function qe(e,t){if(1&e){var n=B.Tb();B.Sb(0,"app-multi-item-edit-form-debug",17),B.ac("debugInfoOpened",(function(e){return B.Ac(n),B.ec(3).debugInfoOpened(e)})),B.Rb()}}var We=function(e){return{"u-display-none":e}},Ke=function(e,t,n){return{"debug-enabled":e,"debug-info-is-open":t,"hide-header-height-fix":n}},Je=function(e,t,n){return{"mat-fab--compact":e,"mat-fab--extended":t,"mat-fab--disabled":n}};function et(e,t){if(1&e){var n=B.Tb();B.Sb(0,"div",2),B.Sb(1,"div",3),B.Sb(2,"app-multi-item-edit-form-header",4),B.ac("closeDialog",(function(){return B.Ac(n),B.ec(2).closeDialog()}))("setPublishMode",(function(e){return B.Ac(n),B.ec(2).setPublishMode(e)})),B.Rb(),B.Rb(),B.Sb(3,"div",5),B.Sb(4,"div",6),B.Sb(5,"div",7),B.Sb(6,"div",8),B.Sb(7,"div",9,10),B.Mc(9,Qe,2,3,"div",11),B.Rb(),B.Rb(),B.Rb(),B.Sb(10,"div",12),B.Sb(11,"div",13),B.Sb(12,"button",14),B.ac("click",(function(){return B.Ac(n),B.ec(2).saveAll(!0)})),B.fc(13,"translate"),B.Sb(14,"mat-icon"),B.Oc(15,"done"),B.Rb(),B.Oc(16),B.fc(17,"translate"),B.Rb(),B.Rb(),B.Rb(),B.Rb(),B.Rb(),B.Mc(18,qe,1,0,"app-multi-item-edit-form-debug",15),B.Rb()}if(2&e){var i=B.ec().ngIf,a=B.ec();B.Ab(1),B.kc("ngClass",B.oc(19,We,i.hideHeader)),B.Ab(1),B.kc("formId",a.formId)("isCopy",i.isCopy)("formsAreValid",i.formsAreValid)("allControlsAreDisabled",i.allControlsAreDisabled)("isParentDialog",a.isParentDialog)("publishMode",i.publishMode),B.Ab(2),B.kc("ngClass",B.qc(21,Ke,i.debugEnabled,i.debugInfoIsOpen,i.hideHeader)),B.Ab(3),B.kc("ngClass",i.slide),B.Ab(2),B.kc("ngForOf",i.items)("ngForTrackBy",a.trackByFn),B.Ab(3),B.kc("matTooltip",B.gc(13,15,"Form.Buttons.Save.Tip"))("ngClass",B.qc(25,Je,i.reduceSaveButton,!i.reduceSaveButton,!i.formsAreValid&&!i.allControlsAreDisabled)),B.Ab(4),B.Qc(" ",i.reduceSaveButton?"":B.gc(17,17,"Form.Buttons.Save").toUpperCase()," "),B.Ab(2),B.kc("ngIf",i.debugEnabled)}}function tt(e,t){if(1&e&&(B.Qb(0),B.Mc(1,et,19,29,"div",1),B.Pb()),2&e){var n=t.ngIf;B.Ab(1),B.kc("ngIf",n.eavConfigLoaded)}}var nt=function(e,t,n,i,a,o,r,s,c,l,u,h){return{items:e,isCopy:t,enableHistory:n,formsAreValid:i,allControlsAreDisabled:a,publishMode:o,reduceSaveButton:r,debugEnabled:s,debugInfoIsOpen:c,hideHeader:l,slide:u,eavConfigLoaded:h}},it=function(){function e(e,t,n,a,r,s,c,l,u,h,d,f,g,b,p,m,v,y,S){var x=this;this.dialogRef=e,this.actions$=t,this.changeDetectorRef=n,this.contentTypeItemService=a,this.contentTypeService=r,this.globalConfigService=s,this.eavService=c,this.featureService=l,this.inputTypeService=u,this.itemService=h,this.languageService=d,this.languageInstanceService=f,this.snackBar=g,this.translate=b,this.validationMessagesService=p,this.loadIconsService=m,this.route=v,this.editRoutingService=y,this.formPrefetchService=S,this.isParentDialog=function(e){var t,n,a,o,r=0;try{for(var s=Object(i.h)(e.snapshot.pathFromRoot),c=s.next();!c.done;c=s.next()){var l=c.value;if(!(l.url.length<=0))try{for(var u=(a=void 0,Object(i.h)(l.url)),h=u.next();!h.done;h=u.next())"edit"===h.value.path&&r++}catch(d){a={error:d}}finally{try{h&&!h.done&&(o=u.return)&&o.call(u)}finally{if(a)throw a.error}}}}catch(f){t={error:f}}finally{try{c&&!c.done&&(n=s.return)&&n.call(s)}finally{if(t)throw t.error}}return 1===r}(this.route),this.formId=Math.floor(99999*Math.random()),this.isCopy$=new o.a(!1),this.enableHistory$=new o.a(!1),this.formsAreValid$=new o.a(!1),this.allControlsAreDisabled$=new o.a(!0),this.publishMode$=new o.a("hide"),this.reduceSaveButton$=new o.a(!1),this.hideHeader$=this.languageInstanceService.getHideHeader(this.formId),this.debugEnabled$=this.globalConfigService.getDebugEnabled().pipe(Object(M.a)((function(e){x.debugInfoIsOpen$.value&&!e&&x.debugInfoIsOpen$.next(!1)}))),this.debugInfoIsOpen$=new o.a(!1),this.eavConfigLoaded$=new o.a(!1),this.formErrors=[],this.formsAreDirty={},this.formSaveAllObservables$=[],this.createMode=!1,this.formIsSaved=!1,this.subscriptions=[],this.editRoutingService.init(this.route,this.formId,this.dialogRef),this.loadIconsService.load()}return e.prototype.ngOnInit=function(){this.fetchFormData()},e.prototype.ngAfterViewChecked=function(){this.attachAllSaveFormObservables(),this.changeDetectorRef.detectChanges(),this.initSlider()},e.prototype.ngOnDestroy=function(){this.isCopy$.complete(),this.enableHistory$.complete(),this.reduceSaveButton$.complete(),this.debugInfoIsOpen$.complete(),this.formsAreValid$.complete(),this.allControlsAreDisabled$.complete(),this.publishMode$.complete(),this.eavConfigLoaded$.complete(),this.subscriptions.forEach((function(e){e.unsubscribe()})),this.languageInstanceService.removeLanguageInstance(this.formId),this.editRoutingService.ngOnDestroy(),this.isParentDialog&&(this.languageInstanceService.clearCache(),this.languageService.clearCache(),this.itemService.clearCache(),this.inputTypeService.clearCache(),this.featureService.clearCache(),this.contentTypeItemService.clearCache(),this.contentTypeService.clearCache(),this.formPrefetchService.clearCache())},e.prototype.closeDialog=function(e){this.dialogRef.disableClose?this.snackBarYouHaveUnsavedChanges():this.dialogRef.close(this.createMode?e:void 0)},e.prototype.setPublishMode=function(e){null==this.eavService.eavConfig.versioningOptions[e]&&(e=Object.keys(this.eavService.eavConfig.versioningOptions)[0]),this.publishMode$.next(e)},e.prototype.trackByFn=function(e,t){return 0===t.entity.id?t.entity.guid:t.entity.id},e.prototype.formValueChange=function(){this.checkFormsState(),this.formErrors=[]},e.prototype.saveAll=function(e){var t=this;this.eavService.forceConnectorSave$.next(),setTimeout((function(){if(t.formsAreValid$.value||t.allControlsAreDisabled$.value)t.itemEditFormRefs.forEach((function(e){e.form.submitOutside()})),Object(R.a)("saveAll",e),t.snackBar.open(t.translate.instant("Message.Saving"),null,{duration:2e3}),e&&(t.formIsSaved=!0);else{t.calculateAllValidationMessages();var n=[];t.formErrors.forEach((function(e){Object.keys(e).forEach((function(t){n.push({field:t,message:e[t]})}))})),t.snackBar.openFromComponent(F,{data:{fieldErrors:n},duration:5e3})}}),100)},e.prototype.debugInfoOpened=function(e){this.debugInfoIsOpen$.next(e)},e.prototype.fetchFormData=function(){var e=this,t=Object(L.b)(this.route.snapshot.params.items),n=JSON.stringify(t.items);this.eavService.fetchFormData(n).subscribe((function(t){setTimeout((function(){e.reduceSaveButton$.next(!0)}),5e3),e.itemService.loadItems(t.Items),e.inputTypeService.addInputTypes(t.InputTypes),e.contentTypeItemService.addContentTypeItems(t.ContentTypeItems),e.contentTypeService.addContentTypes(t.ContentTypes),e.featureService.loadFeatures(t.Features);var n=t.Items.map((function(e){return e.Entity.Guid})).join();null!=t.Prefetch&&e.formPrefetchService.loadPrefetch(t.Prefetch,n),e.eavService.setEavConfig(t.Context),e.eavConfigLoaded$.next(!0);var a=e.eavService.eavConfig.lang.split("-")[0];if(e.translate.use(a),e.isParentDialog){var o=e.eavService.eavConfig.langs,r=Object.keys(o).map((function(e){return{key:e,name:o[e]}})),s=function(e,t){var n,a,o;if(0===t.length)return t;var r=[],s=[];try{for(var c=Object(i.h)(t),l=c.next();!l.done;l=c.next()){var u=l.value;u.key===e?o=u:u.key.startsWith(e.split("-")[0])?r.push(u):s.push(u)}}catch(h){n={error:h}}finally{try{l&&!l.done&&(a=c.return)&&a.call(c)}finally{if(n)throw n.error}}return r.sort(ce),s.sort(ce),o?Object(i.g)([o],r,s):Object(i.g)(r,s)}(e.eavService.eavConfig.langPri,r);e.languageService.loadLanguages(s)}if(e.languageInstanceService.addLanguageInstance(e.formId,e.eavService.eavConfig.lang,e.eavService.eavConfig.langPri,e.eavService.eavConfig.lang,!1),e.setPublishMode(t.DraftShouldBranch?se.Branch:t.IsPublished?se.Show:se.Hide),e.eavService.eavConfig.lang!==e.eavService.eavConfig.langPri&&!e.itemService.valuesExistInDefaultLanguage(t.Items.map((function(e){return 0===e.Entity.Id?e.Entity.Guid:e.Entity.Id})),e.eavService.eavConfig.langPri,e.inputTypeService,e.contentTypeService)){e.languageInstanceService.updateCurrentLanguage(e.formId,e.eavService.eavConfig.langPri);var c=e.translate.instant("Message.SwitchedLanguageToDefault",{language:e.eavService.eavConfig.langPri});e.snackBar.open(c,null,{duration:5e3})}e.items$=e.itemService.selectItemsByIdList(t.Items.map((function(e){return 0===e.Entity.Id?e.Entity.Guid:e.Entity.Id}))).pipe(Object(w.a)(0)),e.items$.pipe(Object(k.a)(1)).subscribe((function(t){0===(null==t?void 0:t[0].entity.id)&&(e.createMode=!0,null!=t[0].header.DuplicateEntity&&e.isCopy$.next(!0)),e.enableHistory$.next(!e.createMode&&!1!==e.route.snapshot.data.history)})),e.languageChangeSubscribe(),e.dialogBackdropClickSubscribe(),e.saveFormMessagesSubscribe(),e.formSetValueChangeSubscribe()}))},e.prototype.initSlider=function(){var e=this;null!=this.slideableRef&&null==this.slide$&&(this.slide$=Object(r.a)(this.languageInstanceService.getCurrentLanguage(this.formId).pipe(Object(I.a)(),Object(_.a)((function(t){var n,a=Object(i.f)(t,2),o=a[0],r=a[1];return e.languageService.entities$.pipe(Object(k.a)(1)).subscribe((function(e){n=e})),n.findIndex((function(e){return e.key===o}))>n.findIndex((function(e){return e.key===r}))?"previous":"next"}))),Object(s.a)(this.slideableRef.nativeElement,"animationend").pipe(Object(A.a)((function(e){return"move-next"===e.animationName||"move-previous"===e.animationName})),Object(_.a)((function(){return""})),Object(w.a)(0))))},e.prototype.languageChangeSubscribe=function(){var e=this;this.subscriptions.push(this.languageInstanceService.getCurrentLanguage(this.formId).subscribe((function(t){e.formErrors=[]})))},e.prototype.dialogBackdropClickSubscribe=function(){var e=this;this.subscriptions.push(Object(s.a)(window,"beforeunload").subscribe((function(t){e.dialogRef.disableClose&&(t.preventDefault(),t.returnValue="",e.snackBarYouHaveUnsavedChanges())}))),this.dialogRef.backdropClick().subscribe((function(t){e.closeDialog()})),this.dialogRef.keydownEvents().subscribe((function(t){27===t.keyCode?e.closeDialog():(navigator.platform.match("Mac")?t.metaKey:t.ctrlKey)&&83===t.keyCode&&(t.preventDefault(),e.saveAll(!1))}))},e.prototype.saveFormMessagesSubscribe=function(){var e=this;this.subscriptions.push(this.actions$.pipe(Object(a.e)(Q.c)).subscribe((function(t){e.itemService.updateItemId(t.data),Object(R.a)("success END: ",t.data),e.snackBar.open(e.translate.instant("Message.Saved"),null,{duration:2e3}),e.dialogRef.disableClose=!1,e.formIsSaved&&e.closeDialog(t.data)}))),this.subscriptions.push(this.actions$.pipe(Object(a.e)(Q.b)).subscribe((function(t){Object(R.a)("error END",t.error),e.snackBar.open("Error",null,{duration:2e3})})))},e.prototype.formSetValueChangeSubscribe=function(){var e=this;this.subscriptions.push(this.eavService.formValueChange$.pipe(Object(A.a)((function(t){return t.formId===e.formId}))).subscribe((function(t){e.checkFormsState()})))},e.prototype.checkFormsState=function(){var e,t,n=this;if((null===(e=this.itemEditFormRefs)||void 0===e?void 0:e.length)>0&&(null===(t=this.itemEditFormRefs)||void 0===t?void 0:t.first.currentLanguage)){var i=!0,a=!0;this.formsAreDirty[this.itemEditFormRefs.first.currentLanguage]=!1,this.itemEditFormRefs.forEach((function(e){!0!==e.form.form.invalid||e.item.header.Group&&!1!==e.item.header.Group.SlotCanBeEmpty||(i=!1),e.form.form.dirty&&(n.formsAreDirty[e.currentLanguage]=!0),e.checkAreAllControlsDisabled()||(a=!1)})),this.formsAreValid$.value!==i&&this.formsAreValid$.next(i),this.allControlsAreDisabled$.value!==a&&this.allControlsAreDisabled$.next(a)}this.dialogRef.disableClose=this.areFormsDirtyAnyLanguage()},e.prototype.areFormsDirtyAnyLanguage=function(){var e,t,n=!1,a=Object.keys(this.formsAreDirty);try{for(var o=Object(i.h)(a),r=o.next();!r.done;r=o.next())if(!0===this.formsAreDirty[r.value]){n=!0;break}}catch(s){e={error:s}}finally{try{r&&!r.done&&(t=o.return)&&t.call(o)}finally{if(e)throw e.error}}return n},e.prototype.calculateAllValidationMessages=function(){var e,t=this;this.formErrors=[],null===(e=this.itemEditFormRefs)||void 0===e||e.forEach((function(e){e.form.form.invalid&&t.formErrors.push(t.validationMessagesService.validateForm(e.form.form,!1))}))},e.prototype.attachAllSaveFormObservables=function(){var e,t=this;0===this.formSaveAllObservables$.length&&(null===(e=this.itemEditFormRefs)||void 0===e||e.forEach((function(e){t.formSaveAllObservables$.push(e.formSaveObservable())})),this.formSaveAllObservables$.length>0&&(this.saveFormSubscribe(),this.checkFormsState()))},e.prototype.saveFormSubscribe=function(){var e=this;this.subscriptions.push(m.apply(void 0,Object(i.g)(this.formSaveAllObservables$)).pipe(Object(P.a)((function(t){Object(R.a)("ZIP ACTIONS ITEM: ",Y.create(t[0].item));var n=[];return t.forEach((function(e){var t=Y.create(e.item);Object.keys(t.Entity.Attributes).length>0&&n.push(t)})),e.eavService.saveFormData(JSON.stringify({Items:n,IsPublished:e.publishMode$.value===se.Show,DraftShouldBranch:e.publishMode$.value===se.Branch})).pipe(Object(_.a)((function(t){e.eavService.saveItemSuccess(t)})),Object(M.a)((function(e){return Object(R.a)("working")})))})),Object(D.a)((function(t){return Object(O.a)(e.eavService.saveItemError(t))}))).subscribe())},e.prototype.snackBarYouHaveUnsavedChanges=function(){var e=this,t=this.snackBar.openFromComponent(G,{data:{save:!1},duration:5e3});t.onAction().subscribe((function(){t.containerInstance.snackBarConfig.data.save?e.saveAll(!0):(e.dialogRef.disableClose=!1,e.closeDialog())}))},e.\u0275fac=function(t){return new(t||e)(B.Mb(le.g),B.Mb(a.a),B.Mb(B.h),B.Mb(ue.a),B.Mb(ne.a),B.Mb(he.a),B.Mb(ie.a),B.Mb(de.a),B.Mb(fe.a),B.Mb(te.a),B.Mb(ge.a),B.Mb(ee.a),B.Mb(E.b),B.Mb(T.e),B.Mb(be.a),B.Mb(pe.a),B.Mb(me.a),B.Mb(ve.a),B.Mb(ye.a))},e.\u0275cmp=B.Gb({type:e,selectors:[["app-multi-item-edit-form"]],viewQuery:function(e,t){var n;1&e&&(B.Tc(Ye,!0),B.Tc(re,!0)),2&e&&(B.xc(n=B.bc())&&(t.slideableRef=n.first),B.xc(n=B.bc())&&(t.itemEditFormRefs=n))},decls:14,vars:38,consts:[[4,"ngIf"],["mat-dialog-container","","style","position: relative","appToggleDebug","",4,"ngIf"],["mat-dialog-container","","appToggleDebug","",2,"position","relative"],["mat-dialog-actions","",1,"form-header-container",3,"ngClass"],[1,"multi-item-edit-form-header",3,"formId","isCopy","formsAreValid","allControlsAreDisabled","isParentDialog","publishMode","closeDialog","setPublishMode"],[2,"position","relative"],["mat-dialog-content","",1,"u-hide-scrollbar",3,"ngClass"],[1,"mdc-layout-grid"],[1,"mdc-layout-grid__inner"],[1,"mdc-layout-grid__cell--span-12",3,"ngClass"],["slideable",""],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"c-multi-item-dialog__save-container"],[1,"c-multi-item-dialog__save-button"],["mat-fab","",1,"mat-elevation-z24",3,"matTooltip","ngClass","click"],["mat-dialog-actions","",3,"debugInfoOpened",4,"ngIf"],[3,"item","formId","enableHistory","itemFormValueChange"],["mat-dialog-actions","",3,"debugInfoOpened"]],template:function(e,t){1&e&&(B.Nb(0,"router-outlet"),B.Mc(1,tt,2,1,"ng-container",0),B.fc(2,"async"),B.fc(3,"async"),B.fc(4,"async"),B.fc(5,"async"),B.fc(6,"async"),B.fc(7,"async"),B.fc(8,"async"),B.fc(9,"async"),B.fc(10,"async"),B.fc(11,"async"),B.fc(12,"async"),B.fc(13,"async")),2&e&&(B.Ab(1),B.kc("ngIf",B.wc(25,nt,[B.gc(2,1,t.items$),B.gc(3,3,t.isCopy$),B.gc(4,5,t.enableHistory$),B.gc(5,7,t.formsAreValid$),B.gc(6,9,t.allControlsAreDisabled$),B.gc(7,11,t.publishMode$),B.gc(8,13,t.reduceSaveButton$),B.gc(9,15,t.debugEnabled$),B.gc(10,17,t.debugInfoIsOpen$),B.gc(11,19,t.hideHeader$),B.gc(12,21,t.slide$),B.gc(13,23,t.eavConfigLoaded$)])))},directives:[me.e,$.t,Se.a,le.c,$.q,xe.a,Ge,le.e,$.s,H.b,_e.a,Me.a,re,Ue],pipes:[$.b,T.d],styles:["@-webkit-keyframes move-next{0%{transform:translateX(0)}49%{transform:translateX(-800px);-webkit-animation-timing-function:step-end;animation-timing-function:step-end}50%{transform:translate(800px);-webkit-animation-timing-function:ease-out;animation-timing-function:ease-out}to{transform:translateX(0)}}@keyframes move-next{0%{transform:translateX(0)}49%{transform:translateX(-800px);-webkit-animation-timing-function:step-end;animation-timing-function:step-end}50%{transform:translate(800px);-webkit-animation-timing-function:ease-out;animation-timing-function:ease-out}to{transform:translateX(0)}}@-webkit-keyframes move-previous{0%{transform:translateX(0)}49%{transform:translateX(800px);-webkit-animation-timing-function:step-end;animation-timing-function:step-end}50%{transform:translate(-800px);-webkit-animation-timing-function:ease-out;animation-timing-function:ease-out}to{transform:translateX(0)}}@keyframes move-previous{0%{transform:translateX(0)}49%{transform:translateX(800px);-webkit-animation-timing-function:step-end;animation-timing-function:step-end}50%{transform:translate(-800px);-webkit-animation-timing-function:ease-out;animation-timing-function:ease-out}to{transform:translateX(0)}}.next[_ngcontent-%COMP%]{-webkit-animation:move-next .2s ease-in;animation:move-next .2s ease-in}.previous[_ngcontent-%COMP%]{-webkit-animation:move-previous .2s ease-in;animation:move-previous .2s ease-in}.multi-item-edit-form-header[_ngcontent-%COMP%]{width:100%}.mat-dialog-content[_ngcontent-%COMP%]{margin:0;padding:0;max-height:calc(100vh - 24px - 52px - 24px)}@media (max-width:600px){.mat-dialog-content[_ngcontent-%COMP%]{max-height:calc(100vh - 52px)}}.mat-dialog-content.hide-header-height-fix[_ngcontent-%COMP%]{max-height:calc(calc(100vh - 24px - 52px - 24px) + 52px)!important}@media (max-width:600px){.mat-dialog-content.hide-header-height-fix[_ngcontent-%COMP%]{max-height:calc(calc(100vh - 52px) + 52px)!important}}.mat-dialog-content.debug-enabled[_ngcontent-%COMP%]{max-height:calc(100vh - 24px - 52px - 52px - 24px)}@media (max-width:600px){.mat-dialog-content.debug-enabled[_ngcontent-%COMP%]{max-height:calc(100vh - 52px - 52px)}}.mat-dialog-content.debug-enabled.hide-header-height-fix[_ngcontent-%COMP%]{max-height:calc(calc(100vh - 24px - 52px - 52px - 24px) + 52px)!important}@media (max-width:600px){.mat-dialog-content.debug-enabled.hide-header-height-fix[_ngcontent-%COMP%]{max-height:calc(calc(100vh - 52px - 52px) + 52px)!important}}.mat-dialog-content.debug-enabled.debug-info-is-open[_ngcontent-%COMP%]{max-height:calc(calc(100vh - 24px - 52px - 52px - 24px) - calc(300px + 16px))}@media (max-width:600px){.mat-dialog-content.debug-enabled.debug-info-is-open[_ngcontent-%COMP%]{max-height:calc(calc(100vh - 52px - 52px) - calc(300px + 16px))}}.mat-dialog-content.debug-enabled.debug-info-is-open.hide-header-height-fix[_ngcontent-%COMP%]{max-height:calc(calc(100vh - 24px - 52px - 52px - 24px) - calc(300px + 16px) + 52px)!important}@media (max-width:600px){.mat-dialog-content.debug-enabled.debug-info-is-open.hide-header-height-fix[_ngcontent-%COMP%]{max-height:calc(calc(100vh - 52px - 52px) - calc(300px + 16px) + 52px)!important}}.mat-dialog-actions[_ngcontent-%COMP%]{padding:0;margin-bottom:0;z-index:1}.c-multi-item-dialog__save-container[_ngcontent-%COMP%]{z-index:1;position:absolute;bottom:14px;right:24px}@media (max-width:600px){.c-multi-item-dialog__save-container[_ngcontent-%COMP%]{bottom:4px}}.c-multi-item-dialog__save-button[_ngcontent-%COMP%]   .mat-fab[_ngcontent-%COMP%]{border-radius:16px 0;overflow:hidden}.c-multi-item-dialog__save-button[_ngcontent-%COMP%]   .mat-fab[_ngcontent-%COMP%]    .mat-button-wrapper{padding:0;font-size:14px;height:20px;line-height:20px}.c-multi-item-dialog__save-button[_ngcontent-%COMP%]   .mat-fab[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{font-size:20px;width:20px;height:20px;line-height:20px}.c-multi-item-dialog__save-button[_ngcontent-%COMP%]   .mat-fab--compact[_ngcontent-%COMP%]{height:48px;width:48px;transition:width 1s}@media (max-width:600px){.c-multi-item-dialog__save-button[_ngcontent-%COMP%]   .mat-fab--compact[_ngcontent-%COMP%]{height:42px;width:42px}}.c-multi-item-dialog__save-button[_ngcontent-%COMP%]   .mat-fab--extended[_ngcontent-%COMP%]{height:48px;width:200px;transition:width 1s}@media (max-width:600px){.c-multi-item-dialog__save-button[_ngcontent-%COMP%]   .mat-fab--extended[_ngcontent-%COMP%]{height:42px;width:170px}}.c-multi-item-dialog__save-button[_ngcontent-%COMP%]   .mat-fab--disabled[_ngcontent-%COMP%]{color:rgba(0,0,0,.26);background-color:rgba(29,39,61,.12)}.mdc-layout-grid[_ngcontent-%COMP%]{padding:16px}@media (max-width:600px){.mdc-layout-grid[_ngcontent-%COMP%]{padding:8px 0 0}}"],changeDetection:0}),e}()}}]);
//# sourceMappingURL=https://sources.2sxc.org/11.11.04/ng-edit/multi-item-edit-form-component.d63f5d5fa7dc4a5c302f.js.map