"use strict";(self.webpackChunkeav_ui=self.webpackChunkeav_ui||[]).push([["projects_eav-ui_src_app_content-items_content-item-import_content-item-import_component_ts"],{3603:(C,m,i)=>{i.r(m),i.d(m,{ContentItemImportComponent:()=>h});var l=i(5758),g=i(8812),f=i(3184),p=i(9262);let h=(()=>{class e{constructor(s,_){var r,d,c,D;null!==(r=s.title)&&void 0!==r||(s.title="Import Single Item"),null!==(d=s.description)&&void 0!==d||(s.description="Select an item file (json) from your computer to import."),null!==(c=s.allowedFileTypes)&&void 0!==c||(s.allowedFileTypes="json"),null!==(D=s.upload$)&&void 0!==D||(s.upload$=T=>_.importItem(T[0]))}}return e.\u0275fac=function(s){return new(s||e)(f.Y36(l.WI),f.Y36(g.l))},e.\u0275cmp=f.Xpm({type:e,selectors:[["app-content-item-import"]],decls:1,vars:0,template:function(s,_){1&s&&f._UZ(0,"app-file-upload-dialog")},directives:[p.U],styles:[""]}),e})()},9262:(C,m,i)=>{i.d(m,{U:()=>Z});var l=i(5758),g=i(6317),f=i(9295),p=i(5904),h=i(2305),e=i(3184),v=i(2528),s=i(6362),_=i(5982),r=i(4742),d=i(7317),c=i(6190),D=i(1555);function T(n,a){1&n&&e._UZ(0,"mat-spinner",13)}function x(n,a){1&n&&(e.TgZ(0,"div"),e._uU(1,"Select or drop file"),e.qZA())}function E(n,a){if(1&n&&(e.TgZ(0,"div"),e._uU(1),e.qZA()),2&n){const t=a.$implicit;e.xp6(1),e.Oqu(t.name)}}function U(n,a){1&n&&(e.TgZ(0,"div",18),e._uU(1," Upload succeeded. See the messages below for more information. "),e.qZA())}function O(n,a){1&n&&(e.TgZ(0,"div",19),e._uU(1," Upload failed. See the messages below for more information. "),e.qZA())}const M=function(n,a,t){return{"sxc-message-warning":n,"sxc-message-success":a,"sxc-message-error":t}};function y(n,a){if(1&n&&(e.TgZ(0,"div",20),e._uU(1),e.qZA()),2&n){const t=a.$implicit,o=e.oxw(3);e.Q6J("ngClass",e.kEZ(2,M,t.MessageType===o.FileUploadMessageTypes.Warning,t.MessageType===o.FileUploadMessageTypes.Success,t.MessageType===o.FileUploadMessageTypes.Error)),e.xp6(1),e.hij(" ",t.Text," ")}}function I(n,a){if(1&n&&(e.TgZ(0,"div",14),e.YNc(1,U,2,0,"div",15),e.YNc(2,O,2,0,"div",16),e.YNc(3,y,2,6,"div",17),e.qZA()),2&n){const t=e.oxw().ngIf;e.xp6(1),e.Q6J("ngIf",t.result.Success),e.xp6(1),e.Q6J("ngIf",!t.result.Success),e.xp6(1),e.Q6J("ngForOf",t.result.Messages)}}function A(n,a){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"button",21),e.NdJ("click",function(){return e.CHM(t),e.oxw(2).closeDialog()}),e._uU(2,"Cancel"),e.qZA(),e.TgZ(3,"button",22),e.NdJ("click",function(){return e.CHM(t),e.oxw(2).upload()}),e._uU(4," Upload "),e.qZA(),e.BQk()}if(2&n){const t=e.oxw().ngIf;e.xp6(3),e.Q6J("disabled",!t.files.length||t.uploading||!!t.result)}}function P(n,a){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"button",23),e.NdJ("click",function(){return e.CHM(t),e.oxw(2).closeDialog(!0)}),e._uU(2,"Close"),e.qZA(),e.BQk()}}function F(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"div",1),e.NdJ("filesDropped",function(u){return e.CHM(t),e.oxw().filesDropped(u)}),e.TgZ(1,"div",2),e._UZ(2,"div",3),e.ALo(3,"safeHtml"),e.qZA(),e.YNc(4,T,1,0,"mat-spinner",4),e._UZ(5,"p",5),e.ALo(6,"safeHtml"),e.TgZ(7,"div")(8,"button",6),e.NdJ("click",function(){return e.CHM(t),e.MAs(12).click()}),e.YNc(9,x,2,0,"div",7),e.YNc(10,E,2,1,"div",8),e.qZA(),e.TgZ(11,"input",9,10),e.NdJ("change",function(u){return e.CHM(t),e.oxw().filesChanged(u)}),e.qZA()(),e.YNc(13,I,4,3,"div",11),e.TgZ(14,"div",12),e.YNc(15,A,5,1,"ng-container",7),e.YNc(16,P,3,0,"ng-container",7),e.qZA()()}if(2&n){const t=a.ngIf,o=e.oxw();e.Q6J("allowedFileTypes",o.dialogData.allowedFileTypes),e.xp6(2),e.Q6J("innerHtml",e.lcZ(3,10,o.dialogData.title),e.oJD),e.xp6(2),e.Q6J("ngIf",t.uploading),e.xp6(1),e.Q6J("innerHtml",e.lcZ(6,12,o.dialogData.description),e.oJD),e.xp6(3),e.Q6J("disabled",t.uploading),e.xp6(1),e.Q6J("ngIf",!t.files.length),e.xp6(1),e.Q6J("ngForOf",t.files),e.xp6(3),e.Q6J("ngIf",t.result),e.xp6(2),e.Q6J("ngIf",!(null!=t.result&&t.result.Success)),e.xp6(1),e.Q6J("ngIf",null==t.result?null:t.result.Success)}}const L=function(n,a,t){return{uploading:n,files:a,result:t}};let Z=(()=>{class n extends p.f{constructor(t,o,u){super(),this.dialogData=t,this.dialogRef=o,this.snackBar=u,this.hostClass="dialog-component",this.uploading$=new g.X(!1),this.files$=new g.X([]),this.result$=new g.X(void 0),this.FileUploadMessageTypes=h.D}ngOnInit(){this.subscription.add(this.files$.subscribe(()=>{void 0!==this.result$.value&&this.result$.next(void 0)})),null!=this.dialogData.files&&this.filesDropped(this.dialogData.files)}ngOnDestroy(){this.uploading$.complete(),this.files$.complete(),this.result$.complete(),super.ngOnDestroy()}closeDialog(t){this.dialogRef.close(t)}filesDropped(t){this.setFiles(t),this.upload()}filesChanged(t){const u=Array.from(t.target.files);this.setFiles(u)}upload(){this.uploading$.next(!0),this.subscription.add(this.dialogData.upload$(this.files$.value).pipe((0,f.q)(1)).subscribe({next:t=>{this.uploading$.next(!1),this.result$.next(t)},error:()=>{this.uploading$.next(!1),this.result$.next(void 0),this.snackBar.open("Upload failed. Please check console for more information",void 0,{duration:3e3})}}))}setFiles(t){this.dialogData.multiple||(t=t.slice(0,1)),this.files$.next(t)}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(l.WI),e.Y36(l.so),e.Y36(v.ux))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-file-upload-dialog"]],hostVars:1,hostBindings:function(t,o){2&t&&e.Ikx("className",o.hostClass)},features:[e.qOj],decls:4,vars:11,consts:[["appDragAndDrop","",3,"allowedFileTypes","filesDropped",4,"ngIf"],["appDragAndDrop","",3,"allowedFileTypes","filesDropped"],["mat-dialog-title",""],[1,"dialog-title-box",3,"innerHtml"],["mode","indeterminate","diameter","20","color","accent",4,"ngIf"],[1,"dialog-description",3,"innerHtml"],["mat-raised-button","","tippy","Open file browser",3,"disabled","click"],[4,"ngIf"],[4,"ngFor","ngForOf"],["type","file","multiple","",1,"hide",3,"change"],["fileInput",""],["class","dialog-component-content fancy-scrollbar-light result-container",4,"ngIf"],[1,"dialog-component-actions"],["mode","indeterminate","diameter","20","color","accent"],[1,"dialog-component-content","fancy-scrollbar-light","result-container"],["class","sxc-message sxc-message-info",4,"ngIf"],["class","sxc-message sxc-message-error",4,"ngIf"],["class","sxc-message",3,"ngClass",4,"ngFor","ngForOf"],[1,"sxc-message","sxc-message-info"],[1,"sxc-message","sxc-message-error"],[1,"sxc-message",3,"ngClass"],["mat-raised-button","",3,"click"],["mat-raised-button","","color","accent",3,"disabled","click"],["mat-raised-button","","color","accent",3,"click"]],template:function(t,o){1&t&&(e.YNc(0,F,17,14,"div",0),e.ALo(1,"async"),e.ALo(2,"async"),e.ALo(3,"async")),2&t&&e.Q6J("ngIf",e.kEZ(7,L,e.lcZ(1,1,o.uploading$),e.lcZ(2,3,o.files$),e.lcZ(3,5,o.result$)))},directives:[s.O5,_.z,l.uh,r.Ou,d.lW,c.$,s.sg,s.mk],pipes:[s.Ov,D.z],styles:[".result-container[_ngcontent-%COMP%]{margin-top:16px}"]}),n})()},2305:(C,m,i)=>{i.d(m,{D:()=>l});const l={Warning:0,Success:1,Error:2}},5982:(C,m,i)=>{i.d(m,{z:()=>h});var l=i(3184),g=i(3280),f=i(5904),p=i(2528);let h=(()=>{class e extends f.f{constructor(s,_,r){super(),this.zone=_,this.snackBar=r,this.markStyle="outline",this.allowedFileTypes="",this.filesDropped=new l.vpe,this.dropAreaClass="eav-droparea",this.dragClass="eav-dragover",this.timeouts=[],this.element=s.nativeElement}ngOnInit(){this.markStyleClass=`eav-droparea-${this.markStyle}`,this.element.classList.add(this.dropAreaClass,this.markStyleClass),this.zone.runOutsideAngular(()=>{this.subscription.add((0,g.R)(this.element,"dragover").subscribe(s=>{s.preventDefault(),s.stopPropagation(),this.clearTimeouts(),this.element.classList.add(this.dragClass)})),this.subscription.add((0,g.R)(this.element,"dragleave").subscribe(s=>{s.preventDefault(),s.stopPropagation(),this.timeouts.push(window.setTimeout(()=>{this.element.classList.remove(this.dragClass)},50))}))})}ngOnDestroy(){this.clearTimeouts(),this.element.classList.remove(this.dropAreaClass,this.markStyleClass,this.dragClass),super.ngOnDestroy()}onDrop(s){s.preventDefault(),s.stopPropagation(),this.clearTimeouts(),this.element.classList.remove(this.dragClass);let r=Array.from(s.dataTransfer.files);r=this.filterTypes(r,this.allowedFileTypes),r.length>0&&this.filesDropped.emit(r)}clearTimeouts(){for(const s of this.timeouts)clearTimeout(s);this.timeouts=[]}filterTypes(s,_){if(""===_)return s;const r=_.split(",").map(c=>c.toLocaleLowerCase()),d=s.filter(c=>{const D=c.name.lastIndexOf(".");if(D<=0)return!1;const T=c.name.substring(D+1).toLocaleLowerCase();return r.includes(T)});if(s.length!==d.length){const c=this.allowedFileTypes.replace(/\,/g,", ");this.snackBar.open(d.length?"Some files were filtered out. This drop location only accepts file types: "+c:"This drop location only accepts file types: "+c,null,{duration:5e3})}return d}}return e.\u0275fac=function(s){return new(s||e)(l.Y36(l.SBq),l.Y36(l.R0b),l.Y36(p.ux))},e.\u0275dir=l.lG2({type:e,selectors:[["","appDragAndDrop",""]],hostBindings:function(s,_){1&s&&l.NdJ("drop",function(d){return _.onDrop(d)})},inputs:{markStyle:"markStyle",allowedFileTypes:"allowedFileTypes"},outputs:{filesDropped:"filesDropped"},features:[l.qOj]}),e})()},1555:(C,m,i)=>{i.d(m,{z:()=>f});var l=i(3184),g=i(318);let f=(()=>{class p{constructor(e){this.sanitizer=e}transform(e){return this.sanitizer.bypassSecurityTrustHtml(e)}}return p.\u0275fac=function(e){return new(e||p)(l.Y36(g.H7,16))},p.\u0275pipe=l.Yjl({name:"safeHtml",type:p,pure:!0}),p})()}}]);
//# sourceMappingURL=https://sources.2sxc.org/15.02.00/ng-edit/projects_eav-ui_src_app_content-items_content-item-import_content-item-import_component_ts.800a6f29ff9b9437.js.map