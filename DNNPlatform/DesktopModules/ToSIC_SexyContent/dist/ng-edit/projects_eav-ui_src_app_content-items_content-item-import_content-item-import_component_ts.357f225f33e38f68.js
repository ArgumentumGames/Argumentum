"use strict";(self.webpackChunkeav_ui=self.webpackChunkeav_ui||[]).push([["projects_eav-ui_src_app_content-items_content-item-import_content-item-import_component_ts"],{3603:(C,g,n)=>{n.r(g),n.d(g,{ContentItemImportComponent:()=>h});var a=n(5758),D=n(8812),p=n(3184),d=n(9262);let h=(()=>{class e{constructor(i,c){var r,u,_,f;null!==(r=i.title)&&void 0!==r||(i.title="Import Single Item"),null!==(u=i.description)&&void 0!==u||(i.description="Select an item file (json) from your computer to import."),null!==(_=i.allowedFileTypes)&&void 0!==_||(i.allowedFileTypes="json"),null!==(f=i.upload$)&&void 0!==f||(i.upload$=T=>c.importItem(T[0]))}}return e.\u0275fac=function(i){return new(i||e)(p.Y36(a.WI),p.Y36(D.l))},e.\u0275cmp=p.Xpm({type:e,selectors:[["app-content-item-import"]],decls:1,vars:0,template:function(i,c){1&i&&p._UZ(0,"app-file-upload-dialog")},directives:[d.U],styles:[""]}),e})()},9262:(C,g,n)=>{n.d(g,{U:()=>Z});var a=n(5758),D=n(6317),p=n(7714),d=n(9295),h=n(2305),e=n(3184),v=n(2528),i=n(6362),c=n(5982),r=n(4742),u=n(7317),_=n(6190),f=n(1555);function T(s,l){1&s&&e._UZ(0,"mat-spinner",13)}function x(s,l){1&s&&(e.TgZ(0,"div"),e._uU(1,"Select or drop file"),e.qZA())}function E(s,l){if(1&s&&(e.TgZ(0,"div"),e._uU(1),e.qZA()),2&s){const t=l.$implicit;e.xp6(1),e.Oqu(t.name)}}function U(s,l){1&s&&(e.TgZ(0,"div",18),e._uU(1," Upload succeeded. See the messages below for more information. "),e.qZA())}function M(s,l){1&s&&(e.TgZ(0,"div",19),e._uU(1," Upload failed. See the messages below for more information. "),e.qZA())}const O=function(s,l,t){return{"sxc-message-warning":s,"sxc-message-success":l,"sxc-message-error":t}};function I(s,l){if(1&s&&(e.TgZ(0,"div",20),e._uU(1),e.qZA()),2&s){const t=l.$implicit,o=e.oxw(3);e.Q6J("ngClass",e.kEZ(2,O,t.MessageType===o.FileUploadMessageTypes.Warning,t.MessageType===o.FileUploadMessageTypes.Success,t.MessageType===o.FileUploadMessageTypes.Error)),e.xp6(1),e.hij(" ",t.Text," ")}}function y(s,l){if(1&s&&(e.TgZ(0,"div",14),e.YNc(1,U,2,0,"div",15),e.YNc(2,M,2,0,"div",16),e.YNc(3,I,2,6,"div",17),e.qZA()),2&s){const t=e.oxw().ngIf;e.xp6(1),e.Q6J("ngIf",t.result.Success),e.xp6(1),e.Q6J("ngIf",!t.result.Success),e.xp6(1),e.Q6J("ngForOf",t.result.Messages)}}function A(s,l){if(1&s){const t=e.EpF();e.ynx(0),e.TgZ(1,"button",21),e.NdJ("click",function(){return e.CHM(t),e.oxw(2).closeDialog()}),e._uU(2,"Cancel"),e.qZA(),e.TgZ(3,"button",22),e.NdJ("click",function(){return e.CHM(t),e.oxw(2).upload()}),e._uU(4," Upload "),e.qZA(),e.BQk()}if(2&s){const t=e.oxw().ngIf;e.xp6(3),e.Q6J("disabled",!t.files.length||t.uploading||!!t.result)}}function P(s,l){if(1&s){const t=e.EpF();e.ynx(0),e.TgZ(1,"button",23),e.NdJ("click",function(){return e.CHM(t),e.oxw(2).closeDialog(!0)}),e._uU(2,"Close"),e.qZA(),e.BQk()}}function F(s,l){if(1&s){const t=e.EpF();e.TgZ(0,"div",1),e.NdJ("filesDropped",function(m){return e.CHM(t),e.oxw().filesDropped(m)}),e.TgZ(1,"div",2),e._UZ(2,"div",3),e.ALo(3,"safeHtml"),e.qZA(),e.YNc(4,T,1,0,"mat-spinner",4),e._UZ(5,"p",5),e.ALo(6,"safeHtml"),e.TgZ(7,"div")(8,"button",6),e.NdJ("click",function(){return e.CHM(t),e.MAs(12).click()}),e.YNc(9,x,2,0,"div",7),e.YNc(10,E,2,1,"div",8),e.qZA(),e.TgZ(11,"input",9,10),e.NdJ("change",function(m){return e.CHM(t),e.oxw().filesChanged(m)}),e.qZA()(),e.YNc(13,y,4,3,"div",11),e.TgZ(14,"div",12),e.YNc(15,A,5,1,"ng-container",7),e.YNc(16,P,3,0,"ng-container",7),e.qZA()()}if(2&s){const t=l.ngIf,o=e.oxw();e.Q6J("allowedFileTypes",o.dialogData.allowedFileTypes),e.xp6(2),e.Q6J("innerHtml",e.lcZ(3,10,o.dialogData.title),e.oJD),e.xp6(2),e.Q6J("ngIf",t.uploading),e.xp6(1),e.Q6J("innerHtml",e.lcZ(6,12,o.dialogData.description),e.oJD),e.xp6(3),e.Q6J("disabled",t.uploading),e.xp6(1),e.Q6J("ngIf",!t.files.length),e.xp6(1),e.Q6J("ngForOf",t.files),e.xp6(3),e.Q6J("ngIf",t.result),e.xp6(2),e.Q6J("ngIf",!(null!=t.result&&t.result.Success)),e.xp6(1),e.Q6J("ngIf",null==t.result?null:t.result.Success)}}const L=function(s,l,t){return{uploading:s,files:l,result:t}};let Z=(()=>{class s{constructor(t,o,m){this.dialogData=t,this.dialogRef=o,this.snackBar=m,this.hostClass="dialog-component",this.uploading$=new D.X(!1),this.files$=new D.X([]),this.result$=new D.X(void 0),this.FileUploadMessageTypes=h.D,this.subscription=new p.w0}ngOnInit(){this.subscription.add(this.files$.subscribe(()=>{void 0!==this.result$.value&&this.result$.next(void 0)})),null!=this.dialogData.files&&this.filesDropped(this.dialogData.files)}ngOnDestroy(){this.uploading$.complete(),this.files$.complete(),this.result$.complete(),this.subscription.unsubscribe()}closeDialog(t){this.dialogRef.close(t)}filesDropped(t){this.setFiles(t),this.upload()}filesChanged(t){const m=Array.from(t.target.files);this.setFiles(m)}upload(){this.uploading$.next(!0),this.subscription.add(this.dialogData.upload$(this.files$.value).pipe((0,d.q)(1)).subscribe({next:t=>{this.uploading$.next(!1),this.result$.next(t)},error:()=>{this.uploading$.next(!1),this.result$.next(void 0),this.snackBar.open("Upload failed. Please check console for more information",void 0,{duration:3e3})}}))}setFiles(t){this.dialogData.multiple||(t=t.slice(0,1)),this.files$.next(t)}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(a.WI),e.Y36(a.so),e.Y36(v.ux))},s.\u0275cmp=e.Xpm({type:s,selectors:[["app-file-upload-dialog"]],hostVars:1,hostBindings:function(t,o){2&t&&e.Ikx("className",o.hostClass)},decls:4,vars:11,consts:[["appDragAndDrop","",3,"allowedFileTypes","filesDropped",4,"ngIf"],["appDragAndDrop","",3,"allowedFileTypes","filesDropped"],["mat-dialog-title",""],[1,"dialog-title-box",3,"innerHtml"],["mode","indeterminate","diameter","20","color","accent",4,"ngIf"],[1,"dialog-description",3,"innerHtml"],["mat-raised-button","","tippy","Open file browser",3,"disabled","click"],[4,"ngIf"],[4,"ngFor","ngForOf"],["type","file","multiple","",1,"hide",3,"change"],["fileInput",""],["class","dialog-component-content fancy-scrollbar-light result-container",4,"ngIf"],[1,"dialog-component-actions"],["mode","indeterminate","diameter","20","color","accent"],[1,"dialog-component-content","fancy-scrollbar-light","result-container"],["class","sxc-message sxc-message-info",4,"ngIf"],["class","sxc-message sxc-message-error",4,"ngIf"],["class","sxc-message",3,"ngClass",4,"ngFor","ngForOf"],[1,"sxc-message","sxc-message-info"],[1,"sxc-message","sxc-message-error"],[1,"sxc-message",3,"ngClass"],["mat-raised-button","",3,"click"],["mat-raised-button","","color","accent",3,"disabled","click"],["mat-raised-button","","color","accent",3,"click"]],template:function(t,o){1&t&&(e.YNc(0,F,17,14,"div",0),e.ALo(1,"async"),e.ALo(2,"async"),e.ALo(3,"async")),2&t&&e.Q6J("ngIf",e.kEZ(7,L,e.lcZ(1,1,o.uploading$),e.lcZ(2,3,o.files$),e.lcZ(3,5,o.result$)))},directives:[i.O5,c.z,a.uh,r.Ou,u.lW,_.$,i.sg,i.mk],pipes:[i.Ov,f.z],styles:[".result-container[_ngcontent-%COMP%]{margin-top:16px}"]}),s})()},2305:(C,g,n)=>{n.d(g,{D:()=>a});const a={Warning:0,Success:1,Error:2}},5982:(C,g,n)=>{n.d(g,{z:()=>h});var a=n(3184),D=n(7714),p=n(3280),d=n(2528);let h=(()=>{class e{constructor(i,c,r){this.zone=c,this.snackBar=r,this.markStyle="outline",this.allowedFileTypes="",this.filesDropped=new a.vpe,this.dropAreaClass="eav-droparea",this.dragClass="eav-dragover",this.timeouts=[],this.subscription=new D.w0,this.element=i.nativeElement}ngOnInit(){this.markStyleClass=`eav-droparea-${this.markStyle}`,this.element.classList.add(this.dropAreaClass,this.markStyleClass),this.zone.runOutsideAngular(()=>{this.subscription.add((0,p.R)(this.element,"dragover").subscribe(i=>{i.preventDefault(),i.stopPropagation(),this.clearTimeouts(),this.element.classList.add(this.dragClass)})),this.subscription.add((0,p.R)(this.element,"dragleave").subscribe(i=>{i.preventDefault(),i.stopPropagation(),this.timeouts.push(window.setTimeout(()=>{this.element.classList.remove(this.dragClass)},50))}))})}ngOnDestroy(){this.clearTimeouts(),this.element.classList.remove(this.dropAreaClass,this.markStyleClass,this.dragClass),this.subscription.unsubscribe()}onDrop(i){i.preventDefault(),i.stopPropagation(),this.clearTimeouts(),this.element.classList.remove(this.dragClass);let r=Array.from(i.dataTransfer.files);r=this.filterTypes(r,this.allowedFileTypes),r.length>0&&this.filesDropped.emit(r)}clearTimeouts(){for(const i of this.timeouts)clearTimeout(i);this.timeouts=[]}filterTypes(i,c){if(""===c)return i;const r=c.split(",").map(_=>_.toLocaleLowerCase()),u=i.filter(_=>{const f=_.name.lastIndexOf(".");if(f<=0)return!1;const T=_.name.substring(f+1).toLocaleLowerCase();return r.includes(T)});if(i.length!==u.length){const _=this.allowedFileTypes.replace(/\,/g,", ");this.snackBar.open(u.length?"Some files were filtered out. This drop location only accepts file types: "+_:"This drop location only accepts file types: "+_,null,{duration:5e3})}return u}}return e.\u0275fac=function(i){return new(i||e)(a.Y36(a.SBq),a.Y36(a.R0b),a.Y36(d.ux))},e.\u0275dir=a.lG2({type:e,selectors:[["","appDragAndDrop",""]],hostBindings:function(i,c){1&i&&a.NdJ("drop",function(u){return c.onDrop(u)})},inputs:{markStyle:"markStyle",allowedFileTypes:"allowedFileTypes"},outputs:{filesDropped:"filesDropped"}}),e})()},1555:(C,g,n)=>{n.d(g,{z:()=>p});var a=n(3184),D=n(318);let p=(()=>{class d{constructor(e){this.sanitizer=e}transform(e){return this.sanitizer.bypassSecurityTrustHtml(e)}}return d.\u0275fac=function(e){return new(e||d)(a.Y36(D.H7,16))},d.\u0275pipe=a.Yjl({name:"safeHtml",type:d,pure:!0}),d})()}}]);
//# sourceMappingURL=https://sources.2sxc.org/14.12.03/ng-edit/projects_eav-ui_src_app_content-items_content-item-import_content-item-import_component_ts.357f225f33e38f68.js.map