"use strict";(self.webpackChunkng_dialogs=self.webpackChunkng_dialogs||[]).push([["projects_ng-dialogs_src_app_app-administration_sub-dialogs_export-app-parts_export-app-parts_-2e25cb","projects_ng-dialogs_src_app_shared_directives_click-stop-propagation_directive_ts"],{1882:(T,d,i)=>{i.r(d),i.d(d,{ExportAppPartsComponent:()=>R});var l=i(6317),x=i(6562),r=i(635),g=i(9670),a=i(1825),m=i(5005),u=i(1025),t=i(3184),E=i(5758),f=i(6362),h=i(4770),P=i(1434),C=i(587),v=i(1130),A=i(7317),M=i(785),O=i(5590),D=i(491),I=i(3135),Z=i(1534);function y(e,p){if(1&e&&(t.TgZ(0,"mat-option",10),t._uU(1),t.qZA()),2&e){const n=p.$implicit;t.Q6J("value",n.value),t.xp6(1),t.hij(" ",n.name," ")}}function U(e,p){if(1&e){const n=t.EpF();t.TgZ(0,"li",20)(1,"div",21)(2,"mat-checkbox",22),t.NdJ("ngModelChange",function(_){return t.CHM(n).$implicit._export=_}),t.TgZ(3,"span",23),t._uU(4),t.qZA()()()()}if(2&e){const n=p.$implicit;t.xp6(2),t.Q6J("ngModel",n._export),t.xp6(2),t.AsE("",n.Name," (",n.Id,")")}}function k(e,p){if(1&e&&(t.TgZ(0,"ul",25)(1,"p",26),t._uU(2,"Templates"),t.qZA(),t.YNc(3,U,5,3,"li",19),t.qZA()),2&e){const n=t.oxw().$implicit;t.xp6(3),t.Q6J("ngForOf",n.Templates)}}function S(e,p){if(1&e){const n=t.EpF();t.TgZ(0,"li",20)(1,"div",21)(2,"mat-checkbox",22),t.NdJ("ngModelChange",function(_){return t.CHM(n).$implicit._export=_}),t.TgZ(3,"span",23),t._uU(4),t.qZA()()()()}if(2&e){const n=p.$implicit;t.xp6(2),t.Q6J("ngModel",n._export),t.xp6(2),t.AsE("",n.Title," (",n.Id,")")}}function J(e,p){if(1&e&&(t.TgZ(0,"ul",25)(1,"p",26),t._uU(2,"Entities"),t.qZA(),t.YNc(3,S,5,3,"li",19),t.qZA()),2&e){const n=t.oxw().$implicit;t.xp6(3),t.Q6J("ngForOf",n.Entities)}}function b(e,p){if(1&e){const n=t.EpF();t.TgZ(0,"li",20)(1,"div",21)(2,"mat-checkbox",22),t.NdJ("ngModelChange",function(_){return t.CHM(n).$implicit._export=_}),t.TgZ(3,"span",23),t._uU(4),t.qZA()()(),t.YNc(5,k,4,1,"ul",24),t.YNc(6,J,4,1,"ul",24),t.qZA()}if(2&e){const n=p.$implicit;t.xp6(2),t.Q6J("ngModel",n._export),t.xp6(2),t.AsE("",n.Name," (",n.Id,")"),t.xp6(1),t.Q6J("ngIf",n.Templates.length>0),t.xp6(1),t.Q6J("ngIf",n.Entities.length>0)}}function B(e,p){if(1&e){const n=t.EpF();t.TgZ(0,"li",20)(1,"div",21)(2,"mat-checkbox",22),t.NdJ("ngModelChange",function(_){return t.CHM(n).$implicit._export=_}),t.TgZ(3,"span",23),t._uU(4),t.qZA()()()()}if(2&e){const n=p.$implicit;t.xp6(2),t.Q6J("ngModel",n._export),t.xp6(2),t.AsE("",n.Name," (",n.Id,")")}}function $(e,p){if(1&e&&(t.TgZ(0,"div")(1,"ul",17)(2,"p",18),t._uU(3,"Content Types"),t.qZA(),t.YNc(4,b,7,5,"li",19),t.qZA(),t.TgZ(5,"ul",17)(6,"p",18),t._uU(7,"Templates Without Content Types"),t.qZA(),t.YNc(8,B,5,3,"li",19),t.qZA()()),2&e){const n=t.oxw(2);t.xp6(4),t.Q6J("ngForOf",n.contentInfo.ContentTypes),t.xp6(4),t.Q6J("ngForOf",n.contentInfo.TemplatesWithoutContentTypes)}}function W(e,p){if(1&e){const n=t.EpF();t.ynx(0),t.TgZ(1,"div",1)(2,"div",2),t._uU(3,"Export Content and Templates from this App"),t.qZA()(),t.TgZ(4,"p",3),t._uU(5," This is an advanced feature to export parts of the app. The export will create an xml file which can be imported into another site or app. To export the entire content of the app (for example when duplicating the entire site), go to the app export. For further help visit "),t.TgZ(6,"a",4),t._uU(7,"2sxc Help"),t.qZA(),t._uU(8,". "),t.qZA(),t.TgZ(9,"div",5)(10,"div",6)(11,"mat-form-field",7)(12,"mat-label"),t._uU(13,"Scope"),t.qZA(),t.TgZ(14,"mat-select",8),t.NdJ("ngModelChange",function(_){return t.CHM(n),t.oxw().changeScope(_)}),t.YNc(15,y,2,2,"mat-option",9),t.TgZ(16,"mat-option",10),t._uU(17,"Other..."),t.qZA()(),t.TgZ(18,"button",11)(19,"mat-icon",12),t.NdJ("click",function(){return t.CHM(n),t.oxw().unlockScope()}),t._uU(20),t.qZA()()(),t.TgZ(21,"app-field-hint"),t._uU(22," The scope should almost never be changed - "),t.TgZ(23,"a",13),t._uU(24,"see help"),t.qZA()()(),t.YNc(25,$,9,2,"div",0),t.qZA(),t.TgZ(26,"div",14)(27,"button",15),t.NdJ("click",function(){return t.CHM(n),t.oxw().closeDialog()}),t._uU(28," Cancel "),t.qZA(),t.TgZ(29,"button",16),t.NdJ("click",function(){return t.CHM(n),t.oxw().exportAppParts()}),t._uU(30," Export "),t.qZA()(),t.BQk()}if(2&e){const n=p.ngIf,o=t.oxw();t.xp6(14),t.Q6J("ngModel",o.exportScope)("disabled",o.lockScope),t.xp6(1),t.Q6J("ngForOf",o.scopeOptions),t.xp6(1),t.Q6J("value",o.dropdownInsertValue),t.xp6(2),t.Q6J("tippy",o.lockScope?"Unlock":"Lock"),t.xp6(2),t.hij(" ",o.lockScope?"lock":"lock_open"," "),t.xp6(5),t.Q6J("ngIf",o.contentInfo),t.xp6(2),t.Q6J("disabled",n.loading||n.isExporting),t.xp6(2),t.Q6J("disabled",n.loading||n.isExporting)}}let R=(()=>{class e{constructor(n,o,_){this.dialogRef=n,this.exportAppPartsService=o,this.contentTypesService=_,this.hostClass="dialog-component",this.exportScope=a.Z.scopes.default.value,this.lockScope=!0,this.dropdownInsertValue=g.G,this.loading$=new l.X(!1),this.isExporting$=new l.X(!1),this.templateVars$=(0,x.a)([this.loading$,this.isExporting$]).pipe((0,r.U)(([s,c])=>({loading:s,isExporting:c})))}ngOnInit(){this.fetchScopes(),this.fetchContentInfo()}ngOnDestroy(){this.loading$.complete(),this.isExporting$.complete()}closeDialog(){this.dialogRef.close()}exportAppParts(){this.isExporting$.next(!0);const n=this.selectedContentTypes().map(s=>s.Id),o=this.selectedTemplates().map(s=>s.Id);let _=this.selectedEntities().map(s=>s.Id);_=_.concat(o),this.exportAppPartsService.exportParts(n,_,o),this.isExporting$.next(!1)}changeScope(n){n!==g.G||(n=prompt("This is an advanced feature to show content-types of another scope. Don't use this if you don't know what you're doing, as content-types of other scopes are usually hidden for a good reason.")||a.Z.scopes.default.value,this.scopeOptions.find(o=>o.value===n))||this.scopeOptions.unshift({name:n,value:n}),this.exportScope=n,this.fetchContentInfo()}unlockScope(){this.lockScope=!this.lockScope,this.lockScope&&(this.exportScope=a.Z.scopes.default.value,this.fetchContentInfo())}fetchScopes(){this.loading$.next(!0),this.contentTypesService.getScopes().subscribe(n=>{this.scopeOptions=n,this.loading$.next(!1)})}fetchContentInfo(){this.loading$.next(!0),this.exportAppPartsService.getContentInfo(this.exportScope).subscribe(n=>{this.contentInfo=n,this.loading$.next(!1)})}selectedContentTypes(){return this.contentInfo.ContentTypes.filter(n=>n._export)}selectedEntities(){let n=[];for(const o of this.contentInfo.ContentTypes)n=n.concat(o.Entities.filter(_=>_._export));return n}selectedTemplates(){let n=[];for(const o of this.contentInfo.ContentTypes)n=n.concat(o.Templates.filter(_=>_._export));return n=n.concat(this.contentInfo.TemplatesWithoutContentTypes.filter(o=>o._export)),n}}return e.\u0275fac=function(n){return new(n||e)(t.Y36(E.so),t.Y36(u.T),t.Y36(m.s))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-export-app-parts"]],hostVars:1,hostBindings:function(n,o){2&n&&t.Ikx("className",o.hostClass)},decls:2,vars:3,consts:[[4,"ngIf"],["mat-dialog-title",""],[1,"dialog-title-box"],[1,"dialog-description"],["href","https://2sxc.org/en/help?tag=export","target","_blank"],[1,"dialog-component-content","fancy-scrollbar-light"],[1,"edit-input"],["appearance","standard","color","accent"],["name","Scope",3,"ngModel","disabled","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["mat-icon-button","","matSuffix","",3,"tippy"],["appClickStopPropagation","",3,"click"],["appClickStopPropagation","","href","https://2sxc.org/help?tag=scope","target","_blank"],[1,"dialog-component-actions"],["mat-raised-button","",3,"disabled","click"],["mat-raised-button","","color","accent",3,"disabled","click"],[1,"content-info__list","content-info__base"],[1,"content-info__title"],["class","content-info__item",4,"ngFor","ngForOf"],[1,"content-info__item"],[1,"option-box"],[3,"ngModel","ngModelChange"],[1,"option-box__text"],["class","content-info__list",4,"ngIf"],[1,"content-info__list"],[1,"content-info__subtitle"]],template:function(n,o){1&n&&(t.YNc(0,W,31,9,"ng-container",0),t.ALo(1,"async")),2&n&&t.Q6J("ngIf",t.lcZ(1,1,o.templateVars$))},directives:[f.O5,E.uh,h.KE,h.hX,P.gD,C.JJ,C.On,f.sg,v.ey,A.lW,h.R9,M.$,O.Hw,D.E,I.Y,Z.oG],pipes:[f.Ov],styles:[".edit-input[_ngcontent-%COMP%]{padding-bottom:8px}.mat-hint[_ngcontent-%COMP%]{font-size:12px}.content-info__title[_ngcontent-%COMP%]{font-size:18px;font-weight:700}.content-info__subtitle[_ngcontent-%COMP%]{font-size:14px;font-weight:700}.content-info__list[_ngcontent-%COMP%]{font-size:14px;list-style-type:none}.content-info__base[_ngcontent-%COMP%]{padding:0}.content-info__item[_ngcontent-%COMP%]{border-top:1px solid #DDD;padding:2px}.option-box[_ngcontent-%COMP%]{margin:8px 0}.option-box__text[_ngcontent-%COMP%]{white-space:normal;font-size:14px}"]}),e})()},491:(T,d,i)=>{i.d(d,{E:()=>x});var l=i(3184);let x=(()=>{class r{onClick(a){a.stopPropagation()}}return r.\u0275fac=function(a){return new(a||r)},r.\u0275dir=l.lG2({type:r,selectors:[["","appClickStopPropagation",""]],hostBindings:function(a,m){1&a&&l.NdJ("click",function(t){return m.onClick(t)})}}),r})()}}]);
//# sourceMappingURL=https://sources.2sxc.org/13.06.00/ng-edit/projects_ng-dialogs_src_app_app-administration_sub-dialogs_export-app-parts_export-app-parts_-2e25cb.c5869175fe02a940.js.map