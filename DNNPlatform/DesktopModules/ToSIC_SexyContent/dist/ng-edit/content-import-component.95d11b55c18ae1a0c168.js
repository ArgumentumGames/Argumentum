(window.webpackJsonp=window.webpackJsonp||[]).push([[24],{SL64:function(e,t,n){"use strict";n.r(t),n.d(t,"ContentImportComponent",(function(){return N}));var i=n("D57K"),o=n("OZ4H"),a=n("C05f"),c=n("HM3f"),l=n("P4Xx"),s=n("YtkY"),r=n("EM62"),u=n("sEIs"),b=n("GX8n"),p=n("KoVM"),f=n("S36y"),g=n("2kYt"),d=n("8/3+"),m=n("nIj0"),v=n("PBFl"),S=n("Y2X+"),h=n("F1o0");function R(e,t){if(1&e){var n=r.Tb();r.Sb(0,"form",11,12),r.Sb(2,"div",13),r.Sb(3,"div"),r.Sb(4,"button",14),r.ac("click",(function(){return r.Ac(n),r.yc(8).click()})),r.Sb(5,"span"),r.Oc(6),r.Rb(),r.Rb(),r.Sb(7,"input",15,16),r.ac("change",(function(e){return r.Ac(n),r.ec(3).fileChange(e)})),r.Rb(),r.Rb(),r.Sb(9,"div"),r.Sb(10,"p",17),r.Oc(11,"References to pages / files"),r.Rb(),r.Sb(12,"mat-radio-group",18),r.ac("ngModelChange",(function(e){return r.Ac(n),r.ec(3).formValues.resourcesReferences=e})),r.Sb(13,"mat-radio-button",19),r.Oc(14," Import links as written in the file (for example /Portals/...) "),r.Rb(),r.Sb(15,"mat-radio-button",20),r.Oc(16," Try to resolve paths to references "),r.Rb(),r.Rb(),r.Rb(),r.Sb(17,"div"),r.Sb(18,"p",17),r.Oc(19,"Clear all other entities"),r.Rb(),r.Sb(20,"mat-radio-group",21),r.ac("ngModelChange",(function(e){return r.Ac(n),r.ec(3).formValues.clearEntities=e})),r.Sb(21,"mat-radio-button",22),r.Oc(22," Keep all entities not found in import "),r.Rb(),r.Sb(23,"mat-radio-button",23),r.Oc(24," Remove all entities not found in import "),r.Rb(),r.Rb(),r.Rb(),r.Sb(25,"p",24),r.Oc(26,"Remember to backup your DNN first!"),r.Rb(),r.Rb(),r.Sb(27,"div",25),r.Sb(28,"button",26),r.ac("click",(function(){return r.Ac(n),r.ec(3).closeDialog()})),r.Oc(29,"Cancel"),r.Rb(),r.Sb(30,"button",27),r.ac("click",(function(){return r.Ac(n),r.ec(3).evaluateContent()})),r.Oc(31," Preview Import "),r.Rb(),r.Rb(),r.Rb()}if(2&e){var i=r.ec(3);r.Ab(6),r.Pc(i.formValues.file?i.formValues.file.name:"Select or drop file"),r.Ab(6),r.kc("ngModel",i.formValues.resourcesReferences),r.Ab(8),r.kc("ngModel",i.formValues.clearEntities),r.Ab(10),r.kc("disabled",!i.formValues.file||!i.formValues.file.name)}}function O(e,t){1&e&&(r.Sb(0,"p",28),r.Oc(1,"Please wait while processing..."),r.Rb())}function w(e,t){if(1&e&&(r.Sb(0,"div",31),r.Sb(1,"p",32),r.Oc(2),r.Rb(),r.Sb(3,"p",32),r.Oc(4,"File contains:"),r.Rb(),r.Sb(5,"ul",33),r.Sb(6,"li"),r.Oc(7),r.Rb(),r.Sb(8,"li"),r.Oc(9),r.Rb(),r.Sb(10,"li"),r.Oc(11),r.Rb(),r.Rb(),r.Sb(12,"p",32),r.Oc(13,"If you press Import, it will:"),r.Rb(),r.Sb(14,"ul",33),r.Sb(15,"li"),r.Oc(16),r.Rb(),r.Sb(17,"li"),r.Oc(18),r.Rb(),r.Sb(19,"li"),r.Oc(20),r.Rb(),r.Sb(21,"li"),r.Oc(22),r.Rb(),r.Rb(),r.Sb(23,"p",24),r.Oc(24,"Note: The import validates much data and may take several minutes."),r.Rb(),r.Rb()),2&e){var n=r.ec(4).ngIf,i=r.ec();r.Ab(2),r.Qc("Try to import file '",i.formValues.file.name,"'"),r.Ab(5),r.Qc("",n.evaluationResult.Detail.DocumentElementsCount," content-items (records/entities)"),r.Ab(2),r.Qc("",n.evaluationResult.Detail.LanguagesInDocumentCount," languages"),r.Ab(2),r.Rc("",n.evaluationResult.Detail.AttributeNamesInDocument.length," columns: ",n.evaluationResult.Detail.AttributeNamesInDocument.join(", "),""),r.Ab(5),r.Qc("Create ",n.evaluationResult.Detail.AmountOfEntitiesCreated," content-items"),r.Ab(2),r.Qc("Update ",n.evaluationResult.Detail.AmountOfEntitiesUpdated," content-items"),r.Ab(2),r.Qc("Delete ",n.evaluationResult.Detail.AmountOfEntitiesDeleted," content-items"),r.Ab(2),r.Rc("Ignore ",n.evaluationResult.Detail.AttributeNamesNotImported.length," columns: ",n.evaluationResult.Detail.AttributeNamesNotImported.join(", "),"")}}function y(e,t){if(1&e&&(r.Sb(0,"div"),r.Sb(1,"i"),r.Oc(2),r.Rb(),r.Rb()),2&e){var n=r.ec().$implicit;r.Ab(2),r.Qc("Details: ",n.ErrorDetail,"")}}function A(e,t){if(1&e&&(r.Sb(0,"div"),r.Sb(1,"i"),r.Oc(2),r.Rb(),r.Rb()),2&e){var n=r.ec().$implicit;r.Ab(2),r.Qc("Line-no: ",n.LineNumber,"")}}function C(e,t){if(1&e&&(r.Sb(0,"div"),r.Sb(1,"i"),r.Oc(2),r.Rb(),r.Rb()),2&e){var n=r.ec().$implicit;r.Ab(2),r.Qc("Line-details: ",n.LineDetail,"")}}function I(e,t){if(1&e&&(r.Sb(0,"li"),r.Sb(1,"div"),r.Oc(2),r.Rb(),r.Mc(3,y,3,1,"div",6),r.Mc(4,A,3,1,"div",6),r.Mc(5,C,3,1,"div",6),r.Rb()),2&e){var n=t.$implicit,i=r.ec(6);r.Ab(2),r.Pc(i.errors[n.ErrorCode]),r.Ab(1),r.kc("ngIf",n.ErrorDetail),r.Ab(1),r.kc("ngIf",n.LineNumber),r.Ab(1),r.kc("ngIf",n.LineDetail)}}function M(e,t){if(1&e&&(r.Sb(0,"div",31),r.Sb(1,"p",32),r.Oc(2),r.Rb(),r.Sb(3,"ul",33),r.Mc(4,I,6,4,"li",34),r.Rb(),r.Rb()),2&e){var n=r.ec(4).ngIf,i=r.ec();r.Ab(2),r.Qc("Try to import file '",i.formValues.file.name,"'"),r.Ab(2),r.kc("ngForOf",n.evaluationResult.Detail)}}function k(e,t){if(1&e){var n=r.Tb();r.Qb(0),r.Mc(1,w,25,10,"div",29),r.Mc(2,M,5,2,"div",29),r.Sb(3,"div",30),r.Sb(4,"button",26),r.ac("click",(function(){return r.Ac(n),r.ec(4).back()})),r.Oc(5,"Back"),r.Rb(),r.Sb(6,"button",27),r.ac("click",(function(){return r.Ac(n),r.ec(4).importContent()})),r.Oc(7," Import "),r.Rb(),r.Rb(),r.Pb()}if(2&e){var i=r.ec(3).ngIf;r.Ab(1),r.kc("ngIf",i.evaluationResult.Success),r.Ab(1),r.kc("ngIf",!i.evaluationResult.Success),r.Ab(4),r.kc("disabled",!i.evaluationResult.Success)}}function D(e,t){if(1&e&&(r.Qb(0),r.Mc(1,k,8,3,"ng-container",6),r.Pb()),2&e){var n=r.ec(2).ngIf;r.Ab(1),r.kc("ngIf",n.evaluationResult)}}function x(e,t){1&e&&(r.Sb(0,"p"),r.Oc(1,"Import done."),r.Rb())}function $(e,t){1&e&&(r.Sb(0,"p"),r.Oc(1,"Import failed."),r.Rb())}function T(e,t){if(1&e&&(r.Sb(0,"div",28),r.Mc(1,x,2,0,"p",6),r.Mc(2,$,2,0,"p",6),r.Rb()),2&e){var n=r.ec(3).ngIf;r.Ab(1),r.kc("ngIf",n.importResult.Success),r.Ab(1),r.kc("ngIf",!n.importResult.Success)}}function P(e,t){if(1&e){var n=r.Tb();r.Sb(0,"div"),r.Mc(1,T,3,2,"div",35),r.Sb(2,"div",30),r.Sb(3,"button",36),r.ac("click",(function(){return r.Ac(n),r.ec(3).closeDialog()})),r.Oc(4,"Close"),r.Rb(),r.Rb(),r.Rb()}if(2&e){var i=r.ec(2).ngIf;r.Ab(1),r.kc("ngIf",i.importResult)}}function V(e,t){if(1&e&&(r.Qb(0),r.Qb(1,7),r.Mc(2,R,32,4,"form",8),r.Mc(3,O,2,0,"p",9),r.Mc(4,D,2,1,"ng-container",10),r.Mc(5,P,5,1,"div",10),r.Pb(),r.Pb()),2&e){var n=r.ec().ngIf;r.Ab(1),r.kc("ngSwitch",n.viewStateSelected),r.Ab(1),r.kc("ngSwitchCase",1),r.Ab(1),r.kc("ngSwitchCase",0),r.Ab(1),r.kc("ngSwitchCase",2),r.Ab(1),r.kc("ngSwitchCase",3)}}function _(e,t){if(1&e){var n=r.Tb();r.Sb(0,"div",1),r.ac("filesDropped",(function(e){return r.Ac(n),r.ec().filesDropped(e)})),r.Sb(1,"div",2),r.Sb(2,"div",3),r.Oc(3),r.Rb(),r.Rb(),r.Sb(4,"p",4),r.Oc(5," This will import content-items into 2sxc. It requires that you already defined the content-type before you try importing, and that you created the import-file using the template provided by the Export. Please visit "),r.Sb(6,"a",5),r.Oc(7,"https://2sxc.org/help"),r.Rb(),r.Oc(8," for more instructions. "),r.Rb(),r.Mc(9,V,6,5,"ng-container",6),r.Rb()}if(2&e){var i=t.ngIf,o=r.ec();r.kc("allowedFileTypes","xml"),r.Ab(3),r.Qc("",null==i.contentType?null:i.contentType.Name," Import Data"),r.Ab(6),r.kc("ngIf",null!=o.formValues)}}var N=function(){function e(e,t,n,o,l,r){this.dialogData=e,this.dialogRef=t,this.route=n,this.contentImportService=o,this.appDialogConfigService=l,this.contentTypesService=r,this.hostClass="dialog-component",this.contentType$=new a.a(null),this.loading$=new a.a(!1),this.viewStates={waiting:0,default:1,evaluated:2,imported:3},this.viewStateSelected$=new a.a(this.viewStates.default),this.evaluationResult$=new a.a(null),this.importResult$=new a.a(null),this.templateVars$=Object(c.a)([this.contentType$,this.loading$,this.viewStateSelected$,this.evaluationResult$,this.importResult$]).pipe(Object(s.a)((function(e){var t=Object(i.f)(e,5);return{contentType:t[0],loading:t[1],viewStateSelected:t[2],evaluationResult:t[3],importResult:t[4]}}))),this.errors={0:"Unknown error occured.",1:"Selected content-type does not exist.",2:"Document is not a valid XML file.",3:"Selected content-type does not match the content-type in the XML file.",4:"The language is not supported.",5:"The document does not specify all languages for all entities.",6:"Language reference cannot be parsed, the language is not supported.",7:"Language reference cannot be parsed, the read-write protection is not supported.",8:"Value cannot be read, because of it has an invalid format."},this.contentTypeStaticName=this.route.snapshot.paramMap.get("contentTypeStaticName")}return e.prototype.ngOnInit=function(){var e=this;this.loading$.next(!0);var t=this.contentTypesService.retrieveContentType(this.contentTypeStaticName),n=this.appDialogConfigService.getDialogSettings();Object(l.a)([t,n]).subscribe((function(t){var n=Object(i.f)(t,2),o=n[1];e.contentType$.next(n[0]),e.formValues={defaultLanguage:o.Context.Language.Primary,contentType:e.contentTypeStaticName,file:null!=e.dialogData.files?e.dialogData.files[0]:null,resourcesReferences:"Keep",clearEntities:"None"},e.loading$.next(!1)}))},e.prototype.ngOnDestroy=function(){this.contentType$.complete(),this.loading$.complete(),this.viewStateSelected$.complete(),this.evaluationResult$.complete(),this.importResult$.complete()},e.prototype.closeDialog=function(){this.dialogRef.close()},e.prototype.evaluateContent=function(){var e=this;this.viewStateSelected$.next(this.viewStates.waiting),this.contentImportService.evaluateContent(this.formValues).subscribe((function(t){e.evaluationResult$.next(t),e.viewStateSelected$.next(e.viewStates.evaluated)}))},e.prototype.importContent=function(){var e=this;this.viewStateSelected$.next(this.viewStates.waiting),this.contentImportService.importContent(this.formValues).subscribe((function(t){e.importResult$.next(t),e.viewStateSelected$.next(e.viewStates.imported)}))},e.prototype.back=function(){this.viewStateSelected$.next(this.viewStates.default),this.evaluationResult$.next(null)},e.prototype.fileChange=function(e){this.formValues.file=e.target.files[0]},e.prototype.filesDropped=function(e){this.formValues.file=e[0]},e.\u0275fac=function(t){return new(t||e)(r.Mb(o.a),r.Mb(o.g),r.Mb(u.a),r.Mb(b.a),r.Mb(p.a),r.Mb(f.a))},e.\u0275cmp=r.Gb({type:e,selectors:[["app-content-import"]],hostVars:1,hostBindings:function(e,t){2&e&&r.Vb("className",t.hostClass)},decls:2,vars:3,consts:[["class","dialog-form-wrapper","appDragAndDrop","",3,"allowedFileTypes","filesDropped",4,"ngIf"],["appDragAndDrop","",1,"dialog-form-wrapper",3,"allowedFileTypes","filesDropped"],["mat-dialog-title",""],[1,"dialog-title-box"],[1,"dialog-description"],["href","https://2sxc.org/help","target","_blank"],[4,"ngIf"],[3,"ngSwitch"],["class","dialog-form",4,"ngSwitchCase"],["class","progress-message",4,"ngSwitchCase"],[4,"ngSwitchCase"],[1,"dialog-form"],["ngForm","ngForm"],[1,"dialog-form-content","fancy-scrollbar-light"],["mat-raised-button","","matTooltip","Open file browser",3,"click"],["type","file",1,"hide",3,"change"],["fileInput",""],[1,"field-label"],["name","ResourcesReferences",3,"ngModel","ngModelChange"],["value","Keep"],["value","Resolve"],["name","ClearEntities",3,"ngModel","ngModelChange"],["value","None"],["value","All"],[1,"hint"],[1,"dialog-form-actions"],["mat-raised-button","",3,"click"],["mat-raised-button","","color","accent",3,"disabled","click"],[1,"progress-message"],["class","dialog-component-content fancy-scrollbar-light",4,"ngIf"],[1,"dialog-component-actions"],[1,"dialog-component-content","fancy-scrollbar-light"],[1,"evaluation__title"],[1,"evaluation__content"],[4,"ngFor","ngForOf"],["class","progress-message",4,"ngIf"],["mat-raised-button","","color","accent",3,"click"]],template:function(e,t){1&e&&(r.Mc(0,_,10,3,"div",0),r.fc(1,"async")),2&e&&r.kc("ngIf",r.gc(1,1,t.templateVars$))},directives:[g.t,d.a,o.h,g.x,g.y,m.H,m.t,m.u,v.b,S.a,h.b,m.s,m.v,h.a,g.s],pipes:[g.b],styles:[".field-label[_ngcontent-%COMP%]{font-size:18px;margin:24px 0 0}.mat-radio-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;margin:8px 0}.mat-radio-button[_ngcontent-%COMP%]{margin:5px;font-size:14px}.hint[_ngcontent-%COMP%]{margin-top:24px;margin-bottom:16px}.hint[_ngcontent-%COMP%], .progress-message[_ngcontent-%COMP%]{font-size:18px}.evaluation__title[_ngcontent-%COMP%]{font-size:18px;margin:24px 0 0;font-weight:700}.evaluation__content[_ngcontent-%COMP%]{font-size:14px}.evaluation__content[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{padding:2px 0}"],changeDetection:0}),e}()}}]);
//# sourceMappingURL=https://sources.2sxc.org/11.11.04/ng-edit/content-import-component.95d11b55c18ae1a0c168.js.map