"use strict";(self.webpackChunkng_dialogs=self.webpackChunkng_dialogs||[]).push([["projects_ng-dialogs_src_app_import-app_services_import-app_service_ts-projects_ng-dialogs_src-d70d5e"],{8854:(T,u,s)=>{s.d(u,{H:()=>i,a:()=>n});var l=s(2673),m=s(745),d=s(3862),f=s(8598),h=s(3184),e=s(8784),D=s(2425);const i="admin/app/";let n=(()=>{class a{constructor(r,g,C){this.http=r,this.context=g,this.dnnContext=C}importApp(r,g,C=!1){const E=new FormData;return E.append("File",r),E.append("Name",null!=g?g:""),this.http.post(this.dnnContext.$2sxc.http.apiUrl(i+"Import"),E,{params:{zoneId:this.context.zoneId.toString()}}).pipe((0,l.w)(x=>{var O;if(C&&(null===(O=x.Messages[0])||void 0===O?void 0:O.MessageType)===d.D.Warning){const M=prompt(x.Messages[0].Text+" Would you like to install it using another folder name?");if(M)return this.importApp(r,M,!0)}return(0,m.of)(x)}))}}return a.\u0275fac=function(r){return new(r||a)(h.LFG(e.eN),h.LFG(f._),h.LFG(D._y))},a.\u0275prov=h.Yz7({token:a,factory:a.\u0275fac}),a})()},5487:(T,u,s)=>{s.d(u,{r:()=>e});var l=s(5738),m=s(8598),d=s(3184),f=s(5758),h=s(2977);let e=(()=>{class D{constructor(n,a,p,r,g,C){var E;this.dialog=n,this.viewContainerRef=a,this.router=p,this.route=r,this.context=g,this.changeDetectorRef=C;const x=this.router.getCurrentNavigation();this.dialogData=(null===(E=null==x?void 0:x.extras)||void 0===E?void 0:E.state)||{}}ngOnInit(){const n=this.route.snapshot.data.dialog;if(null==n)throw new Error("Could not find config for dialog. Did you forget to add DialogConfig to route data?");(0,l.P)("Open dialog:",n.name,"Context id:",this.context.id,"Context:",this.context),n.getComponent().then(a=>{this.dialog._dialogAnimatingOpen&&this.dialog._lastDialogRef?this.dialog._lastDialogRef.afterOpened().subscribe(()=>{this.openDialogComponent(n,a)}):this.openDialogComponent(n,a)})}ngOnDestroy(){this.dialogRef.close()}openDialogComponent(n,a){n.initContext&&this.context.init(this.route),this.dialogRef=this.dialog.open(a,{autoFocus:!1,backdropClass:"dialog-backdrop",closeOnNavigation:!1,data:this.dialogData,panelClass:["dialog-panel",`dialog-panel-${n.panelSize}`,n.showScrollbar?"show-scrollbar":"no-scrollbar",...n.panelClass?n.panelClass:[]],position:{top:"0"},viewContainerRef:this.viewContainerRef}),this.dialogRef.afterClosed().subscribe(p=>{(0,l.P)("Dialog was closed:",n.name,"Data:",p);const r=p;if(null==(null==r?void 0:r.navigateUrl))if(this.route.pathFromRoot.length<=3)try{window.parent.$2sxc.totalPopup.close()}catch(g){}else this.router.navigate(["./"],this.route.snapshot.url.length>0?{relativeTo:this.route.parent,state:p}:{relativeTo:this.route.parent.parent,state:p});else this.router.navigate([r.navigateUrl])}),this.changeDetectorRef.markForCheck()}}return D.\u0275fac=function(n){return new(n||D)(d.Y36(f.uw),d.Y36(d.s_b),d.Y36(h.F0),d.Y36(h.gz),d.Y36(m._),d.Y36(d.sBO))},D.\u0275cmp=d.Xpm({type:D,selectors:[["app-dialog-entry"]],decls:0,vars:0,template:function(n,a){},styles:[""]}),D})()},6967:(T,u,s)=>{s.d(u,{U:()=>R});var l=s(5758),m=s(6317),d=s(7714),f=s(9295),h=s(6761),e=s(3184),D=s(2528),i=s(6362),n=s(1529),a=s(4742),p=s(7317),r=s(785),g=s(845);function C(o,c){1&o&&e._UZ(0,"mat-spinner",13)}function E(o,c){1&o&&(e.TgZ(0,"div"),e._uU(1,"Select or drop file"),e.qZA())}function x(o,c){if(1&o&&(e.TgZ(0,"div"),e._uU(1),e.qZA()),2&o){const t=c.$implicit;e.xp6(1),e.Oqu(t.name)}}function O(o,c){1&o&&(e.TgZ(0,"div",18),e._uU(1," Upload succeeded. See the messages below for more information. "),e.qZA())}function M(o,c){1&o&&(e.TgZ(0,"div",19),e._uU(1," Upload failed. See the messages below for more information. "),e.qZA())}const U=function(o,c,t){return{"sxc-message-warning":o,"sxc-message-success":c,"sxc-message-error":t}};function P(o,c){if(1&o&&(e.TgZ(0,"div",20),e._uU(1),e.qZA()),2&o){const t=c.$implicit,_=e.oxw(3);e.Q6J("ngClass",e.kEZ(2,U,t.MessageType===_.FileUploadMessageTypes.Warning,t.MessageType===_.FileUploadMessageTypes.Success,t.MessageType===_.FileUploadMessageTypes.Error)),e.xp6(1),e.hij(" ",t.Text," ")}}function A(o,c){if(1&o&&(e.TgZ(0,"div",14),e.YNc(1,O,2,0,"div",15),e.YNc(2,M,2,0,"div",16),e.YNc(3,P,2,6,"div",17),e.qZA()),2&o){const t=e.oxw().ngIf;e.xp6(1),e.Q6J("ngIf",t.result.Success),e.xp6(1),e.Q6J("ngIf",!t.result.Success),e.xp6(1),e.Q6J("ngForOf",t.result.Messages)}}function y(o,c){if(1&o){const t=e.EpF();e.ynx(0),e.TgZ(1,"button",21),e.NdJ("click",function(){return e.CHM(t),e.oxw(2).closeDialog()}),e._uU(2,"Cancel"),e.qZA(),e.TgZ(3,"button",22),e.NdJ("click",function(){return e.CHM(t),e.oxw(2).upload()}),e._uU(4," Upload "),e.qZA(),e.BQk()}if(2&o){const t=e.oxw().ngIf;e.xp6(3),e.Q6J("disabled",!t.files.length||t.uploading||!!t.result)}}function I(o,c){if(1&o){const t=e.EpF();e.ynx(0),e.TgZ(1,"button",23),e.NdJ("click",function(){return e.CHM(t),e.oxw(2).closeDialog(!0)}),e._uU(2,"Close"),e.qZA(),e.BQk()}}function F(o,c){if(1&o){const t=e.EpF();e.TgZ(0,"div",1),e.NdJ("filesDropped",function(v){return e.CHM(t),e.oxw().filesDropped(v)}),e.TgZ(1,"div",2),e._UZ(2,"div",3),e.ALo(3,"safeHtml"),e.qZA(),e.YNc(4,C,1,0,"mat-spinner",4),e._UZ(5,"p",5),e.ALo(6,"safeHtml"),e.TgZ(7,"div")(8,"button",6),e.NdJ("click",function(){return e.CHM(t),e.MAs(12).click()}),e.YNc(9,E,2,0,"div",7),e.YNc(10,x,2,1,"div",8),e.qZA(),e.TgZ(11,"input",9,10),e.NdJ("change",function(v){return e.CHM(t),e.oxw().filesChanged(v)}),e.qZA()(),e.YNc(13,A,4,3,"div",11),e.TgZ(14,"div",12),e.YNc(15,y,5,1,"ng-container",7),e.YNc(16,I,3,0,"ng-container",7),e.qZA()()}if(2&o){const t=c.ngIf,_=e.oxw();e.Q6J("allowedFileTypes",_.dialogData.allowedFileTypes),e.xp6(2),e.Q6J("innerHtml",e.lcZ(3,10,_.dialogData.title),e.oJD),e.xp6(2),e.Q6J("ngIf",t.uploading),e.xp6(1),e.Q6J("innerHtml",e.lcZ(6,12,_.dialogData.description),e.oJD),e.xp6(3),e.Q6J("disabled",t.uploading),e.xp6(1),e.Q6J("ngIf",!t.files.length),e.xp6(1),e.Q6J("ngForOf",t.files),e.xp6(3),e.Q6J("ngIf",t.result),e.xp6(2),e.Q6J("ngIf",!(null!=t.result&&t.result.Success)),e.xp6(1),e.Q6J("ngIf",null==t.result?null:t.result.Success)}}const L=function(o,c,t){return{uploading:o,files:c,result:t}};let R=(()=>{class o{constructor(t,_,v){this.dialogData=t,this.dialogRef=_,this.snackBar=v,this.hostClass="dialog-component",this.uploading$=new m.X(!1),this.files$=new m.X([]),this.result$=new m.X(void 0),this.FileUploadMessageTypes=h.D,this.subscription=new d.w0}ngOnInit(){this.subscription.add(this.files$.subscribe(()=>{void 0!==this.result$.value&&this.result$.next(void 0)})),null!=this.dialogData.files&&this.filesDropped(this.dialogData.files)}ngOnDestroy(){this.uploading$.complete(),this.files$.complete(),this.result$.complete(),this.subscription.unsubscribe()}closeDialog(t){this.dialogRef.close(t)}filesDropped(t){this.setFiles(t),this.upload()}filesChanged(t){const v=Array.from(t.target.files);this.setFiles(v)}upload(){this.uploading$.next(!0),this.subscription.add(this.dialogData.upload$(this.files$.value).pipe((0,f.q)(1)).subscribe({next:t=>{this.uploading$.next(!1),this.result$.next(t)},error:()=>{this.uploading$.next(!1),this.result$.next(void 0),this.snackBar.open("Upload failed. Please check console for more information",void 0,{duration:3e3})}}))}setFiles(t){this.dialogData.multiple||(t=t.slice(0,1)),this.files$.next(t)}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(l.WI),e.Y36(l.so),e.Y36(D.ux))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-file-upload-dialog"]],hostVars:1,hostBindings:function(t,_){2&t&&e.Ikx("className",_.hostClass)},decls:4,vars:11,consts:[["appDragAndDrop","",3,"allowedFileTypes","filesDropped",4,"ngIf"],["appDragAndDrop","",3,"allowedFileTypes","filesDropped"],["mat-dialog-title",""],[1,"dialog-title-box",3,"innerHtml"],["mode","indeterminate","diameter","20","color","accent",4,"ngIf"],[1,"dialog-description",3,"innerHtml"],["mat-raised-button","","tippy","Open file browser",3,"disabled","click"],[4,"ngIf"],[4,"ngFor","ngForOf"],["type","file","multiple","",1,"hide",3,"change"],["fileInput",""],["class","dialog-component-content fancy-scrollbar-light result-container",4,"ngIf"],[1,"dialog-component-actions"],["mode","indeterminate","diameter","20","color","accent"],[1,"dialog-component-content","fancy-scrollbar-light","result-container"],["class","sxc-message sxc-message-info",4,"ngIf"],["class","sxc-message sxc-message-error",4,"ngIf"],["class","sxc-message",3,"ngClass",4,"ngFor","ngForOf"],[1,"sxc-message","sxc-message-info"],[1,"sxc-message","sxc-message-error"],[1,"sxc-message",3,"ngClass"],["mat-raised-button","",3,"click"],["mat-raised-button","","color","accent",3,"disabled","click"],["mat-raised-button","","color","accent",3,"click"]],template:function(t,_){1&t&&(e.YNc(0,F,17,14,"div",0),e.ALo(1,"async"),e.ALo(2,"async"),e.ALo(3,"async")),2&t&&e.Q6J("ngIf",e.kEZ(7,L,e.lcZ(1,1,_.uploading$),e.lcZ(2,3,_.files$),e.lcZ(3,5,_.result$)))},directives:[i.O5,n.z,l.uh,a.Ou,p.lW,r.$,i.sg,i.mk],pipes:[i.Ov,g.z],styles:[".result-container[_ngcontent-%COMP%]{margin-top:16px}"]}),o})()},6761:(T,u,s)=>{s.d(u,{D:()=>l});const l={Warning:0,Success:1,Error:2}},3862:(T,u,s)=>{s.d(u,{D:()=>m.D,U:()=>l.U});var l=s(6967),m=s(6761)},1529:(T,u,s)=>{s.d(u,{z:()=>h});var l=s(3184),m=s(7714),d=s(3280),f=s(2528);let h=(()=>{class e{constructor(i,n,a){this.zone=n,this.snackBar=a,this.markStyle="outline",this.allowedFileTypes="",this.filesDropped=new l.vpe,this.dropAreaClass="eav-droparea",this.dragClass="eav-dragover",this.timeouts=[],this.subscription=new m.w0,this.element=i.nativeElement}ngOnInit(){this.markStyleClass=`eav-droparea-${this.markStyle}`,this.element.classList.add(this.dropAreaClass,this.markStyleClass),this.zone.runOutsideAngular(()=>{this.subscription.add((0,d.R)(this.element,"dragover").subscribe(i=>{i.preventDefault(),i.stopPropagation(),this.clearTimeouts(),this.element.classList.add(this.dragClass)})),this.subscription.add((0,d.R)(this.element,"dragleave").subscribe(i=>{i.preventDefault(),i.stopPropagation(),this.timeouts.push(window.setTimeout(()=>{this.element.classList.remove(this.dragClass)},50))}))})}ngOnDestroy(){this.clearTimeouts(),this.element.classList.remove(this.dropAreaClass,this.markStyleClass,this.dragClass),this.subscription.unsubscribe()}onDrop(i){i.preventDefault(),i.stopPropagation(),this.clearTimeouts(),this.element.classList.remove(this.dragClass);let a=Array.from(i.dataTransfer.files);a=this.filterTypes(a,this.allowedFileTypes),a.length>0&&this.filesDropped.emit(a)}clearTimeouts(){for(const i of this.timeouts)clearTimeout(i);this.timeouts=[]}filterTypes(i,n){if(""===n)return i;const a=n.split(",").map(r=>r.toLocaleLowerCase()),p=i.filter(r=>{const g=r.name.lastIndexOf(".");if(g<=0)return!1;const C=r.name.substring(g+1).toLocaleLowerCase();return a.includes(C)});if(i.length!==p.length){const r=this.allowedFileTypes.replace(/\,/g,", ");this.snackBar.open(p.length?"Some files were filtered out. This drop location only accepts file types: "+r:"This drop location only accepts file types: "+r,null,{duration:5e3})}return p}}return e.\u0275fac=function(i){return new(i||e)(l.Y36(l.SBq),l.Y36(l.R0b),l.Y36(f.ux))},e.\u0275dir=l.lG2({type:e,selectors:[["","appDragAndDrop",""]],hostBindings:function(i,n){1&i&&l.NdJ("drop",function(p){return n.onDrop(p)})},inputs:{markStyle:"markStyle",allowedFileTypes:"allowedFileTypes"},outputs:{filesDropped:"filesDropped"}}),e})()},845:(T,u,s)=>{s.d(u,{z:()=>d});var l=s(3184),m=s(318);let d=(()=>{class f{constructor(e){this.sanitizer=e}transform(e){return this.sanitizer.bypassSecurityTrustHtml(e)}}return f.\u0275fac=function(e){return new(e||f)(l.Y36(m.H7,16))},f.\u0275pipe=l.Yjl({name:"safeHtml",type:f,pure:!0}),f})()}}]);
//# sourceMappingURL=https://sources.2sxc.org/13.06.00/ng-edit/projects_ng-dialogs_src_app_import-app_services_import-app_service_ts-projects_ng-dialogs_src-d70d5e.e81ba34eb4af731c.js.map