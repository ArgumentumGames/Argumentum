(window.webpackJsonp=window.webpackJsonp||[]).push([[51],{SST1:function(e,t,i){"use strict";i.r(t),i.d(t,"PermissionsComponent",(function(){return D}));var n=i("D57K"),s=i("KLQV"),o=i("sEIs"),r=i("C05f"),a=i("bwdy"),l=i("xVbo"),c=i("jIqt"),p=i("YtkY"),d=i("0Woy"),u=i("JzAw"),h=i("QjRa"),m=i("o9tz"),b=i("uuTa"),f=i("EM62"),y=i("mFH5"),g=i("Y2X+"),k=i("bFHC"),C=function(){function e(){}return e.prototype.agInit=function(e){this.params=e},e.prototype.refresh=function(e){return!0},e.prototype.deletePermission=function(){this.params.onDelete(this.params.data)},e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=f.Gb({type:e,selectors:[["app-permissions-actions"]],decls:4,vars:0,consts:[[1,"actions-component"],["matRipple","","matTooltip","Delete",1,"like-button","highlight",3,"click"]],template:function(e,t){1&e&&(f.Sb(0,"div",0),f.Sb(1,"div",1),f.ac("click",(function(){return t.deletePermission()})),f.Sb(2,"mat-icon"),f.Oc(3,"delete"),f.Rb(),f.Rb(),f.Rb())},directives:[y.r,g.a,k.a],styles:[""],changeDetection:0}),e}(),v=i("OZ4H"),T=i("SNUn"),O=i("W1gw"),w=i("PBFl"),R=i("W6oE"),S=i("2kYt"),D=function(){function e(e,t,i,o,l){this.dialogRef=e,this.router=t,this.route=i,this.permissionsService=o,this.snackBar=l,this.permissions$=new r.a(null),this.modules=s.a,this.gridOptions=Object(n.a)(Object(n.a)({},h.a),{frameworkComponents:{idFieldComponent:u.a,permissionsActionsComponent:C},columnDefs:[{headerName:"ID",field:"Id",width:70,headerClass:"dense",cellClass:"id-action no-padding no-outline",cellRenderer:"idFieldComponent",sortable:!0,filter:"agTextColumnFilter",cellRendererParams:{tooltipGetter:function(e){return"ID: "+e.Id+"\nGUID: "+e.Guid}}},{headerName:"Name",field:"Title",flex:2,minWidth:250,cellClass:"primary-action highlight",sortable:!0,filter:"agTextColumnFilter",onCellClicked:this.editPermission.bind(this)},{headerName:"Identity",field:"Identity",flex:2,minWidth:250,cellClass:"no-outline",sortable:!0,filter:"agTextColumnFilter"},{headerName:"Condition",field:"Condition",flex:2,minWidth:250,cellClass:"no-outline",sortable:!0,filter:"agTextColumnFilter"},{headerName:"Grant",field:"Grant",width:70,headerClass:"dense",cellClass:"no-outline",sortable:!0,filter:"agTextColumnFilter"},{width:40,cellClass:"secondary-action no-padding",cellRenderer:"permissionsActionsComponent",pinned:"right",cellRendererParams:{onDelete:this.deletePermission.bind(this)}}]}),this.subscription=new a.a,this.targetType=parseInt(this.route.snapshot.paramMap.get("type"),10),this.keyType=this.route.snapshot.paramMap.get("keyType"),this.key=this.route.snapshot.paramMap.get("key")}return e.prototype.ngOnInit=function(){this.fetchPermissions(),this.refreshOnChildClosed()},e.prototype.ngOnDestroy=function(){this.permissions$.complete(),this.subscription.unsubscribe()},e.prototype.closeDialog=function(){this.dialogRef.close()},e.prototype.fetchPermissions=function(){var e=this;this.permissionsService.getAll(this.targetType,this.keyType,this.key).subscribe((function(t){e.permissions$.next(t)}))},e.prototype.editPermission=function(e){var t,i,s;if(null==e){var o=void 0,r=Object.keys(m.a.metadata);try{for(var a=Object(n.h)(r),l=a.next();!l.done;l=a.next()){var c=l.value;if(m.a.metadata[c].type===this.targetType){o=m.a.metadata[c].target;break}}}catch(d){t={error:d}}finally{try{l&&!l.done&&(i=a.return)&&i.call(a)}finally{if(t)throw t.error}}s={items:[{ContentTypeName:m.a.contentTypes.permissions,For:Object(n.a)(Object(n.a)(Object(n.a)({Target:o},this.keyType===m.a.keyTypes.guid&&{Guid:this.key}),this.keyType===m.a.keyTypes.number&&{Number:parseInt(this.key,10)}),this.keyType===m.a.keyTypes.string&&{String:this.key})}]}}else s={items:[{EntityId:e.data.Id}]};var p=Object(b.a)(s);this.router.navigate(["edit/"+p],{relativeTo:this.route})},e.prototype.deletePermission=function(e){var t=this;confirm("Delete '"+e.Title+"' ("+e.Id+")?")&&(this.snackBar.open("Deleting..."),this.permissionsService.delete(e.Id).subscribe((function(){t.snackBar.open("Deleted",null,{duration:2e3}),t.fetchPermissions()})))},e.prototype.refreshOnChildClosed=function(){var e=this;this.subscription.add(this.router.events.pipe(Object(l.a)((function(e){return e instanceof o.b})),Object(c.a)(!!this.route.snapshot.firstChild),Object(p.a)((function(){return!!e.route.snapshot.firstChild})),Object(d.a)(),Object(l.a)((function(e){var t=Object(n.f)(e,2);return t[0]&&!t[1]}))).subscribe((function(){e.fetchPermissions()})))},e.\u0275fac=function(t){return new(t||e)(f.Mb(v.g),f.Mb(o.c),f.Mb(o.a),f.Mb(T.a),f.Mb(O.b))},e.\u0275cmp=f.Gb({type:e,selectors:[["app-permissions"]],decls:15,vars:5,consts:[[1,"nav-component-wrapper"],["mat-dialog-title",""],[1,"dialog-title-box"],["mat-icon-button","","matTooltip","Close dialog",3,"click"],[1,"grid-wrapper"],[1,"ag-theme-material",3,"rowData","modules","gridOptions"],["mat-fab","","mat-elevation-z24","","matTooltip","Create a new permission",1,"grid-fab",3,"click"]],template:function(e,t){1&e&&(f.Sb(0,"div",0),f.Sb(1,"div",1),f.Sb(2,"div",2),f.Sb(3,"div"),f.Oc(4,"Permissions"),f.Rb(),f.Sb(5,"button",3),f.ac("click",(function(){return t.closeDialog()})),f.Sb(6,"mat-icon"),f.Oc(7,"close"),f.Rb(),f.Rb(),f.Rb(),f.Rb(),f.Nb(8,"router-outlet"),f.Sb(9,"div",4),f.Nb(10,"ag-grid-angular",5),f.fc(11,"async"),f.Sb(12,"button",6),f.ac("click",(function(){return t.editPermission(null)})),f.Sb(13,"mat-icon"),f.Oc(14,"add"),f.Rb(),f.Rb(),f.Rb(),f.Rb()),2&e&&(f.Ab(10),f.kc("rowData",f.gc(11,3,t.permissions$))("modules",t.modules)("gridOptions",t.gridOptions))},directives:[v.h,w.b,g.a,k.a,o.e,R.a],pipes:[S.b],styles:[""],changeDetection:0}),e}()}}]);
//# sourceMappingURL=https://sources.2sxc.org/11.11.04/ng-edit/permissions-component.af1fad759073f6f13b67.js.map