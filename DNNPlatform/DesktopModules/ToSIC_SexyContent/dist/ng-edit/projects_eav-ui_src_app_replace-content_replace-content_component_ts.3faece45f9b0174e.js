"use strict";(self.webpackChunkeav_ui=self.webpackChunkeav_ui||[]).push([["projects_eav-ui_src_app_replace-content_replace-content_component_ts"],{3429:(A,C,e)=>{e.r(C),e.d(C,{ReplaceContentComponent:()=>W});var p=e(6317),d=e(6562),h=e(635),g=e(9989),E=e(60),v=e(2225),t=e(3184),m=e(2977),_=e(5758),M=e(2528),s=e(6362),c=e(4770),R=e(4683),P=e(3188),f=e(587),x=e(9051),I=e(1130),U=e(7317),B=e(6190),L=e(5590);function y(l,u){if(1&l&&(t.TgZ(0,"mat-option",15),t._uU(1),t.qZA()),2&l){const n=u.$implicit;t.Q6J("value",n),t.xp6(1),t.Oqu(n)}}function K(l,u){if(1&l){const n=t.EpF();t.ynx(0),t.TgZ(1,"div",1)(2,"div",2),t._uU(3),t.qZA()(),t._UZ(4,"router-outlet"),t.TgZ(5,"p",3),t._uU(6),t.qZA(),t.TgZ(7,"div",4)(8,"mat-form-field",5)(9,"mat-label"),t._uU(10,"Choose item"),t.qZA(),t.TgZ(11,"input",6),t.NdJ("ngModelChange",function(i){return t.CHM(n),t.oxw().setFilter(i)}),t.qZA(),t.TgZ(12,"mat-autocomplete",7,8),t.NdJ("optionSelected",function(i){return t.CHM(n),t.oxw().select(i)}),t.TgZ(14,"cdk-virtual-scroll-viewport",9),t.YNc(15,y,2,2,"mat-option",10),t.qZA()()(),t.TgZ(16,"button",11),t.NdJ("click",function(){return t.CHM(n),t.oxw().copySelected()}),t.TgZ(17,"mat-icon"),t._uU(18,"file_copy"),t.qZA()()(),t.TgZ(19,"div",12)(20,"button",13),t.NdJ("click",function(){return t.CHM(n),t.oxw().closeDialog()}),t._uU(21,"Cancel"),t.qZA(),t.TgZ(22,"button",14),t.NdJ("click",function(){return t.CHM(n),t.oxw().save()}),t._uU(23,"Save"),t.qZA()(),t.BQk()}if(2&l){const n=u.ngIf,o=t.MAs(13);t.xp6(3),t.Oqu(n.isAddMode?"Add Existing Item":"Replace Content Item"),t.xp6(3),t.hij(" ",n.isAddMode?"Select a content-item to add to this list.":"By replacing a content-item you can make other content appear in the slot of the original content."," "),t.xp6(5),t.Q6J("matAutocomplete",o)("ngModel",n.filterText),t.xp6(3),t.Udp("height",n.filteredOptions.length<6?48*n.filteredOptions.length:240,"px"),t.xp6(1),t.Q6J("cdkVirtualForOf",n.filteredOptions),t.xp6(1),t.Q6J("disabled",!n.isMatch),t.xp6(6),t.Q6J("disabled",!n.isMatch)}}let W=(()=>{class l extends E.H{constructor(n,o,i,a,r){super(n,o),this.router=n,this.route=o,this.dialogRef=i,this.contentGroupService=a,this.snackBar=r,this.hostClass="dialog-component"}ngOnInit(){this.guid=this.route.snapshot.paramMap.get("guid"),this.part=this.route.snapshot.paramMap.get("part"),this.index=parseInt(this.route.snapshot.paramMap.get("index"),10),this.add=!!this.route.snapshot.queryParamMap.get("add"),this.filterText$=new p.X(""),this.options$=new p.X([]);const n=(0,d.a)([this.filterText$,this.options$]).pipe((0,h.U)(([o,i])=>i.filter(a=>a.label.toLocaleLowerCase().includes(o.toLocaleLowerCase())).map(a=>a.label)));this.templateVars$=(0,d.a)([this.filterText$,n]).pipe((0,h.U)(([o,i])=>({filterText:o,filteredOptions:i,isAddMode:this.add,isMatch:i.includes(o)}))),this.fetchConfig(!1,null),this.subscription.add(this.refreshOnChildClosedShallow().subscribe(()=>{var o;const a=null===(o=this.router.getCurrentNavigation().extras)||void 0===o?void 0:o.state,r=null==a?void 0:a[Object.keys(a)[0]];this.fetchConfig(!0,r)}))}ngOnDestroy(){this.filterText$.complete(),this.options$.complete(),super.ngOnDestroy()}closeDialog(){this.dialogRef.close()}setFilter(n){this.filterText$.next(n)}select(n){this.filterText$.next(n.option.value)}copySelected(){const n=this.buildContentGroup(),i=(0,v.f)({items:[{ContentTypeName:this.contentTypeName,DuplicateEntity:n.id}]});this.router.navigate([`edit/${i}`],{relativeTo:this.route})}save(){this.snackBar.open("Saving...");const n=this.buildContentGroup();this.contentGroupService.saveItem(n).subscribe(()=>{this.snackBar.open("Saved",null,{duration:2e3}),this.closeDialog()})}fetchConfig(n,o){const i=this.buildContentGroup();this.contentGroupService.getItems(i).subscribe(a=>{var r;const Z=Object.entries(a.Items).map(([O,D])=>({id:parseInt(O,10),label:`${D} (${O})`}));if(this.options$.next(Z),!i.add&&!n||null!=o){const O=n?o:a.SelectedId,D=(null===(r=this.options$.value.find(T=>T.id===O))||void 0===r?void 0:r.label)||"";this.filterText$.next(D)}this.contentTypeName=a.ContentTypeName})}buildContentGroup(){var n,o;return{id:null!==(o=null===(n=this.options$.value.find(r=>r.label===this.filterText$.value))||void 0===n?void 0:n.id)&&void 0!==o?o:null,guid:this.guid,part:this.part,index:this.index,add:this.add}}}return l.\u0275fac=function(n){return new(n||l)(t.Y36(m.F0),t.Y36(m.gz),t.Y36(_.so),t.Y36(g.e),t.Y36(M.ux))},l.\u0275cmp=t.Xpm({type:l,selectors:[["app-replace-content"]],hostVars:1,hostBindings:function(n,o){2&n&&t.Ikx("className",o.hostClass)},features:[t.qOj],decls:2,vars:3,consts:[[4,"ngIf"],["mat-dialog-title",""],[1,"dialog-title-box"],[1,"dialog-description"],[1,"options-box"],["appearance","standard","color","accent"],["matInput","",3,"matAutocomplete","ngModel","ngModelChange"],[3,"optionSelected"],["auto","matAutocomplete"],["itemSize","48","minBufferPx","500","maxBufferPx","1000"],[3,"value",4,"cdkVirtualFor","cdkVirtualForOf"],["mat-icon-button","","tippy","Copy",1,"options-box__copy",3,"disabled","click"],[1,"dialog-component-actions"],["mat-raised-button","",3,"click"],["mat-raised-button","","color","accent",3,"disabled","click"],[3,"value"]],template:function(n,o){1&n&&(t.YNc(0,K,24,9,"ng-container",0),t.ALo(1,"async")),2&n&&t.Q6J("ngIf",t.lcZ(1,1,o.templateVars$))},directives:[s.O5,_.uh,m.lC,c.KE,c.hX,R.Nt,P.ZL,f.Fj,f.JJ,f.On,P.XC,x.N7,x.xd,x.x0,I.ey,U.lW,B.$,L.Hw],pipes:[s.Ov],styles:[".options-box[_ngcontent-%COMP%]{display:flex;align-items:flex-end}.options-box__copy[_ngcontent-%COMP%]{margin-left:8px}"]}),l})()},60:(A,C,e)=>{e.d(C,{H:()=>m});var p=e(2977),d=e(116),h=e(4874),g=e(635),E=e(679),v=e(5904),t=e(3184);let m=(()=>{class _ extends v.f{constructor(s,c){super(),this.router=s,this.route=c}ngOnDestroy(){super.ngOnDestroy()}refreshOnChildClosedDeep(){return this.router.events.pipe((0,d.h)(s=>s instanceof p.m2),(0,h.O)(!!this.route.snapshot.firstChild.firstChild),(0,g.U)(()=>!!this.route.snapshot.firstChild.firstChild),(0,E.G)(),(0,d.h)(([s,c])=>s&&!c))}refreshOnChildClosedShallow(){return this.router.events.pipe((0,d.h)(s=>s instanceof p.m2),(0,h.O)(!!this.route.snapshot.firstChild),(0,g.U)(()=>!!this.route.snapshot.firstChild),(0,E.G)(),(0,d.h)(([s,c])=>s&&!c))}}return _.\u0275fac=function(s){return new(s||_)(t.Y36(p.F0),t.Y36(p.gz))},_.\u0275dir=t.lG2({type:_,features:[t.qOj]}),_})()}}]);
//# sourceMappingURL=https://sources.2sxc.org/15.02.00/ng-edit/projects_eav-ui_src_app_replace-content_replace-content_component_ts.3faece45f9b0174e.js.map