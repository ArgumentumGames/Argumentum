"use strict";(self.webpackChunkeav_ui=self.webpackChunkeav_ui||[]).push([["default-projects_eav-ui_src_app_permissions_index_ts","projects_eav-ui_src_app_permissions_permissions_module_ts","projects_eav-ui_src_app_permissions_permissions_component_ts"],{4272:(v,c,t)=>{t.d(c,{g:()=>h});var n=t(2847),s=t(5368),a=t(3184),_=t(8784),l=t(2425);let h=(()=>{class o{constructor(r,i,u){this.http=r,this.context=i,this.dnnContext=u}create(r,i){return this.http.post(`app/auto/data/${r}`,i,{params:{appId:this.context.appId,zoneId:this.context.zoneId}})}update(r,i,u){return this.http.post(`app/auto/data/${r}/${i}`,u,{params:{appId:this.context.appId,zoneId:this.context.zoneId}})}delete(r,i,u){return this.http.delete(this.dnnContext.$2sxc.http.apiUrl(n.Uo+"delete"),{params:{contentType:r,id:i.toString(),appId:this.context.appId.toString(),force:u.toString()}})}}return o.\u0275fac=function(r){return new(r||o)(a.LFG(_.eN),a.LFG(s._),a.LFG(l._y))},o.\u0275prov=a.Yz7({token:o,factory:o.\u0275fac}),o})()},325:(v,c,t)=>{t.d(c,{i:()=>s});var n=t(941);let s=(()=>{class a{static getUrl(l,h,o){return`permissions/${l}/${h}/${o}`}static getUrlApp(l){return this.getUrl(n.Z.metadata.app.targetType,n.Z.metadata.app.keyType,l.toString())}static getUrlAttribute(l){return this.getUrl(n.Z.metadata.attribute.targetType,n.Z.metadata.attribute.keyType,l.toString())}static getUrlContentType(l){return this.getUrlEntity(l)}static getUrlEntity(l){return this.getUrl(n.Z.metadata.entity.targetType,n.Z.metadata.entity.keyType,l)}static getUrlLanguage(l){return this.getUrl(n.Z.metadata.language.targetType,n.Z.metadata.language.keyType,l)}}return a.route={path:"permissions/:targetType/:keyType/:key",loadChildren:()=>t.e("projects_eav-ui_src_app_permissions_permissions_module_ts").then(t.bind(t,2965)).then(_=>_.PermissionsModule),data:{title:"Permissions"}},a})()},2925:(v,c,t)=>{t.d(c,{Do:()=>h.D,iK:()=>n.i,qQ:()=>o.q});var n=t(325),h=(t(3749),t(7261),t(61),t(2965),t(1667)),o=t(2023)},3749:(v,c,t)=>{t.d(c,{g:()=>s});var n=t(4929);const s={name:"SET_PERMISSIONS_DIALOG",initContext:!0,panelSize:"large",panelClass:null,getComponent(){return(0,n.mG)(this,void 0,void 0,function*(){const{PermissionsComponent:a}=yield Promise.all([t.e("default-projects_eav-ui_src_app_shared_directives_tippy_directive_ts"),t.e("projects_eav-ui_src_app_permissions_permissions_component_ts")]).then(t.bind(t,61));return a})}}},7261:(v,c,t)=>{t.d(c,{T:()=>o});var n=t(2977),s=t(2649),a=t(6167),_=t(3749),l=t(3184);const h=[{path:"",component:a.r,data:{dialog:_.g},children:[{matcher:s.eP,loadChildren:()=>Promise.all([t.e("default-projects_eav-ui_src_app_shared_directives_tippy_directive_ts"),t.e("default-projects_eav-ui_src_app_create-file-dialog_index_ts"),t.e("default-node_modules_angular_material_fesm2015_list_mjs"),t.e("default-projects_eav-ui_src_app_monaco-editor_index_ts-projects_eav-ui_src_app_shared_directi-e88d8b"),t.e("default-projects_eav-ui_src_app_edit_edit_module_ts"),t.e("default-projects_eav-ui_src_app_shared_translation_translate-configuration_ts-projects_eav-ui-de1a04"),t.e("default-node_modules_angular_material_fesm2015_autocomplete_mjs"),t.e("default-node_modules_angular_material_fesm2015_slide-toggle_mjs"),t.e("default-node_modules_angular_material_fesm2015_menu_mjs"),t.e("common"),t.e("projects_eav-ui_src_app_shared_components_field-hint_field-hint_component_ts-projects_eav-ui_-8ed4d80")]).then(t.bind(t,7155)).then(p=>p.EditModule)},{matcher:s.lZ,loadChildren:()=>t.e("projects_eav-ui_src_app_edit_refresh-edit_module_ts").then(t.bind(t,8449)).then(p=>p.RefreshEditModule)}]}];let o=(()=>{class p{}return p.\u0275fac=function(i){return new(i||p)},p.\u0275mod=l.oAB({type:p}),p.\u0275inj=l.cJS({imports:[[n.Bz.forChild(h)],n.Bz]}),p})()},61:(v,c,t)=>{t.r(c),t.d(c,{PermissionsComponent:()=>B});var n=t(2977),s=t(6317),a=t(7714),_=t(116),l=t(4874),h=t(635),o=t(679),p=t(2087),r=t(4153),i=t(941),u=t(2225),e=t(3184),P=t(1130),C=t(6190),y=t(5590);let O=(()=>{class E{agInit(d){this.params=d}refresh(d){return!0}deletePermission(){this.params.onDelete(this.params.data)}}return E.\u0275fac=function(d){return new(d||E)},E.\u0275cmp=e.Xpm({type:E,selectors:[["app-permissions-actions"]],decls:4,vars:0,consts:[[1,"actions-component"],["matRipple","","tippy","Delete",1,"like-button","highlight",3,"click"]],template:function(d,m){1&d&&(e.TgZ(0,"div",0)(1,"div",1),e.NdJ("click",function(){return m.deletePermission()}),e.TgZ(2,"mat-icon"),e._uU(3,"delete"),e.qZA()()())},directives:[P.wG,C.$,y.Hw],styles:[""]}),E})();var T=t(2023),D=t(5758),U=t(2528),A=t(7317),R=t(1350),L=t(6362);let B=(()=>{class E{constructor(d,m,g,M,I){this.dialogRef=d,this.router=m,this.route=g,this.permissionsService=M,this.snackBar=I,this.permissions$=new s.X(void 0),this.gridOptions=this.buildGridOptions(),this.subscription=new a.w0,this.targetType=parseInt(this.route.snapshot.paramMap.get("targetType"),10),this.keyType=this.route.snapshot.paramMap.get("keyType"),this.key=this.route.snapshot.paramMap.get("key"),this.prefills={[i.Z.metadata.language.targetType]:{PermissionType:"language"}}}ngOnInit(){this.fetchPermissions(),this.refreshOnChildClosed()}ngOnDestroy(){this.permissions$.complete(),this.subscription.unsubscribe()}closeDialog(){this.dialogRef.close()}fetchPermissions(){this.permissionsService.getAll(this.targetType,this.keyType,this.key).subscribe(d=>{this.permissions$.next(d)})}editPermission(d){var m,g;let M;M=null==d?{items:[Object.assign({ContentTypeName:i.Z.contentTypes.permissions,For:Object.assign(Object.assign(Object.assign({Target:null!==(g=null===(m=Object.values(i.Z.metadata).find(W=>W.targetType===this.targetType))||void 0===m?void 0:m.target)&&void 0!==g?g:this.targetType.toString(),TargetType:this.targetType},this.keyType===i.Z.keyTypes.guid&&{Guid:this.key}),this.keyType===i.Z.keyTypes.number&&{Number:parseInt(this.key,10)}),this.keyType===i.Z.keyTypes.string&&{String:this.key})},this.prefills[this.targetType]&&{Prefill:this.prefills[this.targetType]})]}:{items:[{EntityId:d.Id}]};const I=(0,u.f)(M);this.router.navigate([`edit/${I}`],{relativeTo:this.route})}deletePermission(d){!confirm(`Delete '${d.Title}' (${d.Id})?`)||(this.snackBar.open("Deleting..."),this.permissionsService.delete(d.Id).subscribe(()=>{this.snackBar.open("Deleted",null,{duration:2e3}),this.fetchPermissions()}))}refreshOnChildClosed(){this.subscription.add(this.router.events.pipe((0,_.h)(d=>d instanceof n.m2),(0,l.O)(!!this.route.snapshot.firstChild),(0,h.U)(()=>!!this.route.snapshot.firstChild),(0,o.G)(),(0,_.h)(([d,m])=>d&&!m)).subscribe(()=>{this.fetchPermissions()}))}buildGridOptions(){return Object.assign(Object.assign({},r.f),{columnDefs:[{headerName:"ID",field:"Id",width:70,headerClass:"dense",cellClass:"id-action no-padding no-outline".split(" "),sortable:!0,filter:"agNumberColumnFilter",valueGetter:m=>m.data.Id,cellRenderer:p.m,cellRendererParams:{tooltipGetter:g=>`ID: ${g.Id}\nGUID: ${g.Guid}`}},{field:"Name",flex:2,minWidth:250,cellClass:"primary-action highlight".split(" "),sortable:!0,sort:"asc",filter:"agTextColumnFilter",onCellClicked:m=>{this.editPermission(m.data)},valueGetter:m=>m.data.Title},{field:"Identity",flex:2,minWidth:250,cellClass:"no-outline",sortable:!0,filter:"agTextColumnFilter",valueGetter:m=>m.data.Identity},{field:"Condition",flex:2,minWidth:250,cellClass:"no-outline",sortable:!0,filter:"agTextColumnFilter",valueGetter:m=>m.data.Condition},{field:"Grant",width:70,headerClass:"dense",cellClass:"no-outline",sortable:!0,filter:"agTextColumnFilter",valueGetter:m=>m.data.Grant},{width:42,cellClass:"secondary-action no-padding".split(" "),pinned:"right",cellRenderer:O,cellRendererParams:(()=>({onDelete:g=>this.deletePermission(g)}))()}]})}}return E.\u0275fac=function(d){return new(d||E)(e.Y36(D.so),e.Y36(n.F0),e.Y36(n.gz),e.Y36(T.q),e.Y36(U.ux))},E.\u0275cmp=e.Xpm({type:E,selectors:[["app-permissions"]],decls:16,vars:4,consts:[[1,"nav-component-wrapper"],["mat-dialog-title",""],[1,"dialog-title-box"],["mat-icon-button","","tippy","Close dialog",3,"click"],[1,"grid-wrapper"],[1,"ag-theme-material",3,"rowData","gridOptions"],[1,"grid-more-actions-box"],["mat-fab","","mat-elevation-z24","","tippy","Create a new permission",1,"grid-fab",3,"click"]],template:function(d,m){1&d&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div"),e._uU(4,"Permissions"),e.qZA(),e.TgZ(5,"button",3),e.NdJ("click",function(){return m.closeDialog()}),e.TgZ(6,"mat-icon"),e._uU(7,"close"),e.qZA()()()(),e._UZ(8,"router-outlet"),e.TgZ(9,"div",4),e._UZ(10,"ag-grid-angular",5),e.ALo(11,"async"),e._UZ(12,"div",6),e.TgZ(13,"button",7),e.NdJ("click",function(){return m.editPermission(null)}),e.TgZ(14,"mat-icon"),e._uU(15,"add"),e.qZA()()()()),2&d&&(e.xp6(10),e.Q6J("rowData",e.lcZ(11,2,m.permissions$))("gridOptions",m.gridOptions))},directives:[D.uh,A.lW,C.$,y.Hw,n.lC,R.N8],pipes:[L.Ov],styles:[""]}),E})()},2965:(v,c,t)=>{t.r(c),t.d(c,{PermissionsModule:()=>y});var n=t(6362),s=t(7317),a=t(1130),_=t(5758),l=t(5590),h=t(2528),o=t(4272),p=t(3436),r=t(5368),i=t(3135),u=t(7261),e=t(1667),P=t(2023),C=t(3184);let y=(()=>{class O{}return O.\u0275fac=function(D){return new(D||O)},O.\u0275mod=C.oAB({type:O}),O.\u0275inj=C.cJS({providers:[r._,P.q,e.D,o.g],imports:[[n.ez,u.T,i.q,_.Is,s.ot,l.Ps,p.o,a.si,h.ZX]]}),O})()},1667:(v,c,t)=>{t.d(c,{D:()=>h});var n=t(5368),s=t(3184),a=t(8784),_=t(2425);let h=(()=>{class o{constructor(r,i,u){this.http=r,this.context=i,this.dnnContext=u}getMetadata(r,i,u,e){return this.http.get(this.dnnContext.$2sxc.http.apiUrl("admin/metadata/get"),{params:Object.assign({appId:this.context.appId.toString(),targetType:r.toString(),keyType:i,key:u.toString()},e&&{contentType:e})})}}return o.\u0275fac=function(r){return new(r||o)(s.LFG(a.eN),s.LFG(n._),s.LFG(_._y))},o.\u0275prov=s.Yz7({token:o,factory:o.\u0275fac}),o})()},2023:(v,c,t)=>{t.d(c,{q:()=>h});var n=t(635),s=t(4272),a=t(941),_=t(1667),l=t(3184);let h=(()=>{class o{constructor(r,i){this.metadataService=r,this.entitiesService=i}getAll(r,i,u){return this.metadataService.getMetadata(r,i,u,a.Z.contentTypes.permissions).pipe((0,n.U)(e=>e.Items))}delete(r){return this.entitiesService.delete(a.Z.contentTypes.permissions,r,!1)}}return o.\u0275fac=function(r){return new(r||o)(l.LFG(_.D),l.LFG(s.g))},o.\u0275prov=l.Yz7({token:o,factory:o.\u0275fac}),o})()},2087:(v,c,t)=>{t.d(c,{m:()=>r});var n=t(9673),s=t(3184),a=t(2528),_=t(1130),l=t(6190),h=t(6362),o=t(5590);const p=function(i,u){return{"align-start":i,"align-end":u}};let r=(()=>{class i{constructor(e){this.snackBar=e}agInit(e){this.id=e.value,this.align="number"==typeof this.id?"end":"start",this.tooltip=e.tooltipGetter(e.data)}refresh(e){return!0}copy(){(0,n.v)(this.tooltip),this.snackBar.open("Copied to clipboard",null,{duration:2e3})}}return i.\u0275fac=function(e){return new(e||i)(s.Y36(a.ux))},i.\u0275cmp=s.Xpm({type:i,selectors:[["app-id-field"]],decls:5,vars:6,consts:[["matRipple","",1,"id-box","highlight",3,"tippy","ngClass","click"],[1,"id"],[1,"icon"]],template:function(e,P){1&e&&(s.TgZ(0,"div",0),s.NdJ("click",function(){return P.copy()}),s.TgZ(1,"span",1),s._uU(2),s.qZA(),s.TgZ(3,"mat-icon",2),s._uU(4,"file_copy"),s.qZA()()),2&e&&(s.Q6J("tippy",P.tooltip)("ngClass",s.WLB(3,p,"start"===P.align,"end"===P.align)),s.xp6(2),s.Oqu(P.id))},directives:[_.wG,l.$,h.mk,o.Hw],styles:[".id-box[_ngcontent-%COMP%]{padding:0 8px;height:100%;display:flex;align-items:center}.id-box.align-start[_ngcontent-%COMP%]{justify-content:flex-start}.id-box.align-end[_ngcontent-%COMP%]{justify-content:flex-end}.id-box[_ngcontent-%COMP%]   .id[_ngcontent-%COMP%]{max-width:100%;text-overflow:ellipsis;overflow:hidden}.id-box[_ngcontent-%COMP%]:hover{text-decoration:none}.id-box[_ngcontent-%COMP%]:hover   .id[_ngcontent-%COMP%]{display:none}.id-box[_ngcontent-%COMP%]:not(:hover)   .icon[_ngcontent-%COMP%]{display:none}"]}),i})()},4153:(v,c,t)=>{t.d(c,{f:()=>n});const n={accentedSort:!0,animateRows:!0,enableCellTextSelection:!0,headerHeight:32,suppressScrollOnNewData:!0,valueCache:!0,defaultColDef:{filterParams:{newRowsAction:"keep"}},tooltipShowDelay:0,tooltipHideDelay:1e5,suppressMovableColumns:!0}},9673:(v,c,t)=>{function n(s){const a=document.createElement("textarea");a.value=s,a.setAttribute("readonly",""),a.style.position="absolute",a.style.left="-9999px",document.body.appendChild(a);const _=document.getSelection().rangeCount>0&&document.getSelection().getRangeAt(0);a.select(),document.execCommand("copy"),document.body.removeChild(a),_&&(document.getSelection().removeAllRanges(),document.getSelection().addRange(_))}t.d(c,{v:()=>n})}}]);
//# sourceMappingURL=https://sources.2sxc.org/14.12.03/ng-edit/default-projects_eav-ui_src_app_permissions_index_ts.66e1d1107ed68530.js.map