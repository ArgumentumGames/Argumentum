(window.webpackJsonp=window.webpackJsonp||[]).push([[36],{SST1:function(e,t,i){"use strict";i.r(t);var s=i("D57K"),n=i("5/c3"),o=i("LR82"),r=i("z5yO"),a=i("KLQV"),l=i("1C3z"),c=i("OeRG"),d=i("Qc/f"),p=i("r4gC"),h=function(){function e(){}return e.prototype.agInit=function(e){this.params=e},e.prototype.refresh=function(e){return!0},e.prototype.deletePermission=function(){this.params.onDelete(this.params.data)},e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=l.Kb({type:e,selectors:[["app-permissions-actions"]],decls:4,vars:0,consts:[[1,"actions-component"],["matRipple","","matTooltip","Delete",1,"like-button","highlight",3,"click"]],template:function(e,t){1&e&&(l.Wb(0,"div",0),l.Wb(1,"div",1),l.ec("click",(function(){return t.deletePermission()})),l.Wb(2,"mat-icon"),l.Pc(3,"delete"),l.Vb(),l.Vb(),l.Vb())},directives:[c.q,d.a,p.a],styles:[""]}),e}(),u=i("o9tz"),m=i("JzAw"),b=i("QjRa"),f=i("BLjT"),y=i("SNUn"),g=i("2pW/"),C=i("9HSk"),v=i("G6Ml");i.d(t,"PermissionsComponent",(function(){return k}));var k=function(){function e(e,t,i,n,r){this.dialogRef=e,this.router=t,this.route=i,this.permissionsService=n,this.snackBar=r,this.modules=a.a,this.gridOptions=Object(s.a)(Object(s.a)({},b.a),{frameworkComponents:{idFieldComponent:m.a,permissionsActionsComponent:h},columnDefs:[{headerName:"ID",field:"Id",width:70,headerClass:"dense",cellClass:"id-action no-padding no-outline",cellRenderer:"idFieldComponent",sortable:!0,filter:"agTextColumnFilter",valueGetter:this.idValueGetter},{headerName:"Name",field:"Title",flex:2,minWidth:250,cellClass:"primary-action highlight",sortable:!0,filter:"agTextColumnFilter",onCellClicked:this.editPermission.bind(this)},{width:40,cellClass:"secondary-action no-padding",cellRenderer:"permissionsActionsComponent",cellRendererParams:{onDelete:this.deletePermission.bind(this)}},{headerName:"Identity",field:"Identity",flex:2,minWidth:250,cellClass:"no-outline",sortable:!0,filter:"agTextColumnFilter"},{headerName:"Condition",field:"Condition",flex:2,minWidth:250,cellClass:"no-outline",sortable:!0,filter:"agTextColumnFilter"},{headerName:"Grant",field:"Grant",width:70,headerClass:"dense",cellClass:"no-outline",sortable:!0,filter:"agTextColumnFilter"}]}),this.subscription=new o.a,this.hasChild=!!this.route.snapshot.firstChild}return e.prototype.ngOnInit=function(){this.targetType=parseInt(this.route.snapshot.paramMap.get("type"),10),this.keyType=this.route.snapshot.paramMap.get("keyType"),this.key=this.route.snapshot.paramMap.get("key"),this.fetchPermissions(),this.refreshOnChildClosed()},e.prototype.ngOnDestroy=function(){this.subscription.unsubscribe(),this.subscription=null},e.prototype.closeDialog=function(){this.dialogRef.close()},e.prototype.idValueGetter=function(e){var t=e.data;return"ID: "+t.Id+"\nGUID: "+t.Guid},e.prototype.fetchPermissions=function(){var e=this;this.permissionsService.getAll(this.targetType,this.keyType,this.key).subscribe((function(t){e.permissions=t}))},e.prototype.editPermission=function(e){var t,i,n;if(null===e){var o=void 0,r=Object.keys(u.a.metadata);try{for(var a=Object(s.i)(r),l=a.next();!l.done;l=a.next()){var c=l.value;if(u.a.metadata[c].type===this.targetType){o=u.a.metadata[c].target;break}}}catch(d){t={error:d}}finally{try{l&&!l.done&&(i=a.return)&&i.call(a)}finally{if(t)throw t.error}}n={items:[{ContentTypeName:u.a.contentTypes.permissions,For:Object(s.a)(Object(s.a)(Object(s.a)({Target:o},this.keyType===u.a.keyTypes.guid&&{Guid:this.key}),this.keyType===u.a.keyTypes.number&&{Number:parseInt(this.key,10)}),this.keyType===u.a.keyTypes.string&&{String:this.key})}]}}else n={items:[{EntityId:e.data.Id.toString()}]};this.router.navigate(["edit/"+JSON.stringify(n)],{relativeTo:this.route})},e.prototype.deletePermission=function(e){var t=this;confirm("Delete '"+e.Title+"' ("+e.Id+")?")&&(this.snackBar.open("Deleting..."),this.permissionsService.delete(e.Id).subscribe((function(){t.snackBar.open("Deleted",null,{duration:2e3}),t.fetchPermissions()})))},e.prototype.refreshOnChildClosed=function(){var e=this;this.subscription.add(this.router.events.pipe(Object(r.a)((function(e){return e instanceof n.b}))).subscribe((function(t){var i=e.hasChild;e.hasChild=!!e.route.snapshot.firstChild,!e.hasChild&&i&&e.fetchPermissions()})))},e.\u0275fac=function(t){return new(t||e)(l.Qb(f.h),l.Qb(n.c),l.Qb(n.a),l.Qb(y.a),l.Qb(g.b))},e.\u0275cmp=l.Kb({type:e,selectors:[["app-permissions"]],decls:14,vars:3,consts:[[1,"nav-component-wrapper"],["mat-dialog-title",""],[1,"dialog-title-box"],["mat-icon-button","","matTooltip","Close dialog",3,"click"],[1,"grid-wrapper"],[1,"ag-theme-material",3,"rowData","modules","gridOptions"],["mat-fab","","mat-elevation-z24","","matTooltip","Create a new permission",1,"grid-fab",3,"click"]],template:function(e,t){1&e&&(l.Wb(0,"div",0),l.Wb(1,"div",1),l.Wb(2,"div",2),l.Wb(3,"div"),l.Pc(4,"Permissions"),l.Vb(),l.Wb(5,"button",3),l.ec("click",(function(){return t.closeDialog()})),l.Wb(6,"mat-icon"),l.Pc(7,"close"),l.Vb(),l.Vb(),l.Vb(),l.Vb(),l.Rb(8,"router-outlet"),l.Wb(9,"div",4),l.Rb(10,"ag-grid-angular",5),l.Wb(11,"button",6),l.ec("click",(function(){return t.editPermission(null)})),l.Wb(12,"mat-icon"),l.Pc(13,"add"),l.Vb(),l.Vb(),l.Vb(),l.Vb()),2&e&&(l.Bb(10),l.oc("rowData",t.permissions)("modules",t.modules)("gridOptions",t.gridOptions))},directives:[f.i,C.b,d.a,p.a,n.h,v.a],styles:[""]}),e}()}}]);
//# sourceMappingURL=https://sources.2sxc.org/11.03.00/ng-edit/permissions-component.6f78dd68152a51cc18ee.js.map